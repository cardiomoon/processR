#'modSummary3(fit1,labels=labels)
#'fit=lm(mpg~hp*wt,data=mtcars)
#'modSummary3(fit,X="hp",W="wt")
modSummary3=function(fit,X=NULL,W=NULL,Z=NULL,labels=NULL,modx.values=NULL,
mod2.values=NULL,rangemode=2,maxylev=6,digits=3){
# X="hp";W="wt";Z=NULL;modx.values=NULL;labels=NULL
# rangemode=2;maxylev=6;digits=3;mod2.values=NULL
if(is.null(X)){ X=labels$X }
if(is.null(W)){ W=labels$W }
if(is.null(Z)){ Z=labels$Z }
addz=TRUE
if(is.null(Z)) addz=FALSE
labelW=W
labelZ=Z
vars=names(fit$coef)
select=str_detect(vars,X)
coef=fit$coef[select]
count=length(coef)
vars[select] %>%
str_replace(labels$W,"W")
vars1<- vars[select] %>%
str_replace(W,"W") %>%
str_replace_all(":","*") %>%
str_replace(X,"1")
if(addz) vars1=str_replace(vars1,Z,"Z")
temp<-paste0("coef[",1:count,"]*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+")
temp
temp1=paste0(round(coef,digits=3),"*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+") %>%
str_replace("\\+-","-")
temp1
cat("Conditional Effect = ",temp1,"\n")
data=fit$model
if(is.null(modx.values)){
W1=getRepValues(data,W,rangemode=rangemode,maxylev=maxylev)
} else{
W1=modx.values
}
if(addz){
if(is.null(mod2.values)){
Z1=getRepValues(data,Z,rangemode=rangemode,maxylev=maxylev)
} else{
Z1=mod2.values
}
}
w<-z<-y<-c()
for(i in seq_along(W1)){
for(j in seq_along(Z1)){
W=W1[i]
if(addz) Z=Z1[j]
w=c(w,W1[i])
if(addz) z=c(z,Z1[j])
y=c(y,eval(parse(text=temp)))
}
}
if(addz) {
df=data.frame(W=w,Z=z,slope=round(y,digits))
colnames(df)=c(paste0(labelW,"(W)"),paste0(labelZ,"(Z)"),"slope")
} else{
df=data.frame(W=w,slope=round(y,digits))
colnames(df)=c(paste0(labelW,"(W)"),"slope")
}
attr(df,"eq")=temp1
df
}
labels=list(X="negemot",W="sex",Z="age",Y="govact",C1="posemot",C2="ideology")
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1,labels=labels)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit,X="hp",W="wt")
#'@param digits integer indicating the number of decimal places
#'@export
#'@examples
#'labels=list(X="negemot",W="sex",Z="age",Y="govact",C1="posemot",C2="ideology")
#'fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
#'modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
#'fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
#'modSummary3(fit1,labels=labels)
#'fit=lm(mpg~hp*wt,data=mtcars)
#'modSummary3(fit,X="hp",W="wt")
modSummary3=function(fit,X=NULL,W=NULL,Z=NULL,labels=NULL,modx.values=NULL,
mod2.values=NULL,rangemode=2,maxylev=6,digits=3){
# X="hp";W="wt";Z=NULL;modx.values=NULL;labels=NULL
# rangemode=2;maxylev=6;digits=3;mod2.values=NULL
if(is.null(X)){ X=labels$X }
if(is.null(W)){ W=labels$W }
if(is.null(Z)){ Z=labels$Z }
addz=TRUE
if(is.null(Z)) addz=FALSE
labelW=W
labelZ=Z
vars=names(fit$coef)
select=str_detect(vars,X)
coef=fit$coef[select]
count=length(coef)
vars1<- vars[select] %>%
str_replace(W,"W") %>%
str_replace_all(":","*") %>%
str_replace(X,"1")
if(addz) vars1=str_replace(vars1,Z,"Z")
temp<-paste0("coef[",1:count,"]*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+")
temp
temp1=paste0(round(coef,digits=3),"*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+") %>%
str_replace("\\+-","-")
temp1
cat("Conditional Effect = ",temp1,"\n")
data=fit$model
if(is.null(modx.values)){
W1=getRepValues(data,W,rangemode=rangemode,maxylev=maxylev)
} else{
W1=modx.values
}
if(addz){
if(is.null(mod2.values)){
Z1=getRepValues(data,Z,rangemode=rangemode,maxylev=maxylev)
} else{
Z1=mod2.values
}
}
w<-z<-y<-c()
for(i in seq_along(W1)){
for(j in seq_along(Z1)){
W=W1[i]
if(addz) Z=Z1[j]
w=c(w,W1[i])
if(addz) z=c(z,Z1[j])
y=c(y,eval(parse(text=temp)))
}
}
if(addz) {
df=data.frame(W=w,Z=z,slope=round(y,digits))
colnames(df)=c(paste0(labelW,"(W)"),paste0(labelZ,"(Z)"),"slope")
} else{
df=data.frame(W=w,slope=round(y,digits))
colnames(df)=c(paste0(labelW,"(W)"),"slope")
}
attr(df,"eq")=temp1
df
}
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit,X="hp",W="wt")
fit=lm(mpg~hp*wt,data=mtcars)
X="hp";W="wt";Z=NULL;modx.values=NULL;labels=NULL
rangemode=2;maxylev=6;digits=3;mod2.values=NULL
# X="hp";W="wt";Z=NULL;modx.values=NULL;labels=NULL
# rangemode=2;maxylev=6;digits=3;mod2.values=NULL
if(is.null(X)){ X=labels$X }
if(is.null(W)){ W=labels$W }
if(is.null(Z)){ Z=labels$Z }
addz=TRUE
if(is.null(Z)) addz=FALSE
labelW=W
labelZ=Z
vars=names(fit$coef)
select=str_detect(vars,X)
coef=fit$coef[select]
count=length(coef)
vars1<- vars[select] %>%
str_replace(W,"W") %>%
str_replace_all(":","*") %>%
str_replace(X,"1")
if(addz) vars1=str_replace(vars1,Z,"Z")
temp<-paste0("coef[",1:count,"]*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+")
temp
temp1=paste0(round(coef,digits=3),"*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+") %>%
str_replace("\\+-","-")
temp1
cat("Conditional Effect = ",temp1,"\n")
data=fit$model
if(is.null(modx.values)){
W1=getRepValues(data,W,rangemode=rangemode,maxylev=maxylev)
} else{
W1=modx.values
}
if(addz){
if(is.null(mod2.values)){
Z1=getRepValues(data,Z,rangemode=rangemode,maxylev=maxylev)
} else{
Z1=mod2.values
}
}
w<-z<-y<-c()
W1
for(i in seq_along(W1)){
for(j in seq_along(Z1)){
W=W1[i]
if(addz) Z=Z1[j]
w=c(w,W1[i])
if(addz) z=c(z,Z1[j])
y=c(y,eval(parse(text=temp)))
}
}
w
#'@param digits integer indicating the number of decimal places
#'@export
#'@examples
#'labels=list(X="negemot",W="sex",Z="age",Y="govact",C1="posemot",C2="ideology")
#'fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
#'modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
#'fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
#'modSummary3(fit1,labels=labels)
#'fit=lm(mpg~hp*wt,data=mtcars)
#'modSummary3(fit,X="hp",W="wt")
modSummary3=function(fit,X=NULL,W=NULL,Z=NULL,labels=NULL,modx.values=NULL,
mod2.values=NULL,rangemode=2,maxylev=6,digits=3){
# X="hp";W="wt";Z=NULL;modx.values=NULL;labels=NULL
# rangemode=2;maxylev=6;digits=3;mod2.values=NULL
if(is.null(X)){ X=labels$X }
if(is.null(W)){ W=labels$W }
if(is.null(Z)){ Z=labels$Z }
addz=TRUE
if(is.null(Z)) addz=FALSE
labelW=W
labelZ=Z
vars=names(fit$coef)
select=str_detect(vars,X)
coef=fit$coef[select]
count=length(coef)
vars1<- vars[select] %>%
str_replace(W,"W") %>%
str_replace_all(":","*") %>%
str_replace(X,"1")
if(addz) vars1=str_replace(vars1,Z,"Z")
temp<-paste0("coef[",1:count,"]*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+")
temp
temp1=paste0(round(coef,digits=3),"*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+") %>%
str_replace("\\+-","-")
temp1
cat("Conditional Effect = ",temp1,"\n")
data=fit$model
if(is.null(modx.values)){
W1=getRepValues(data,W,rangemode=rangemode,maxylev=maxylev)
} else{
W1=modx.values
}
if(addz){
if(is.null(mod2.values)){
Z1=getRepValues(data,Z,rangemode=rangemode,maxylev=maxylev)
} else{
Z1=mod2.values
}
}
w<-z<-y<-c()
W1
if(addz) {
for(i in seq_along(W1)){
for(j in seq_along(Z1)){
W=W1[i]
if(addz) Z=Z1[j]
w=c(w,W1[i])
if(addz) z=c(z,Z1[j])
y=c(y,eval(parse(text=temp)))
}
}
df=data.frame(W=w,Z=z,slope=round(y,digits))
colnames(df)=c(paste0(labelW,"(W)"),paste0(labelZ,"(Z)"),"slope")
} else{
for(i in seq_along(W1)){
W=W1[i]
w=c(w,W1[i])
y=c(y,eval(parse(text=temp)))
}
df=data.frame(W=w,slope=round(y,digits))
colnames(df)=c(paste0(labelW,"(W)"),"slope")
}
attr(df,"eq")=temp1
df
}
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit,X="hp",W="wt")
labels=list(X="negemot",W="sex",Z="age",Y="govact",C1="posemot",C2="ideology")
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1,labels=labels)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit,X="hp",W="wt")
devtools::document()
devtools::check()
#' Make flextable summarizing moderation effect
#' @param x An object
#' @param vanilla logical
#' @param ... Further argument to be passed to modSummary3
#' @export
#' @examples
#' fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
#' modSummary3Table(fit)
modSummary3Table=function(x,vanilla=TRUE,...){
if("lm" %in% class(x)) x=modSummary3(x,...)
rrtable::df2flextable(x,vanilla=vanilla)
}
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3Table(fit)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3Table(fit)
modSummary3(fit)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit)
labels=list(X="negemot",W="sex",Z="age",Y="govact",C1="posemot",C2="ideology")
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
labels=list(X="negemot",W="sex",Z="age",Y="govact",C1="posemot",C2="ideology")
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit)
labels=list(X="negemot",W="sex",Z="age",Y="govact",C1="posemot",C2="ideology")
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,labels=labels)
#'@param digits integer indicating the number of decimal places
#'@export
#'@examples
#'labels=list(X="negemot",W="sex",Z="age",Y="govact",C1="posemot",C2="ideology")
#'fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
#'modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
#'fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
#'modSummary3(fit1)
#'fit=lm(mpg~hp*wt,data=mtcars)
#'modSummary3(fit,X="hp",W="wt")
modSummary3=function(fit,X=NULL,W=NULL,Z=NULL,labels=NULL,modx.values=NULL,
mod2.values=NULL,rangemode=2,maxylev=6,digits=3){
# X="hp";W="wt";Z=NULL;modx.values=NULL;labels=NULL
# rangemode=2;maxylev=6;digits=3;mod2.values=NULL
data=fit$model
if(is.null(X)){ X=labels$X }
if(is.null(X)){ X=names(data)[2]}
if(is.null(W)){ W=labels$W }
if(is.null(W)){ W=names(data)[3]}
if(is.null(Z)){ Z=labels$Z }
if(is.null(Z)) {
if(length(names(data))>3) Z=names(data)[4]
}
addz=TRUE
if(is.null(Z)) addz=FALSE
labelW=W
labelZ=Z
vars=names(fit$coef)
select=str_detect(vars,X)
coef=fit$coef[select]
count=length(coef)
vars1<- vars[select] %>%
str_replace(W,"W") %>%
str_replace_all(":","*") %>%
str_replace(X,"1")
if(addz) vars1=str_replace(vars1,Z,"Z")
temp<-paste0("coef[",1:count,"]*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+")
temp
temp1=paste0(round(coef,digits=3),"*",vars1) %>%
str_replace("\\*1","") %>%
paste0(collapse="+") %>%
str_replace("\\+-","-")
temp1
cat("Conditional Effect = ",temp1,"\n")
if(is.null(modx.values)){
W1=getRepValues(data,W,rangemode=rangemode,maxylev=maxylev)
} else{
W1=modx.values
}
if(addz){
if(is.null(mod2.values)){
Z1=getRepValues(data,Z,rangemode=rangemode,maxylev=maxylev)
} else{
Z1=mod2.values
}
}
w<-z<-y<-c()
W1
if(addz) {
for(i in seq_along(W1)){
for(j in seq_along(Z1)){
W=W1[i]
if(addz) Z=Z1[j]
w=c(w,W1[i])
if(addz) z=c(z,Z1[j])
y=c(y,eval(parse(text=temp)))
}
}
df=data.frame(W=w,Z=z,slope=round(y,digits))
colnames(df)=c(paste0(labelW,"(W)"),paste0(labelZ,"(Z)"),"slope")
} else{
for(i in seq_along(W1)){
W=W1[i]
w=c(w,W1[i])
y=c(y,eval(parse(text=temp)))
}
df=data.frame(W=w,slope=round(y,digits))
colnames(df)=c(paste0(labelW,"(W)"),"slope")
}
attr(df,"eq")=temp1
df
}
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit,X="hp",W="wt")
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,labels=labels)
modSummary3Table(fit,labels=labels)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3Table(fit)
modSummary3Table(fit,mod2.values=c(30,50,70))
#' Make flextable summarizing moderation effect
#' @param x An object
#' @param vanilla logical
#' @param ... Further argument to be passed to modSummary3
#' @export
#' @examples
#' fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
#' modSummary3Table(fit,mod2.values=c(30,50,70))
modSummary3Table=function(x,vanilla=TRUE,...){
if("lm" %in% class(x)) x=modSummary3(x,...)
rrtable::df2flextable(x,vanilla=vanilla,digits=3)
}
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3Table(fit,mod2.values=c(30,50,70))
#' Make flextable summarizing moderation effect
#' @param x An object
#' @param vanilla logical
#' @param ... Further argument to be passed to modSummary3
#' @export
#' @examples
#' fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
#' modSummary3Table(fit,mod2.values=c(30,50,70))
modSummary3Table=function(x,vanilla=TRUE,...){
if("lm" %in% class(x)) x=modSummary3(x,...)
rrtable::df2flextable(x,vanilla=vanilla,digits=3) %>%
add_footer_lines(attr(x,"eq") ) %>%
align(align="right",part="footer")
}
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3Table(fit,mod2.values=c(30,50,70))
system("grep -r '\u' *")
system('grep -r "\u" *')
system('grep -r "\\u" *')
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit)
modSummary3(fit1,rangemode=1)
devtools::document()
devtools::check()
devtools::document()
labels=list(X="negemot",W="sex",Z="age",Y="govact",C1="posemot",C2="ideology")
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary2(fit,rangemode=2,mod2.values=c(30,50,70),summarymode=2)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,labels=labels,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1,rangemode=1)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3Table(fit,mod2.values=c(30,50,70))
devtools::document()
devtools::check()
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1,rangemode=1)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3Table(fit,mod2.values=c(30,50,70))
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1,rangemode=1)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit)
devtools::document()
devtools::check()
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1,rangemode=1)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,mod2.values=c(30,50,70))
fit1=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
modSummary3(fit1,rangemode=1)
fit=lm(mpg~hp*wt,data=mtcars)
modSummary3(fit)
