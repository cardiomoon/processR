modelsSummary(fit,labels=labels)
library(processR)
library(processR)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
require(processR)
library(officer)
# Formatting data values example ------
ft <- flextable(head( mtcars, n = 10))
ft <- display(ft, col_key = "carb",
i = ~ drat > 3.5, pattern = "# {{carb}}",
formatters = list(carb ~ sprintf("%.1f", carb)),
fprops = list(carb = fp_text(color="orange") ) )
ft <- autofit(ft)
library(officer)
library(flextable)
# Formatting data values example ------
ft <- flextable(head( mtcars, n = 10))
ft <- display(ft, col_key = "carb",
i = ~ drat > 3.5, pattern = "# {{carb}}",
formatters = list(carb ~ sprintf("%.1f", carb)),
fprops = list(carb = fp_text(color="orange") ) )
ft <- autofit(ft)
ft
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
res=modelsSummary(fit,labels=labels)
ft=modelsSummaryTable(res)
ft
res
str(res)
ft %>% display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(A = fp_text(color="orange"),a=fp_text(vertical.align="subscript")))
library(tidyverse)
ft %>% display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(A = fp_text(color="orange"),a=fp_text(vertical.align="subscript")))
ft %>% display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(A = fp_text(color="orange"),a=fp_text(vertical.align="subscript")),
part="body")
display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(A = fp_text(color="orange"),a=fp_text(vertical.align="subscript")),
part="body")
display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label2",
i = ~ nchar(label2) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label2,1,1),a~substr(label1,2,nchar(label2))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft
ft=modelsSummaryTable(res)
ft
ft<-display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label2",
i = ~ nchar(label2) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label2,1,1),a~substr(label1,2,nchar(label2))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft
ft<-display(ft, col_key = "label3",
i = ~ nchar(label3) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label3,1,1),a~substr(label1,2,nchar(label3))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft
ft=modelsSummaryTable(res)
ft
ft<-display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label2",
i = ~ nchar(label2) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label2,1,1),a~substr(label2,2,nchar(label2))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label3",
i = ~ nchar(label3) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label3,1,1),a~substr(label3,2,nchar(label3))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft
x=c("a","a1","b1","c2","c'1","c'2")
require(stringr)
str_view(x,"![0-9]")
str_view(x,"^[0-9]")
str_view(x,"[0-9]")
str_view(x,"^[0-9]")
x=c("a","a1","b1","c2","c'1","c'21")
require(stringr)
str_view(x,"[0-9]")
str_view(x,"[0-9]*")
str_view(x,"[0-9].*")
str_view(x,"[^0-9].*")
str_view(x,"[^0-9].*")
str_view(x,"[^0-9]")
str_view(x,"[0-9].*")
str_view(x,"[^0-9.*]")
str_view(x,"[0-9].*")
str_view(x,"[^0-9.*]")
str_view(x,"[0-9].*")
str_view(x,"[^[0-9].*]")
str_view(x,"[0-9].*")
str_view(x,"[^0-9].*")
str_view(x,"[^0-9]")
str_view(x,"[^0-9]*")
str_view(x,"[0-9].*")
str_view(x,"[^0-9]*")
str_extract(x,"[0-9].*")
x=c("a","a1","b1","c2","c'1","c'21")
str_extract(x,"[0-9].*")
str_extract(x,"[^0-9]*")
ft
ft=modelsSummaryTable(res)
ft
ft<-display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label2",
i = ~ nchar(label2) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label2,1,1),a~substr(label2,2,nchar(label2))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label3",
formatters = list(A ~ str_extract(label3,"[^0-9]*"),
fprops = list(a=fp_text(vertical.align="subscript")),
ft
ft=modelsSummaryTable(res)
ft
ft<-display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label2",
i = ~ nchar(label2) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label2,1,1),a~substr(label2,2,nchar(label2))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft
ft<-display(ft, col_key = "label3",
i = ~ !is.na(str_extract(label3,"[0-9.*]")), pattern = "{{A}}{{a}}",
formatters = list(A ~ str_extract(label3,"[^0-9]*"),
a~str_extract(label3,"[0-9].*")),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft
ft=modelsSummaryTable(res)
ft
ft<-display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label2",
i = ~ nchar(label2) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label2,1,1),a~substr(label2,2,nchar(label2))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label3",
i = ~ !is.na(str_extract(label3,"[0-9ym.*]")), pattern = "{{A}}{{a}}",
formatters = list(A ~ str_extract(label3,"[^0-9ym]*"),
a~str_extract(label3,"[0-9ym].*")),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft
ft<-display(ft, col_key = "label3",
i = ~ !is.na(str_extract(label3,"[0-9ym.*]")), pattern = "{{A}}{{a}}",
formatters = list(A ~ str_extract(label3,"[^0-9ym]*"),
a~str_extract(label3,"[0-9ym].*")),
fprops = list(A=fp_text(font.face="italic"),a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label3",
i = ~ !is.na(str_extract(label3,"[0-9ym.*]")), pattern = "{{A}}{{a}}",
formatters = list(A ~ str_extract(label3,"[^0-9ym]*"),
a~str_extract(label3,"[0-9ym].*")),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft
ft=modelsSummaryTable(res)
ft
ft
res=modelsSummary(fit,labels=labels)
str(res)
res$label3[1:2]=c("c'1","c'2")
ft=modelsSummaryTable(res)
ft
ft
ft<-display(ft, col_key = "label1",
i = ~ nchar(label1) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label1,1,1),a~substr(label1,2,nchar(label1))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label2",
i = ~ nchar(label2) >1, pattern = "{{A}}{{a}}",
formatters = list(A ~ substr(label2,1,1),a~substr(label2,2,nchar(label2))),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft<-display(ft, col_key = "label3",
i = ~ !is.na(str_extract(label3,"[0-9ym.*]")), pattern = "{{A}}{{a}}",
formatters = list(A ~ str_extract(label3,"[^0-9ym]*"),
a~str_extract(label3,"[0-9ym].*")),
fprops = list(a=fp_text(vertical.align="subscript")),
part="body")
ft
res=modelsSummary(fit,labels=labels)
res
numberSubscript=function(ft,label){
temp=paste0("display(ft, col_key = '",label,
"',i = ~ !is.na(str_extract(",label,",'[0-9ym.*]')), pattern = '{{A}}{{a}}',
formatters = list(A ~ str_extract(",label,",'[^0-9ym]*'),
a~str_extract(",label,",'[0-9ym].*')),
fprops = list(a=fp_text(vertical.align='subscript')),
part='body')")
numberSubscript=function(ft,label){
temp=paste0("display(ft, col_key = '",label,
"',i = ~ !is.na(str_extract(",label,",'[0-9ym.*]')), pattern = '{{A}}{{a}}',
formatters = list(A ~ str_extract(",label,",'[^0-9ym]*'),
a~str_extract(",label,",'[0-9ym].*')),
fprops = list(a=fp_text(vertical.align='subscript')),
part='body')")
ft<-eval(parse(text=temp))
ft
}
numberSubscript=function(ft,label){
for(i in seq_along(label)){
temp=paste0("display(ft, col_key = '",label[i],
"',i = ~ !is.na(str_extract(",label[i],",'[0-9ym.*]')), pattern = '{{A}}{{a}}',
formatters = list(A ~ str_extract(",label[i],",'[^0-9ym]*'),
a~str_extract(",label[i],",'[0-9ym].*')),
fprops = list(a=fp_text(vertical.align='subscript')),
part='body')")
ft<-eval(parse(text=temp))
}
ft
}
res=modelsSummary(fit,labels=labels)
res
str(res)
res$label3[1:2]=c("c'1","c'2")
ft=modelsSummaryTable(res)
ft
numberSubscript=function(ft,label){
for(i in seq_along(label)){
temp=paste0("display(ft, col_key = '",label[i],
"',i = ~ !is.na(str_extract(",label[i],",'[0-9ym.*]')), pattern = '{{A}}{{a}}',
formatters = list(A ~ str_extract(",label[i],",'[^0-9ym]*'),
a~str_extract(",label[i],",'[0-9ym].*')),
fprops = list(a=fp_text(vertical.align='subscript')),
part='body')")
ft<-eval(parse(text=temp))
}
ft
}
ft=numberSubscript(ft,c("label1","label2","label3"))
ft
library(processR)
devtools::document()
library(processR)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
x=modelsSummary(fit,labels=labels)
x
x[x=="im"]
x[x=="iy"]
library(processR)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
x=modelsSummary(fit,labels=labels)
x
modelsSummaryTable(x)
ft=modelsSummaryTable(x)
ft
label=c("label1","label2","label3")
ft %>% italic(j=label,part="body")
ft %>% italic(j=label,part="body") %>% align(align="center",j=label,part="body")
ft %>% italic(j=label,part="body") %>% align(align="center",j=label,part="body")
#'Make number subscript
#'@param ft An object of class flextable
#'@param label string vector
numberSubscript=function(ft,label){
for(i in seq_along(label)){
temp=paste0("display(ft, col_key = '",label[i],
"',i = ~ !is.na(str_extract(",label[i],",'[0-9ym.*]')), pattern = '{{A}}{{a}}',
formatters = list(A ~ str_extract(",label[i],",'[^0-9ym]*'),
a~str_extract(",label[i],",'[0-9ym].*')),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE)),
part='body')")
ft<-eval(parse(text=temp))
}
ft
}
devtools::document()
devtools::document()
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x)
modelsSummary2Table(x)
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
modelsSummaryTable(fit,labels=labels)
fit=list(fit1,fit2,fit3)
modelsSummaryTable(fit,labels=labels)
modelsSummary2Table(fit,labels=labels)
modelsSummaryTable(fit,labels=labels)
modelsSummary2Table(fit,labels=labels)
devtools::document()
library(processR)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
modelsSummaryTable(fit,labels=labels)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp*vs+am,data=mtcars)
labels=list(Y="mpg",X="wt",W="hp",Z="vs")
fit=list(fit1,fit2)
labels=NULL;prefix="b";fitlabels=NULL;constant="iy";autoPrefix=TRUE
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp*vs+am,data=mtcars)
labels=list(Y="mpg",X="wt",W="hp",Z="vs")
fit=list(fit1,fit2)
# labels=NULL;prefix="b";fitlabels=NULL;constant="iy";autoPrefix=TRUE
if("lm" %in%  class(fit)) fit=list(fit)
count=length(fit)
df<-coef<-list()
modelNames=c()
rowcount=c()
r2=c()
mse=c()
fstat=c()
fitnames=c()
if(length(constant)==1) constant=rep(constant,count)
if(length(prefix)==1) prefix=rep(prefix,count)
for(i in 1 :count){
df[[i]]=data.frame(getCoef(fit[[i]]))
colnames(df[[i]])=c("coef","se","t","p")
df[[i]][["name1"]]=rownames(df[[i]])
df[[i]][["name"]]=c(constant[i],paste0(prefix[i],1:(nrow(df[[i]])-1)))
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])
modelNames=c(modelNames,names(fit[[i]]$model)[1])
rowcount=c(rowcount,nrow(df[[i]]))
r2=c(r2,coef[[i]][2])
mse=c(mse,coef[[i]][6])
fstat=c(fstat,coef[[i]][5])
temp=paste("Model",i)
if(!is.null(fitlabels[i])) temp=paste0(temp,": ",fitlabels[i])
fitnames=c(fitnames,temp)
}
if(!is.null(labels)) modelNames=changeLabelName(modelNames,labels,add=TRUE)
df
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp*vs+am,data=mtcars)
labels=list(Y="mpg",X="wt",W="hp",Z="vs")
fit=list(fit1,fit2)
modelsSummary2(fit,labels=labels)
modelsSummary2(fit,labels=labels,prefix=c("c","b"))
modelsSummary2(fit1)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
modelsSummary2(fit,labels=labels)
modelsSummary(fit,labels=labels)
modelsSummary2(fit,labels=labels)
library(processR)
modelsSummary(fit,labels=labels)
modelsSummary2(fit,labels=labels)
library(processR)
modelsSummary(fit,labels=labels)
modelsSummary(fit,labels=labels)
library(processR)
modelsSummary2(fit,labels=labels)
modelsSummaryTable(fit,labels=labels)
library(processR)
modelsSummary2(fit,labels=labels)
library(processR)
modelsSummaryTable(fit,labels=labels)
modelsSummary2(fit,labels=labels)
modelsSummary2Table(fit,labels=labels)
modelsSummary2(fit,labels=labels)
x=modelsSummary2(fit,labels=labels)
str(x)
library(processR)
modelsSummary2Table(fit,labels=labels)
library(processR)
modelsSummary2Table(fit,labels=labels)
modelsSummaryTable(fit,labels=labels)
devtools::document()
devtools::check()
devtools::document()
devtools::check()
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp*vs+am,data=mtcars)
labels=list(Y="mpg",X="wt",W="hp",Z="vs")
fit=list(fit1,fit2)
modelsSummary2(fit,labels=labels)
modelsSummary2(fit,labels=labels,prefix=c("c","b"))
modelsSummary2(fit1)
modelsSummary2(fit,labels=labels)
modelsSummary2(fit,labels=labels,prefix=c("c","b"))
modelsSummary2(fit,labels=labels,prefix=c("c","b"),autoPrefix=FALSE)
devtools::document()
devtools::check()
devtools::document()
devtools::check()
library(processR)
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
devtools::document()
devtools::check()
system("grep -r 'medSummary' *")
labels=list(X="GDPpp",M="Illit",Y="LifeEx")
labels=list(X="cond",M="pmi",Y="reaction")
model=tripleEquation(labels=labels)
semfit=sem(model=model,data=pmi, se="boot", bootstrap=100)
library(lavaan)
labels=list(X="cond",M="pmi",Y="reaction")
model=tripleEquation(labels=labels)
library(processR)
library(lavaan)
labels=list(X="cond",M="pmi",Y="reaction")
model=tripleEquation(labels=labels)
semfit=sem(model=model,data=pmi, se="boot", bootstrap=100)
medSummary(semfit)
medSummaryTable(semfit)
str(medSummary(semfit))
myformat
x=0.0345
myformat(x)
x=0.0344
myformat(x)
