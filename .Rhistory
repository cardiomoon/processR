fit1=lm(respappr~d1+d2+sexism+d1:sexism+d2:sexism,data=protest1)
summary(fit1)
fit2=lm(liking~d1+d2+sexism+d1:sexism+d2:sexism+respappr,data=protest1)
summary(fit2)
labels=list(M="respappr",Y="liking",W="sexism")
x=modelsSummary(list(fit1,fit2),labels=labels)
x
modelsSummaryTable(x)
estimatesTable2(semfit)
parameterEstimates(semfit)
library(processR)
library(lavaan)
library(processR)
modmedSummary(semfit,mod="sexism")
x=modmedSummary(semfit,mod="sexism")
x
x=modmedSummary(semfit,mod="sexism")
x
parameterEstimates(semfit)
conditionalEffectPlot(semfit,data=protest1,mod="sexism")
x=modmedSummary(semfit,mod="sexism")
x
parameterEstimates(semfit)
model=catMediation(X="protest",M="respappr",Y="liking",data=protest1,moderator=moderator,maxylev=6,rangemode=2)
cat(model)
semfit=sem(model=model,data=protest1)
parameterEstimates(semfit)
x=modelsSummary(list(fit1,fit2),labels=labels)
x
modelsSummaryTable(x)
parameterEstimates(semfit)
conditionalEffectPlot(semfit,data=protest1,mod="sexism")
x=modmedSummary(semfit,mod="sexism")
x
model=catMediation(X="protest",M="respappr",Y="liking",data=protest1,moderator=moderator,maxylev=6,rangemode=1)
cat(model)
semfit=sem(model=model,data=protest1)
x=modmedSummary(semfit,mod="sexism")
x=modmedSummary(semfit,mod="sexism")
x
conditionalEffectPlot(semfit,data=protest1,mod="sexism")
model=catMediation(X="protest",M="respappr",Y="liking",data=protest1,moderator=moderator,maxylev=6,rangemode=1)
cat(model)
semfit=sem(model=model,data=protest1)
x=modelsSummary(list(fit1,fit2),labels=labels)
x
modelsSummaryTable(x)
x=modmedSummary(semfit,mod="sexism")
x
x=modmedSummary(semfit,mod="sexism")
x
conditionalEffectPlot(semfit,data=protest1,mod="sexism")
model=catMediation(X="protest",M="respappr",Y="liking",data=protest1,moderator=moderator,maxylev=6,rangemode=2)
cat(model)
semfit=sem(model=model,data=protest1)
parameterEstimates(semfit)
estimatesTable2(semfit)
x=modelsSummary(list(fit1,fit2),labels=labels)
x
modelsSummaryTable(x)
parameterEstimates(semfit)
parameterEstimates(semfit)
res=parameterEstimates(semfit)
res
res[str_detect(res$label,"indirect"),]
quantile(protest$sexism,probs=c(0.16,0.5,0.84),type=6)
res$est[res$label=="b1"]
b1=res$est[res$label=="b1"]
b1
res=parameterEstimates(semfit)
res[str_detect(res$label,"indirect")]
res=parameterEstimates(semfit)
res[str_detect(res$label,"indirect")]
model=catMediation(X="protest",M="respappr",Y="liking",data=protest1,moderator=moderator,maxylev=6,rangemode=2)
semfit=sem(model=model,data=protest1)
parameterEstimates(semfit)
res=parameterEstimates(semfit)
res[str_detect(res$label,"indirect")]
res[str_detect(res$label,"indirect"),]
res1=res[str_detect(res$label,"indirect"),]
res1$est
res1$est[c(2,1,3,5,4,6)]
indirect=res1$est[c(2,1,3,5,4,6)]
b1=res$est[res$label=="b1"]
b1
condIndirect=indirect/b1
res=parameterEstimates(semfit)
res1=res[str_detect(res$label,"indirect"),]
res1
length(res1)
nrow(res1)
no=c(2,1,3)
no+3
nrow(res1)
no=c(2,1,3)
count=nrow(res1)/3
no=c(2,1,3)
for(i in 2:count){
no=c(no,no+3)
}
no
for(i in 2:4){
no=c(no,no+3)
}
no=c(2,1,3)
for(i in 2:4){
no=c(no,no+3)
}
no
no=c(2,1,3)
for(i in 2:4){
no=c(no,no+3)
}
no
no=c(2,1,3)
temp=no
temp=no
for(i in 2:4){
temp=c(temp,no+3*(i-1))
}
temp
count=nrow(res1)/3
no=c(2,1,3)
temp=no
for(i in 2:count){
temp=c(temp,no+3*(i-1))
}
no=temp
no
indirect=res1$est[no]
(indirect=res1$est[no])
(b1=res$est[res$label=="b1"])
(condIndirect=indirect/b1)
W=quantile(protest$sexism,probs=c(0.16,0.5,0.84),type=6)
W
(indirectm=matrix(indirect,byrow=TRUE,nrow=3))
(indirectm=matrix(indirect,byrow=FALSE,nrow=3))
(cond=indirect/b1)
(condm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
(indm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
cbind(W,condm,b,indm)
res=cbind(W,condm,b,indm)
res
colnames(res)=c("W",paste0("ThetaD",1:count),"b",paste0("ThetaD",1:count,"B"))
res
colnames(res)=c("W",paste0("ThetaD",1:count),"b",paste0("ThetaD",1:count,"b"))
res
as.data.frame(res)
condIndirectSummary=function(semfit,W){
res=parameterEstimates(semfit)
res1=res[str_detect(res$label,"indirect"),]
nrow(res1)
count=nrow(res1)/3
no=c(2,1,3)
temp=no
for(i in 2:count){
temp=c(temp,no+3*(i-1))
}
no=temp
no
(indirect=res1$est[no])
(b1=res$est[res$label=="b1"])
(cond=indirect/b1)
(indm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
res=cbind(W,condm,b,indm)
colnames(res)=c("W",paste0("ThetaD",1:count),"b",paste0("ThetaD",1:count,"b"))
as.data.frame(res)
}
condIndirectSummary(semfit,W)
round(condIndirectSummary(semfit,W),3)
condIndirectSummary=function(semfit,W,digits=3){
res=parameterEstimates(semfit)
res1=res[str_detect(res$label,"indirect"),]
nrow(res1)
count=nrow(res1)/3
no=c(2,1,3)
temp=no
for(i in 2:count){
temp=c(temp,no+3*(i-1))
}
no=temp
no
(indirect=res1$est[no])
(b1=res$est[res$label=="b1"])
(cond=indirect/b1)
(indm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
res=cbind(W,condm,b,indm)
colnames(res)=c("W",paste0("ThetaD",1:count),"b",paste0("ThetaD",1:count,"b"))
round(as.data.frame(res),digits)
}
condIndirectSummary(semfit,W)
condIndirectSummary=function(semfit,W,digits=3){
res=parameterEstimates(semfit)
res1=res[str_detect(res$label,"indirect"),]
count=nrow(res1)/3
no=c(2,1,3)
temp=no
for(i in 2:count){
temp=c(temp,no+3*(i-1))
}
no=temp
(indirect=res1$est[no])
(b1=res$est[res$label=="b1"])
(cond=indirect/b1)
(indm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
res=cbind(W,condm,b,indm)
colnames(res)=c("W",paste0("ThetaD",1:count),"b",paste0("ThetaD",1:count,"b"))
round(as.data.frame(res),digits)
}
condIndirectSummary(semfit,W)
condIndirectSummary=function(semfit,W,digits=3){
res=parameterEstimates(semfit)
res1=res[str_detect(res$label,"indirect"),]
count=nrow(res1)/3
no=c(2,1,3)
temp=no
for(i in 2:count){
temp=c(temp,no+3*(i-1))
}
no=temp
(indirect=res1$est[no])
(b1=res$est[res$label=="b1"])
(cond=indirect/b1)
(indm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
res=cbind(W,condm,b,indm)
colnames(res)=c("W",paste0(greeks['theta'],"D",1:count),"b",paste0("ThetaD",1:count,"b"))
round(as.data.frame(res),digits)
}
condIndirectSummary(semfit,W)
condIndirectSummary=function(semfit,W,digits=3){
res=parameterEstimates(semfit)
res1=res[str_detect(res$label,"indirect"),]
count=nrow(res1)/3
no=c(2,1,3)
temp=no
for(i in 2:count){
temp=c(temp,no+3*(i-1))
}
no=temp
(indirect=res1$est[no])
(b1=res$est[res$label=="b1"])
(cond=indirect/b1)
(indm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
res=cbind(W,condm,b,indm)
colnames(res)=c("W",paste0('\u0398',"D",1:count),"b",paste0("ThetaD",1:count,"b"))
round(as.data.frame(res),digits)
}
condIndirectSummary(semfit,W)
condIndirectSummary=function(semfit,W,digits=3){
res=parameterEstimates(semfit)
res1=res[str_detect(res$label,"indirect"),]
count=nrow(res1)/3
no=c(2,1,3)
temp=no
for(i in 2:count){
temp=c(temp,no+3*(i-1))
}
no=temp
(indirect=res1$est[no])
(b1=res$est[res$label=="b1"])
(cond=indirect/b1)
(indm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
res=cbind(W,condm,b,indm)
colnames(res)=c("W",paste0('\u0398',"D",1:count),"b",paste0('\u0398',"D",1:count,"b"))
round(as.data.frame(res),digits)
}
condIndirectSummary(semfit,W)
condIndirectSummary(semfit,W)
condIndirectSummary=function(semfit,W,digits=3){
res=parameterEstimates(semfit)
res1=res[str_detect(res$label,"indirect"),]
count=nrow(res1)/3
no=c(2,1,3)
temp=no
for(i in 2:count){
temp=c(temp,no+3*(i-1))
}
no=temp
(indirect=res1$est[no])
(b1=res$est[res$label=="b1"])
(cond=indirect/b1)
(indm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
res=cbind(W,condm,b,indm)
colnames(res)=c("W",paste0('\u0398',"D",1:count,'\u8594',"M"),"b",paste0('\u0398',"D",1:count,'\u8594',"M","b"))
round(as.data.frame(res),digits)
}
condIndirectSummary(semfit,W)
condIndirectSummary=function(semfit,W,digits=3){
res=parameterEstimates(semfit)
res1=res[str_detect(res$label,"indirect"),]
count=nrow(res1)/3
no=c(2,1,3)
temp=no
for(i in 2:count){
temp=c(temp,no+3*(i-1))
}
no=temp
(indirect=res1$est[no])
(b1=res$est[res$label=="b1"])
(cond=indirect/b1)
(indm=matrix(indirect,byrow=FALSE,nrow=3))
(condm=matrix(cond,byrow=FALSE,nrow=3))
b=rep(b1,3)
res=cbind(W,condm,b,indm)
colnames(res)=c("W",paste0('\u0398',"D",1:count,'\u2192',"M"),"b",paste0('\u0398',"D",1:count,'\u2192',"M","b"))
round(as.data.frame(res),digits)
}
condIndirectSummary(semfit,W)
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
library(processR)
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris)
covar=list(name="Species",site=list("c"))
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris,covar=covar)
covar=list(name="Species",site=list("Y"))
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris,covar=covar)
covar=list(name="Species",site=list("Y"))
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris,covar=covar)
catMediation(X="Septal.Length",M="Petal.Width",Y="Sepal.Width",data=iris,covar=covar)
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris,covar=covar)
library(processR)
library(processR)
covar=list(name="Species",site=list("Y"))
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris)
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris,covar=covar)
covar=list(name=c("Species","Petal.Width"),site=list(c("Y"),c("M")))
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris)
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris,covar=covar)
covar=list(name=c("Species","Petal.Width"),site=list(c("M,Y"),c("Y")))
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris)
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris,covar=covar)
covar=list(name=c("Species","Petal.Width"),site=list(c("M","Y"),c("Y")))
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris,covar=covar)
covar$site=lapply(covar$site,function(x) str_replace(x,"M",M))
covar
y="Sepal.Width"
covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
covar
library(stringr)
covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
covar
Y="Sepal.Width"
covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
covar
system("grep -r 'addCovarEqua' *")
equation="M ~ X*W"
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
addCovarEquation(equation,covar=covar,prefix=NULL)
equation="M ~ X*W"
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
addCovarEquation(equation,covar=covar)
covar=list(name=c("carb","disp"),label=c("carb","disp"),site=list(c("M","Y"),"Y","Y"))
moderator=list(name=c("cyl","wt"),site=list(c("c"),c("c")))
cat(catMediation(X="am",Y="mpg",data=mtcars,moderator=moderator,covar=covar,maxylev=6))
library(processR)
moderator=list(name=c("cyl","wt"),site=list(c("c"),c("c")))
covar=list(name=c("carb","disp"),label=c("carb","disp"),site=list(c("M","Y"),"Y","Y"))
cat(catMediation(X="am",Y="mpg",data=mtcars,moderator=moderator,covar=covar,maxylev=6))
labels[["cyl"]]="g"
labels=list()
labels[["cyl"]]="g"
str(labels)
str(labels)
attr(labels[["cyl"]],"length")=3
labels
library(processR)
library(processR)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::check()
covar=list(name=c("carb","disp"),label=c("carb","disp"),site=list(c("M","Y"),"Y","Y"))
cat(catMediation(X="am",Y="mpg",data=mtcars,moderator=moderator,covar=covar,maxylev=6))
moderator=list(name=c("cyl","wt"),site=list(c("c"),c("c")))
covar=list(name=c("carb","disp"),label=c("carb","disp"),site=list(c("M","Y"),"Y","Y"))
cat(catMediation(X="am",Y="mpg",data=mtcars,moderator=moderator,covar=covar,maxylev=6))
library(processR)
moderator=list(name=c("cyl","wt"),site=list(c("c"),c("c")))
covar=list(name=c("carb","disp"),label=c("carb","disp"),site=list(c("M","Y"),"Y","Y"))
cat(catMediation(X="am",Y="mpg",data=mtcars,moderator=moderator,covar=covar,maxylev=6))
library(processR)
moderator=list(name=c("cyl","wt"),site=list(c("c"),c("c")))
covar=list(name=c("carb","disp"),label=c("carb","disp"),site=list(c("M","Y"),"Y","Y"))
cat(catMediation(X="am",Y="mpg",data=mtcars,moderator=moderator,covar=covar,maxylev=6))
cat(catMediation(X="am",Y="mpg",data=mtcars,moderator=moderator,covar=covar))
covar=list(name=c("Species","Petal.Width"),site=list(c("M","Y"),c("Y")))
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris)
catMediation(X="Septal.Length",Y="Sepal.Width",data=iris,covar=covar)
devtools::document()
devtools::check()
library(psych)
data(GSBE)  #alias to Garcia data set
GSBE
library(psych)
data(GSBE)  #alias to Garcia data set
GSBE
par(mfrow=c(2,1))
#compare two models  (bootstrapping n.iter set to 50 for speed
# 1) mean center the variables prior to taking product terms
mediate(respappr ~ prot2 * sexism +(sexism),data=Garcia,n.iter=50
,main="Moderated mediation (mean centered)")
# 2) do not mean center
mediate(respappr ~ prot2 * sexism +(sexism),data=Garcia,zero=FALSE, n.iter=50,
main="Moderated  mediation (not centered")
par(mfrow=c(1,1))
#demonstrate interaction plots
plot(respappr ~ sexism, pch = 23- protest, bg = c("black","red", "blue")[protest],
data=Garcia, main = "Response to sexism varies as type of protest")
by(Garcia,Garcia$protest, function(x) abline(lm(respappr ~ sexism,
data =x),lty=c("solid","dashed","dotted")[x$protest+1]))
text(6.5,3.5,"No protest")
text(3,3.9,"Individual")
text(3,5.2,"Collective")
Garcia
#demonstrate interaction plots
plot(respappr ~ sexism, pch = 23- protest, bg = c("black","red", "blue")[protest],
data=Garcia, main = "Response to sexism varies as type of protest")
by(Garcia,Garcia$protest, function(x) abline(lm(respappr ~ sexism,
data =x),lty=c("solid","dashed","dotted")[x$protest+1]))
text(6.5,3.5,"No protest")
text(3,3.9,"Individual")
text(3,5.2,"Collective")
par(mfrow=c(1,1))
#demonstrate interaction plots
plot(respappr ~ sexism, pch = 23- protest, bg = c("black","red", "blue")[protest],
data=Garcia, main = "Response to sexism varies as type of protest")
by(Garcia,Garcia$protest, function(x) abline(lm(respappr ~ sexism,
data =x),lty=c("solid","dashed","dotted")[x$protest+1]))
text(6.5,3.5,"No protest")
text(3,3.9,"Individual")
text(3,5.2,"Collective")
library(processR)
devtools::document()
devtools::check()
library(lavaan)
library(processR)
moderator=list(name=c("sexism"),site=list(c("a","c")))
protest1=addCatVars(protest,"protest",mode=2)
protest1
model=catMediation(X="protest",M="respappr",Y="liking",data=protest1,moderator=moderator,maxylev=6,rangemode=2)
cat(model)
semfit=sem(model=model,data=protest1)
parameterEstimates(semfit)
estimatesTable2(semfit)
fit1=lm(respappr~d1+d2+sexism+d1:sexism+d2:sexism,data=protest1)
summary(fit1)
fit2=lm(liking~d1+d2+sexism+d1:sexism+d2:sexism+respappr,data=protest1)
summary(fit2)
labels=list(M="respappr",Y="liking",W="sexism")
x=modelsSummary(list(fit1,fit2),labels=labels)
x
protest1=addCatVars(protest,"protest",mode=)
protest1
protest2=addCatVars(protest,"protest",mode=2)
fit1=lm(respappr~d1+d2+sexism+d1:sexism+d2:sexism,data=protest1)
summary(fit1)
fit2=lm(liking~d1+d2+sexism+d1:sexism+d2:sexism+respappr,data=protest1)
summary(fit2)
labels=list(M="respappr",Y="liking",W="sexism")
x=modelsSummary(list(fit1,fit2),labels=labels)
x
summary(fit1)
fit2=lm(liking~d1+d2+sexism+d1:sexism+d2:sexism+respappr,data=protest1)
summary(fit2)
labels=list(M="respappr",Y="liking",W="sexism")
x=modelsSummary(list(fit1,fit2),labels=labels)
x
summary(fit1)
summary(fit2)
labels=list(M="respappr",Y="liking",W="sexism")
x=modelsSummary(list(fit1,fit2),labels=labels)
x
summary(fit1)
moderator=list(name=c("sexism"),site=list(c("a","c")))
protest1=addCatVars(protest,"protest",mode=1)
protest1
model=catMediation(X="protest",M="respappr",Y="liking",data=protest1,moderator=moderator,maxylev=6,rangemode=2)
cat(model)
semfit=sem(model=model,data=protest1)
parameterEstimates(semfit)
estimatesTable2(semfit)
fit1=lm(respappr~d1+d2+sexism+d1:sexism+d2:sexism,data=protest1)
summary(fit1)
fit2=lm(liking~d1+d2+sexism+d1:sexism+d2:sexism+respappr,data=protest1)
summary(fit2)
labels=list(M="respappr",Y="liking",W="sexism")
x=modelsSummary(list(fit1,fit2),labels=labels)
x
summary(fit1)
moderator=list(name=c("sexism"),site=list(c("a","c")))
protest1=addCatVars(protest,"protest",mode=1)
protest1
fit1=lm(respappr~d1*sexism+d2*sexism,data=protest1)
summary(fit1)
