x=c(0+radx+xmargin,0.4)
y=c(1-(radx+xmargin),0.4)
m=c(0.5,0.4+yinterval)
moderator
select=which(moderator$pos==4)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.4+yinterval-0.05)
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==3)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.5-yinterval+0.05)
assign(paste0("z",select[j]),temp)
}
source('~/ownCloud/Documents/processR/R/conceptDiagram.R', echo=TRUE)
if(is.null(yinterval)) yinterval=rady*7
openplotmat()
x=c(0+radx+xmargin,0.4)
y=c(1-(radx+xmargin),0.4)
m=c(0.5,0.4+yinterval)
moderator
select=which(moderator$pos==4)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.4+yinterval-0.05)
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==3)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.5-yinterval+0.05)
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==2)
select
if(length(select)==1){
xpos=1-(radx+xmargin)
ypos=0.5+yinterval
} else{
xpos=midPoint(0.5+2*radx,1-radx,length(select))
ypos=midPoint(0.5+yinterval+2*rady,0.5+rady,length(select))
}
for(j in seq_along(select)){
temp=c(xpos[j],ypos[j])
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==1)
if(length(select)==1){
xpos=radx+xmargin
ypos=0.5+yinterval
} else{
xpos=midPoint(radx-xmargin,0.5-2*radx,length(select))
ypos=midPoint(0.5+rady,0.5+yinterval+2*rady,length(select))
}
for(j in seq_along(select)){
temp=c(xpos[j],ypos[j])
assign(paste0("z",select[j]),temp)
}
startpos=list()
sum=1
for(i in seq_along(moderator$pos)){
for(j in 1:length(moderator$site[[i]])){
startpos[[sum]]=get(paste0("z",i))
sum=sum+1
}
}
startpos
labels
(xlab=ifelse(is.null(labels[[X]]),X,labels[[X]]))
if(!is.null(M)) (mlab=ifelse(is.null(labels[[M]]),M,labels[[M]]))
(ylab=ifelse(is.null(labels[[Y]]),Y,labels[[Y]]))
if(!is.null(M)){
# myarrow(from=x,to=y,label="c'")
# myarrow(from=x,to=m,label="a")
# myarrow(from=m,to=y,label="b")
myarrow(from=x,to=y)
myarrow(from=x,to=m)
myarrow(from=m,to=y)
} else{
myarrow(from=x,to=y,label="")
}
x
y
m
z1
if(is.null(yinterval)) yinterval=rady*7
openplotmat()
x=c(0+radx+xmargin,0.4)
y=c(1-(radx+xmargin),0.4)
m=c(0.5,0.4+yinterval)
moderator
select=which(moderator$pos==4)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.4+yinterval-0.05)
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==3)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.5-yinterval+0.05)
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==2)
select
if(length(select)==1){
xpos=1-(radx+xmargin)
ypos=0.5+yinterval
} else{
xpos=midPoint(0.5+2*radx,1-radx,length(select))
ypos=midPoint(0.5+yinterval+2*rady,0.5+rady,length(select))
}
for(j in seq_along(select)){
temp=c(xpos[j],ypos[j])
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==1)
if(length(select)==1){
xpos=radx+xmargin
ypos=0.5+yinterval
} else{
xpos=midPoint(radx-xmargin,0.5-2*radx,length(select))
ypos=midPoint(0.5+rady,0.5+yinterval+2*rady,length(select))
}
for(j in seq_along(select)){
temp=c(xpos[j],ypos[j])
assign(paste0("z",select[j]),temp)
}
startpos=list()
sum=1
for(i in seq_along(moderator$pos)){
for(j in 1:length(moderator$site[[i]])){
startpos[[sum]]=get(paste0("z",i))
sum=sum+1
}
}
startpos
labels
(xlab=ifelse(is.null(labels[[X]]),X,labels[[X]]))
if(!is.null(M)) (mlab=ifelse(is.null(labels[[M]]),M,labels[[M]]))
(ylab=ifelse(is.null(labels[[Y]]),Y,labels[[Y]]))
if(!is.null(M)){
# myarrow(from=x,to=y,label="c'")
# myarrow(from=x,to=m,label="a")
# myarrow(from=m,to=y,label="b")
myarrow(from=x,to=y)
myarrow(from=x,to=m)
myarrow(from=m,to=y)
} else{
myarrow(from=x,to=y,label="")
}
if(xb) myarrow(from=x,to=0.5*(m+y))
if(mc) myarrow(from=m,to=0.5*(x+y))
endpos=moderator2pos(moderator,x,y,m)
endpos
for(i in seq_along(endpos)){
myarrow(from=startpos[[i]],to=endpos[[i]],adjust=0)
}
if(length(covar$name)>0) drawCovar(covar,x,y,m,radx=radx,rady=rady)
drawtext(x,radx=radx,rady=rady,lab=xlab,latent=latent[1])
drawtext(y,radx=radx,rady=rady,lab=ylab,latent=latent[3])
if(!is.null(M)) {
drawtext(m,radx=radx,rady=rady,lab=mlab,latent=latent[2])
}
for(i in seq_along(moderator$pos)){
z=eval(parse(text=paste0("z",i)))
lab=ifelse(is.null(moderator$label[i]),moderator$name[i],moderator$label[i])
drawtext(z,radx=radx,rady=rady,lab=lab,latent=moderator$latent[i])
}
#'moderator=list(name="Z1",label="Time Spent\n with Alex",pos=3,
#'     site=list(c("a","b","c")),latent=FALSE)
#'conceptDiagram2(moderator=moderator,labels=labels)
#'moderator=list(name=c("Z1","Z2"),label=c("Time Spent\n with Alex","Z2label"),pos=c(3,3),
#'     site=list(c("a","b","c"),c("b","c")),latent=c(FALSE,FALSE))
#'conceptDiagram2(moderator=moderator,labels=labels,yinterval=0.4)
#'covar=list(name=c("C1","C2","C3"),label=c("sex","tenure","ideology"),site=list(c("Y"),c("Y"),c("Y")))
#'conceptDiagram2(M=NULL,moderator=list(name="M",pos=4,site=list("c"),latent=FALSE),covar=covar)
#'conceptDiagram2(covar=covar)
#'@export
conceptDiagram2=function(X="X",M="M",Y="Y",latent=rep(FALSE,3),xb=FALSE,mc=FALSE,
radx=0.06,rady=0.06,xmargin=0.03,yinterval=NULL,
moderator=list(),labels=list(),covar=list()){
# radx=0.12;rady=0.05;xmargin=0.03;yinterval=NULL
# latent=rep(FALSE,3);xb=FALSE;mc=FALSE;labels=list()
# labels
#
# X="X";M="M";Y="Y";latent=rep(FALSE,3);xb=FALSE
# moderator
# library(diagram)
# covar
if(is.null(yinterval)) yinterval=rady*7
openplotmat()
x=c(0+radx+xmargin,0.45)
y=c(1-(radx+xmargin),0.45)
m=c(0.5,0.45+yinterval)
moderator
select=which(moderator$pos==4)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.4+yinterval-0.05)
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==3)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.5-yinterval+0.05)
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==2)
select
if(length(select)==1){
xpos=1-(radx+xmargin)
ypos=0.5+yinterval
} else{
xpos=midPoint(0.5+2*radx,1-radx,length(select))
ypos=midPoint(0.5+yinterval+2*rady,0.5+rady,length(select))
}
for(j in seq_along(select)){
temp=c(xpos[j],ypos[j])
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==1)
if(length(select)==1){
xpos=radx+xmargin
ypos=0.5+yinterval
} else{
xpos=midPoint(radx-xmargin,0.5-2*radx,length(select))
ypos=midPoint(0.5+rady,0.5+yinterval+2*rady,length(select))
}
for(j in seq_along(select)){
temp=c(xpos[j],ypos[j])
assign(paste0("z",select[j]),temp)
}
startpos=list()
sum=1
for(i in seq_along(moderator$pos)){
for(j in 1:length(moderator$site[[i]])){
startpos[[sum]]=get(paste0("z",i))
sum=sum+1
}
}
startpos
labels
(xlab=ifelse(is.null(labels[[X]]),X,labels[[X]]))
if(!is.null(M)) (mlab=ifelse(is.null(labels[[M]]),M,labels[[M]]))
(ylab=ifelse(is.null(labels[[Y]]),Y,labels[[Y]]))
if(!is.null(M)){
# myarrow(from=x,to=y,label="c'")
# myarrow(from=x,to=m,label="a")
# myarrow(from=m,to=y,label="b")
myarrow(from=x,to=y)
myarrow(from=x,to=m)
myarrow(from=m,to=y)
} else{
myarrow(from=x,to=y,label="")
}
if(xb) myarrow(from=x,to=0.5*(m+y))
if(mc) myarrow(from=m,to=0.5*(x+y))
endpos=moderator2pos(moderator,x,y,m)
endpos
for(i in seq_along(endpos)){
myarrow(from=startpos[[i]],to=endpos[[i]],adjust=0)
}
if(length(covar$name)>0) drawCovar(covar,x,y,m,radx=radx,rady=rady)
drawtext(x,radx=radx,rady=rady,lab=xlab,latent=latent[1])
drawtext(y,radx=radx,rady=rady,lab=ylab,latent=latent[3])
if(!is.null(M)) {
drawtext(m,radx=radx,rady=rady,lab=mlab,latent=latent[2])
}
for(i in seq_along(moderator$pos)){
z=eval(parse(text=paste0("z",i)))
lab=ifelse(is.null(moderator$label[i]),moderator$name[i],moderator$label[i])
drawtext(z,radx=radx,rady=rady,lab=lab,latent=moderator$latent[i])
}
}
conceptDiagram2(covar=covar)
covar=list(name=c("C1","C2","C3"),label=c("sex","tenure","ideology"),site=list(c("Y"),c("Y"),c("Y")))
conceptDiagram2(covar=covar)
#'moderator=list(name="Z1",label="Time Spent\n with Alex",pos=3,
#'     site=list(c("a","b","c")),latent=FALSE)
#'conceptDiagram2(moderator=moderator,labels=labels)
#'moderator=list(name=c("Z1","Z2"),label=c("Time Spent\n with Alex","Z2label"),pos=c(3,3),
#'     site=list(c("a","b","c"),c("b","c")),latent=c(FALSE,FALSE))
#'conceptDiagram2(moderator=moderator,labels=labels,yinterval=0.4)
#'covar=list(name=c("C1","C2","C3"),label=c("sex","tenure","ideology"),site=list(c("Y"),c("Y"),c("Y")))
#'conceptDiagram2(M=NULL,moderator=list(name="M",pos=4,site=list("c"),latent=FALSE),covar=covar)
#'conceptDiagram2(covar=covar)
#'@export
conceptDiagram2=function(X="X",M="M",Y="Y",latent=rep(FALSE,3),xb=FALSE,mc=FALSE,
radx=0.06,rady=0.06,xmargin=0.03,yinterval=NULL,
moderator=list(),labels=list(),covar=list()){
# radx=0.12;rady=0.05;xmargin=0.03;yinterval=NULL
# latent=rep(FALSE,3);xb=FALSE;mc=FALSE;labels=list()
# labels
#
# X="X";M="M";Y="Y";latent=rep(FALSE,3);xb=FALSE
# moderator
# library(diagram)
# covar
if(is.null(yinterval)) yinterval=rady*7
openplotmat()
x=c(0+radx+xmargin,0.5)
y=c(1-(radx+xmargin),0.5)
m=c(0.5,0.5+yinterval)
moderator
select=which(moderator$pos==4)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.4+yinterval-0.05)
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==3)
xpos=midPoint(0,1,length(select))
select
for(j in seq_along(select)){
temp=c(xpos[j],0.5-yinterval+0.05)
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==2)
select
if(length(select)==1){
xpos=1-(radx+xmargin)
ypos=0.5+yinterval
} else{
xpos=midPoint(0.5+2*radx,1-radx,length(select))
ypos=midPoint(0.5+yinterval+2*rady,0.5+rady,length(select))
}
for(j in seq_along(select)){
temp=c(xpos[j],ypos[j])
assign(paste0("z",select[j]),temp)
}
select=which(moderator$pos==1)
if(length(select)==1){
xpos=radx+xmargin
ypos=0.5+yinterval
} else{
xpos=midPoint(radx-xmargin,0.5-2*radx,length(select))
ypos=midPoint(0.5+rady,0.5+yinterval+2*rady,length(select))
}
for(j in seq_along(select)){
temp=c(xpos[j],ypos[j])
assign(paste0("z",select[j]),temp)
}
startpos=list()
sum=1
for(i in seq_along(moderator$pos)){
for(j in 1:length(moderator$site[[i]])){
startpos[[sum]]=get(paste0("z",i))
sum=sum+1
}
}
startpos
labels
(xlab=ifelse(is.null(labels[[X]]),X,labels[[X]]))
if(!is.null(M)) (mlab=ifelse(is.null(labels[[M]]),M,labels[[M]]))
(ylab=ifelse(is.null(labels[[Y]]),Y,labels[[Y]]))
if(!is.null(M)){
# myarrow(from=x,to=y,label="c'")
# myarrow(from=x,to=m,label="a")
# myarrow(from=m,to=y,label="b")
myarrow(from=x,to=y)
myarrow(from=x,to=m)
myarrow(from=m,to=y)
} else{
myarrow(from=x,to=y,label="")
}
if(xb) myarrow(from=x,to=0.5*(m+y))
if(mc) myarrow(from=m,to=0.5*(x+y))
endpos=moderator2pos(moderator,x,y,m)
endpos
for(i in seq_along(endpos)){
myarrow(from=startpos[[i]],to=endpos[[i]],adjust=0)
}
if(length(covar$name)>0) drawCovar(covar,x,y,m,radx=radx,rady=rady)
drawtext(x,radx=radx,rady=rady,lab=xlab,latent=latent[1])
drawtext(y,radx=radx,rady=rady,lab=ylab,latent=latent[3])
if(!is.null(M)) {
drawtext(m,radx=radx,rady=rady,lab=mlab,latent=latent[2])
}
for(i in seq_along(moderator$pos)){
z=eval(parse(text=paste0("z",i)))
lab=ifelse(is.null(moderator$label[i]),moderator$name[i],moderator$label[i])
drawtext(z,radx=radx,rady=rady,lab=lab,latent=moderator$latent[i])
}
}
conceptDiagram2(M=NULL,moderator=list(name="M",pos=4,site=list("c"),latent=FALSE),covar=covar)
conceptDiagram2(covar=covar)
conceptDiagram2(M=NULL,moderator=list(name="M",pos=4,site=list("c"),latent=FALSE),covar=covar)
conceptDiagram2(covar=covar)
library(processR)
covar=NULL
length(covar$name)
library(processR)
conceptDiagram2(covar=covar)
covar=list(name=c("C1","C2","C3"),label=c("sex","tenure","ideology"),site=list(c("Y"),c("Y"),c("Y")))
conceptDiagram2(M=NULL,moderator=list(name="M",pos=4,site=list("c"),latent=FALSE),covar=covar)
conceptDiagram2(covar=covar)
labels=list(X="Time Spent in\n Grad School", M="# of\n Publications", Y="# of Job Offers")
conceptDiagram2(xb=TRUE,labels=labels)
moderator=list(name="Z1",label="Time Spent\n with Alex",pos=3,
site=list(c("a","b","c")),latent=FALSE)
conceptDiagram2(moderator=moderator,labels=labels)
moderator=list(name=c("Z1","Z2"),label=c("Time Spent\n with Alex","Z2label"),pos=c(3,3),
library(processR)
runApp('inst/processR')
runApp('inst/processR')
labels=list(X="Time Spent in\n Grad School", M="# of\n Publications", Y="# of Job Offers")
conceptDiagram2(xb=TRUE,labels=labels)
library(extrafont)
font_import()
fonts()
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
library(processR)
shiny::runApp('inst/processR')
shiny::runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
add_plot
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
add_ggplot
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
runApp('inst/processR')
add_flextable
runApp('inst/processR')
runApp('inst/processR')
shiny::runApp('inst/processR')
fonts()
library(processR)
moderator=list(name="skeptic",site=list(c("a","c")))
model=tripleEquation(X="frame",M="justify",Y="donate",moderator=moderator)
cat(model)
semfit=sem(model=model,data=disaster)
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="Arial"))
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="Comic Sans"))
fonts()
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="Comic Sans MS"))
library(processR)
library(processR)
moderator=list(name="skeptic",site=list(c("a","c")))
model=tripleEquation(X="frame",M="justify",Y="donate",moderator=moderator)
cat(model)
semfit=sem(model=model,data=disaster)
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="Comic Sans MS"))
library(processR)
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="Comic Sans MS"))
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")
runApp('inst/processR')
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="sans"))
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="Sans"))
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="sans"))
library(processR)
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="sans"))
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="Comic Sans MS"))
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="Sans"))
conditionalEffectPlot(semfit,data=disaster,mod="skeptic")+theme(text=element_text(family="sans"))
library(processR)
runApp('inst/processR')
library(processR)
runApp('inst/processR')
library(processR)
