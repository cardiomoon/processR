hlabel=as.list(hlabel)
hlabel
ft<-ft %>% set_header_labels(values=hlabel)
colcount=5+ifelse(vanilla,1,0)
ft
for(i in 1:count){
ft<- ft %>% merge_h_range(i=(rowcount-4):rowcount,
j1=colcount*(i-1)+3,j2=colcount*(i-1)+6)
}
ft<- ft %>% align(align="center",part="all") %>%
hline_top(part="header",border=fp_border(color="white",width=0))
ft
for(i in 1:count){
ft <- ft %>% hline_top(j=((i-1)*colcount+2):(i*colcount),
part="header",border=fp_border(color="black",width=1))
}
big_border=fp_border(color="black",width=2)
hlabel=c("","",modelNames[1],rep("",3))
if(count>1){
for(i in 2:count){
if(vanilla) {hlabel=c(hlabel,"","",modelNames[i],rep("",3))}
else {hlabel=c(hlabel,"",modelNames[i],rep("",3))}
}
}
hlabel<-setNames(hlabel,col_keys)
hlabel=as.list(hlabel)
hlabel
length(hlabel)
length(col_keys)
count
colcount
ft
ft <- add_header_row(ft,values=hlabel,top=TRUE,
colwidths=rep(1,count*colcount+ifelse(vanilla,0,1)))
ft <- ft %>%
hline_top(j=2:(count*colcount++ifelse(vanilla,0,1)),part="header",border=fp_border(color="black",width=1))
ft
for(i in 1:count){
ft<-ft %>% hline(i=1,j=((i-1)*colcount+3):((i-1)*colcount+6),
part="header",border=fp_border(color="black",width=1))
}
for(i in 1:count){
ft <- ft %>% merge_h_range (i=1,j1=(i-1)*colcount+3,j2=(i-1)*colcount+6,
part="header")
}
ft
hlabel=list(name1="",coef1="Consequent")
ft<-ft %>%
add_header_row(top=TRUE,values=hlabel,
colwidths=c(1,count*colcount+ifelse(vanilla,0,1)-1)) %>%
hline_top(part="header",border=big_border) %>%
hline(i=1,j=2:(count*colcount+ifelse(vanilla,0,1)),part="header",
border=fp_border(color="black",width=1)) %>%
merge_h_range(i=1,j1=2,j2=count*colcount+ifelse(vanilla,0,1),part="header") %>%
align(align="center",part="header") %>%
align(align="right",part="body") %>%
bold(part="header") %>%
align(i=(nrow(x)-4):nrow(x),align="center",part="body") %>%
fontsize(part="all",size=12) %>%
hline(i=rowcount-5,border=fp_border(color="gray"),part="body")
ft
if(count>1){
if(vanilla) {
for(i in 1:(count-1)){
ft<-ft %>% width(j=i*6+1,width=0.001)
}
for(i in 1:count){
ft<-ft %>%  width(j=(i-1)*6+2,width=0.4)
}
} else{
for(i in 1:count){
ft<-ft %>% width(j=(i-1)*5+2,width=0.4)
}
}
for(i in 1:(count)){
ft<-ft %>% italic(i=3,j=c(((i-1)*colcount+3):((i-1)*colcount+5)),
italic=TRUE,part="header")
}
} else{
ft<-ft %>% width(j=2,width=0.4)
}
ft
if(!vanilla){
ft <-ft %>%
theme_zebra(even_body="#EFEFEF",odd_body="transparent",
even_header ="#5B7778",odd_header="#5B7778") %>%
fontsize(size=12,part="all") %>%
align(align="center",part="header") %>%
align(j=1,align="center",part="body") %>%
align(j=2:(1+colcount*count),align="right",part="body") %>%
align(i=(nrow(x)-4):nrow(x),align="center",part="body") %>%
color(color="white",part="header") %>%
hline(j=2:(1+colcount*count),border=fp_border(color="black",width=1),
part="header") %>%
vline(j=1:(1+colcount*count),border=fp_border(color="black",width=1),
part="header") %>%
vline_left(border=fp_border(color="black",width=1),
part="header") %>%
hline(j=1:(1+colcount*count),border=fp_border(color="#EDBD3E",width=1),
part="body") %>%
vline(j=1:(1+colcount*count),border=fp_border(color="#EDBD3E",width=1),
part="body") %>%
vline_left(border=fp_border(color="#EDBD3E",width=1),
part="body")
}
ft
count=ncol(x)/5
label=paste0("label",1:count)
ft<-ft %>% numberSubscript(label=label) %>%
align(align="center",j=label,part="body")
ft<-ft %>% width(j=1,width=0.3)  %>%
align(align="center",j=1,part="body")
if(vanilla) {
ft<- ft %>% width(j=2:((count-1)*6+2),width=0.9)
if(count>1) {
for(i in 1:(count-1)){
ft<-ft %>% width(j=i*6+1,width=0.001)
}
}
}
ft
}
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
library(processR)
x=modelsSummary(fit1,labels=labels)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
ft<-modelsSummaryTable(x)
ft
ft %>% width(j=2,width=0.01)
ft
ft %>% width(j=3,width=0.01)
ft
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
library(processR)
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
library(processR)
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels)
ft<-modelsSummaryTable(list(fit1,fit2),labels=labels)
ft
ft %>% width(j=7,width=0.01)
ft %>% width(j=7,width=0.001)
ft %>% width(j=8,width=0.001)
ft
ft %>% width(j=7,width=0.001)
ft %>% width(j=8,width=0.001)
ft %>% width(j=7:8,width=0.001)
ft
ft %>% width(j=7,width=0.001)
ft %>% width(j=7:8,width=0.001)
ft
ft %>% width(j=8:9,width=0.001)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp*am,data=mtcars)
fit=list(fit1,fit2)
labels=list(Y="mpg",X="wt",W="hp",Z="am")
modelsSummary(fit,labels=labels)
ft=modelsSummaryTable(x)
ft
library(processR)
ft=modelsSummaryTable(x)
ft
ft
compose(ft,j=2,
value=as_paragraph(
pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(",label[i],",'[^0-9yYmM]*'),
a~ stringr::str_extract(",label[i],",'[0-9yYmM].*')),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE))),
part='body')
ft
compose(ft,j=2,
value=as_paragraph(
as_chunk(pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(",label[i],",'[^0-9yYmM]*'),
a~ stringr::str_extract(",label[i],",'[0-9yYmM].*')),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE)))),
part='body')
compose(ft,j=2,
value=as_paragraph(
as_chunk(label1,pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(",label[i],",'[^0-9yYmM]*'),
a~ stringr::str_extract(",label[i],",'[0-9yYmM].*')),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE)))),
part='body')
compose(ft,j=2,
value=as_paragraph(
as_chunk('label1',pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(",label[i],",'[^0-9yYmM]*'),
a~ stringr::str_extract(",label[i],",'[0-9yYmM].*')),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE)))),
part='body')
ft
compose(ft,j=2,
value=as_paragraph(
as_chunk(label1,pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(",label1,",'[^0-9yYmM]*'),
a~ stringr::str_extract(",label1,",'[0-9yYmM].*')),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE)))),
part='body')
compose(ft,j=2,
value=as_paragraph(
as_chunk(label1,pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(label1,[^0-9yYmM]*),
a~ stringr::str_extract(label1,[0-9yYmM].*)),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE)))),
part='body')
compose(ft,j=2,
as_chunk(label1,pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(label1,[^0-9yYmM]*),
a~ stringr::str_extract(label1,[0-9yYmM].*)),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE))),
part='body')
ft
compose(ft,j=2,
as_chunk(label1,pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(label1,[^0-9yYmM]*),
a~ stringr::str_extract(label1,[0-9yYmM].*)),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE))),
part='body')
ft
compose(ft,j=2,
as_chunk(label1,pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(label1,'[^0-9yYmM]*'),
a~ stringr::str_extract(label1,'[0-9yYmM].*')),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE))),
part='body')
myft <- flextable( head(iris, n = 10 ))
myft
myft <- compose( myft, j = 1,
value = as_paragraph(
minibar(value = Sepal.Length, max = max(Sepal.Length)),
" ",
as_chunk( Sepal.Length, formater = formatC,
props = fp_text(color = "orange") ),
" blah blah"
),
part = "body")
autofit(myft)
myft <- flextable( head(iris, n = 10 ))
myft
myft <- compose( myft, j = 1,
value = as_paragraph(
minibar(value = Sepal.Length, max = max(Sepal.Length)),
" ",
as_chunk( Sepal.Length, formater = formatC,
props = fp_text(color = "orange") ),
" blah blah"
),
part = "body")
autofit(myft)
ft
x
str(x)
ft
compose(ft,j=2,
as_chunk(label1,pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(label1,'[^0-9yYmM]*'),
a~ stringr::str_extract(label1,'[0-9yYmM].*')),
fprops = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE))),
part='body')
ft
compose(ft,j=2,
as_chunk(label1,pattern = '{{A}}{{a}}',
formatters = list(A ~ stringr::str_extract(label1,'[^0-9yYmM]*'),
a~ stringr::str_extract(label1,'[0-9yYmM].*')),
props = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE))),
part='body')
ft
compose(ft,j=2,
as_chunk(label1,
formatters = list(pattern = '{{A}}{{a}}',
A ~ stringr::str_extract(label1,'[^0-9yYmM]*'),
a~ stringr::str_extract(label1,'[0-9yYmM].*')),
props = list(A=fp_text(italic=TRUE),a=fp_text(vertical.align='subscript',italic=TRUE))),
part='body')
ft <- compose(ft, i = 1, j = "dummy", part = "header",
value = as_paragraph(
as_sub("Sepal.Length"),
" anything "
) )
autofit(ft)
ft <- flextable( head(iris), col_keys = c("dummy") )
ft <- compose(ft, i = 1, j = "dummy", part = "header",
value = as_paragraph(
as_sub("Sepal.Length"),
" anything "
) )
autofit(ft)
ft <- flextable( head(iris), col_keys = c("dummy") )
ft
ft <- flextable( head(iris), col_keys = c("dummy") )
ft
ft <- compose(ft, i = 1, j = "dummy", part = "header",
value = as_paragraph(
as_sub("Sepal.Length"),
" anything "
) )
autofit(ft)
ft
fit1=lm(mpg~wt,data=mtcars)
x=modelsSummary(fit1,labels=labels)
ft=modelsSummaryTable(x)
ft
ft <- flextable( head(iris),
col_keys = c("Species", "Sepal", "Petal") )
ft <- set_header_labels(ft, Sepal="Sepal", Petal="Petal")
ft <- compose(ft, j = "Sepal",
value = as_paragraph( as_bracket(Sepal.Length, Sepal.Width) ) )
ft <- compose(ft, j = "Petal",
value = as_paragraph( as_bracket(Petal.Length, Petal.Width) ) )
autofit(ft)
fit1=lm(mpg~wt,data=mtcars)
x=modelsSummary(fit1,labels=labels)
ft=modelsSummaryTable(x)
ft
ft
compose(ft,j=2,
value=as_paragraph(
as_i(stringr::str_extract(label1,'[^0-9yYmM]*')),
as_i(as_sub(stringr::str_extract(label1,'[0-9yYmM].*')))),
part='body')
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
x=modelsSummary(list(fit1,fit2),labels=labels)
ft=modelsSummaryTable(x)
ft
compose(ft,j=2,
value=as_paragraph(
as_i(stringr::str_extract(label1,'[^0-9yYmM]*')),
as_i(as_sub(stringr::str_extract(label1,'[0-9yYmM].*')))),
part='body')
compose(ft,j=8,
value=as_paragraph(
as_i(stringr::str_extract(label2,'[^0-9yYmM]*')),
as_i(as_sub(stringr::str_extract(label2,'[0-9yYmM].*')))),
part='body')
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
ft=modelsSummaryTable(x)
ft
compose(ft,j=2,
value=as_paragraph(
as_i(stringr::str_extract(label1,'[^0-9yYmM]*')),
as_i(as_sub(stringr::str_extract(label1,'[0-9yYmM].*')))),
part='body')
compose(ft,j=8,
value=as_paragraph(
as_i(stringr::str_extract(label2,'[^0-9yYmM]*')),
as_i(as_sub(stringr::str_extract(label2,'[0-9yYmM].*')))),
part='body')
compose(ft,j=14,
value=as_paragraph(
as_i(stringr::str_extract(label3,'[^0-9yYmM]*')),
as_i(as_sub(stringr::str_extract(label3,'[0-9yYmM].*')))),
part='body')
devtools::docuemnt()
devtools::document()
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp*am,data=mtcars)
fit=list(fit1,fit2)
labels=list(Y="mpg",X="wt",W="hp",Z="am")
modelsSummary(fit,labels=labels)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
devtools::document()
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels,vanilla=FALSE)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
library(processR)
modelsSummaryTable(x)
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
library(processR)
modelsSummaryTable(x,vanilla=FALSE)
modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(list(fit1,fit2),labels=labels,vanilla=FALSE)
modelsSummaryTable(list(fit1,fit2),labels=labels)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
devtools::document()
devtools::check()
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
x=modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit3=lm(mpg~wt*hp*am,data=mtcars)
labels=list(X="wt",W="hp",Y="mpg",Z="am")
x=modelsSummary(fit1,labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
x=modelsSummary(list(fit1,fit2),labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
x=modelsSummary(list(fit1,fit2,fit3),labels=labels)
modelsSummaryTable(x)
modelsSummaryTable(x,vanilla=FALSE)
devtools::document()
devtools::check()
