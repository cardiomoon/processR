effectDf=data.frame(modx.values,coef,pvalue)
colnames(effectDf)[1]="x"
df=effectDf
df
b1=fit$coef[pred]
b1
b3=fit$coef[paste0(pred,":",modx)]
fun=function(x){b1+b3*x}
df$yend=0
df$y=fun(df$x)
df$labely=df$y
if(!is.null(ypos)){
if(length(ypos)==1) ypos=rep(ypos,nrow(df))
for(i in seq_along(ypos)){
if(ypos[i]==1) {
df$labely[i]=df$yend[i]
} else if(ypos[i]==2) {
df$labely[i]=(df$y[i]+df$yend[i])/2
}
}
}
df1=data.frame(slope=b3,intercept=b1,label=paste0("theta[italic(X)%->%italic(Y)]==",
round(b1,digits),ifelse(b3>=0,"+",""),round(b3,digits),"*italic(W)"))
df1
if(!is.null(labels)){
if(nrow(df1)==length(labels)) df1$label=labels
}
df$label=paste0("italic(W) ==",round(df$x,digits))
df$label2=paste0("theta[italic(X)%->%italic(Y)]==",round(df$coef,digits),"(italic(p) ==",round(df$pvalue,3),")")
df$hjust=-0.1
if(!is.null(hjust)){
df$hjust=hjust
}
p<-ggplot(data=data,aes_string(x=modx))
# p<-add_lines(p,df1,parse=TRUE,vjust=-0.3,size=linesize)
p<-add_lines(p,df1,parse=TRUE,vjust=-0.3,size=linesize,...)
p
info=getAspectRatio(p)
for(i in seq_along(modx.values)){
p<-p+geom_vline(xintercept=modx.values[i],color=linecolor,linetype=2)
}
p<-p+ geom_text(data=df,aes_string(x="x",label="label"),y=info$ymin,parse=TRUE)+
geom_text(data=df,aes_string(x="x",y="labely",label="label2",hjust="hjust"),
parse=TRUE)
p
p<-p+geom_hline(yintercept=0,color=linecolor,linetype=3)
p<-p + geom_segment(data=df,aes_string(x="x",y="y",xend="x",yend="yend"),
arrow=arrow(angle=20,length=unit(0.3,"cm"),type="closed"),
color="red",linetype=linetype,size=arrowsize)
p+labs(x=paste(modx,"(W)"),
y=expression(paste("Conditional Effect (", theta[italic(X) %->%italic(Y)],")")))
}
# fit=lm(justify~skeptic*frame,data=disaster)
fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=1;rangemode=2;digits=3
ypos=NULL;linecolor="gray60";linetype=2;linesize=1;arrowsize=1;digits=3
data=fit$model
data
dep=colnames(data)[1]
if(is.null(pred)) pred=colnames(data)[2]
if(is.null(modx)) modx=setdiff(colnames(data)[2:3],pred)
if(length(colnames(data)[3])>3) {
mod2=colnames(data)[4]
} else {
mod2=NULL
}
if(is.null(pred.values)){
if(length(unique(data[[pred]]))<6) {
pred.values=unique(data[[pred]])
} else if(rangemode==1) {
pred.values=mean(data[[pred]],na.rm=TRUE)+c(-1,0,1)*sd(data[[pred]],na.rm=TRUE)
} else if(rangemode==2) {
pred.values=quantile(data[[pred]],probs=c(0.16,0.5,0.84),type=6)
}
}
if(is.null(modx.values)){
if(length(unique(data[[modx]]))<6) {
modx.values=unique(data[[modx]])
} else if(rangemode==1){
modx.values=mean(data[[modx]],na.rm=T)+c(-1,0,1)*sd(data[[modx]],na.rm=T)
} else{
modx.values=quantile(data[[modx]],probs=c(0.16,0.5,0.84),type=6)
}
}
coef<-pvalue<-c()
for(i in seq_along(modx.values)){
equation=deparse(fit$call)
temp=stringr::str_replace(equation,modx,paste0("I(",modx,"-",modx.values[i],")"))
fit1=eval(parse(text=temp))
print(summary(fit1))
coef=c(coef,fit1$coef[3])
pvalue=c(pvalue,summary(fit1)$coef[3,4])
}
effectDf=data.frame(modx.values,coef,pvalue)
colnames(effectDf)[1]="x"
effectDf
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
library(processR)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
fit=lm(justify~frame*skeptic,data=disaster)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
modSummary(fit)
summary(fit)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,mode=3)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
fit=lm(justify~frame*skeptic,data=disaster)
library(processR)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
modSummary(fit)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
summary(fit)
ggPredict(fit)
ggPredict(fit,pred=frame,modx=skeptic)
ggPredict(fit,pred=skeptic,modx=frame)
ggPredict(fit,pred=skeptic,modx=frame,show.point = FALSE)
ggPredict(fit,pred=skeptic,modx=frame,show.point = FALSE,digits=3)
ggPredict(fit,pred=skeptic,modx=frame,show.point = FALSE)
ggPredict(fit,pred=skeptic,modx=frame,show.point = FALSE,digits=3)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,mode=2,xpos=0.6)
modSummary(fit)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,hjust=c(1.1,-0.1),ypos=2,rangemode=2)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,mode=2,xpos=0.6)
ggPredict(fit,pred=skeptic,modx=frame)
ggPredict(fit,pred=skeptic,modx=frame,show.point=FALSE,digits=3)
calEquation(fit,pred="frame",modx.values=c(0,1))
calEquation(fit,pred="skeptic",modx.values=c(0,1))
fit=lm(justify~frame*skeptic,data=disaster)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,mode=2,xpos=0.6)
fit=lm(justify~frame*skeptic,data=disaster)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,mode=2,xpos=0.6)
plot(1:10,xlab=expression(hat(y)))
plot(1:10,xlab=expression(hat(y) == 0.3))
plot(1:10,xlab=expression(hat(y) == 0.3 W+0.5))
plot(1:10,xlab=expression(hat(y) == 0.3*W+0.5))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
library(processR)
condPlot(fit,mode=2,xpos=0.6)
calEquation(fit,pred="skeptic",modx.values=c(0,1))
p+xlab(expression(paste(theta[X %->%Y]," , ",italic(p),"=")))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5 (frame=0)))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5 (frame==0)))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5 |frame==0))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5 (frame==0))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5 (frame==0))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5(frame==0))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5(frame==0)))
modx="frame"
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5(frame==0)))
df1= calEquation(fit,pred=modx, modx.values = pred.values)
fit=lm(justify~skeptic*frame,data=disaster)
# fit=lm(justify~skeptic*frame,data=disaster)
# fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=1;rangemode=2;digits=3
ypos=NULL;linecolor="gray60";linetype=2;linesize=1;arrowsize=1;digits=3
data=fit$model
data
dep=colnames(data)[1]
if(is.null(pred)) pred=colnames(data)[2]
if(is.null(modx)) modx=setdiff(colnames(data)[2:3],pred)
if(length(colnames(data)[3])>3) {
mod2=colnames(data)[4]
} else {
mod2=NULL
}
# coef<-pvalue<-c()
if(is.null(modx.values)){
if(length(unique(data[[modx]]))<6) {
modx.values=unique(data[[modx]])
} else if(rangemode==1){
modx.values=mean(data[[modx]],na.rm=T)+c(-1,0,1)*sd(data[[modx]],na.rm=T)
} else{
modx.values=quantile(data[[modx]],probs=c(0.16,0.5,0.84),type=6)
}
}
if(is.null(pred.values)){
if(length(unique(data[[pred]]))<6) {
pred.values=unique(data[[pred]])
} else if(rangemode==1) {
pred.values=mean(data[[pred]],na.rm=TRUE)+c(-1,0,1)*sd(data[[pred]],na.rm=TRUE)
} else if(rangemode==2) {
pred.values=quantile(data[[pred]],probs=c(0.16,0.5,0.84),type=6)
}
}
df1= calEquation(fit,pred=modx, modx.values = pred.values)
df1
# fit=lm(justify~skeptic*frame,data=disaster)
fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(justify~skeptic*frame,data=disaster)
# fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=1;rangemode=2;digits=3
ypos=NULL;linecolor="gray60";linetype=2;linesize=1;arrowsize=1;digits=3
data=fit$model
data
dep=colnames(data)[1]
if(is.null(pred)) pred=colnames(data)[2]
if(is.null(modx)) modx=setdiff(colnames(data)[2:3],pred)
if(length(colnames(data)[3])>3) {
mod2=colnames(data)[4]
} else {
mod2=NULL
}
# coef<-pvalue<-c()
if(is.null(modx.values)){
if(length(unique(data[[modx]]))<6) {
modx.values=unique(data[[modx]])
} else if(rangemode==1){
modx.values=mean(data[[modx]],na.rm=T)+c(-1,0,1)*sd(data[[modx]],na.rm=T)
} else{
modx.values=quantile(data[[modx]],probs=c(0.16,0.5,0.84),type=6)
}
}
if(is.null(pred.values)){
if(length(unique(data[[pred]]))<6) {
pred.values=unique(data[[pred]])
} else if(rangemode==1) {
pred.values=mean(data[[pred]],na.rm=TRUE)+c(-1,0,1)*sd(data[[pred]],na.rm=TRUE)
} else if(rangemode==2) {
pred.values=quantile(data[[pred]],probs=c(0.16,0.5,0.84),type=6)
}
}
df1= calEquation(fit,pred=modx, modx.values = pred.values)
df1
pred
df1[[pred]]=pred.values
df1
fit=lm(justify~frame*skeptic,data=disaster)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,mode=2)
condPlot(fit,mode=2,xpos=0.6)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,mode=2,xpos=0.6)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,mode=2)
df1$label2=paste0(" | ",pred,"=",df1[[pred]])
library(processR)
condPlot(fit,mode=2,xpos=0.6)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
plot(1:10,xlab=expression(hat(y) == 0.3*italic(W)+0.5(frame==0)))
plot(1:10,xlab=expression(paste(hat(y) == 0.3*italic(W)+0.5,",", italic(p), " = .010"))
plot(1:10,xlab=expression(paste(hat(y) == 0.3*italic(W)+0.5,",", italic(p), " = .010")))
plot(1:10,xlab=expression(paste(hat(y) == 0.3*italic(W)+0.5,",", italic(p), " = .010")))
plot(1:10,xlab=expression(paste(hat(y) == 0.3*italic(W)+0.5,", ", italic(p), " = .010")))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
library(processR)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
library(processR)
library(processR)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
fit=lm(justify~skeptic*frame,data=disaster)
fit=lm(justify~skeptic*frame,data=disaster)
condPlot(fit)
condPlot(fit,hjust=c(1,0))
condPlot(fit,mode=2)
condPlot(fit,mode=3)
condPlot(fit,mode=3,hjust=c(1,0))
condPlot(fit,mode=3,hjust=c(0,1))
condPlot(fit,hjust=c(1,0))
pformat
library(processR)
fit=lm(justify~skeptic*frame,data=disaster)
condPlot(fit,hjust=c(1,0))
condPlot(fit,mode=2)
condPlot(fit,mode=3,hjust=c(0,1))
library(processR)
fit=lm(justify~skeptic*frame,data=disaster)
condPlot(fit,hjust=c(1,0))
condPlot(fit,mode=2)
condPlot(fit,mode=3,hjust=c(0,1))
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
fit=lm(mpg~vs*hp,data=mtcars)
condPlot(fit,rangemode=2,xpos=0.6)
condPlot(fit,mode=2,xpos=0.5)
condPlot(fit,mode=3,rangemode=2)
condPlot(fit,mode=2,xpos=0.5)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
condPlot(fit,mode=2,pred.values=c(30,50,70),xpos=0.2)
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
condPlot(fit,mode=2,pred.values=c(30,50,70),xpos=0.2)
condPlot(fit,mode=2,xpos=0.2)
condPlot(fit,mode=3,xpos=0.5,hjust=c(-0.1,1.1))
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
condPlot(fit,mode=2,pred.values=c(30,50,70),xpos=0.2)
condPlot(fit,mode=2,xpos=0.2)
condPlot(fit,mode=3,xpos=0.5,hjust=c(-0.1,1.1))
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
condPlot(fit,mode=2,pred.values=c(30,50,70),xpos=0.2)
condPlot(fit,mode=2,xpos=0.2)
condPlot(fit,mode=3,xpos=0.5,hjust=c(-0.1,1.1))
condPlot(fit,modx.values=c(2,3,4),mode=3,xpos=0.6)
fit=lm(justify~frame*skeptic,data=disaster)
res=jnPlot(fit,plot=FALSE)
res$plot
fit=lm(justify~frame*skeptic,data=disaster)
res=jnPlot(fit,plot=FALSE)
res$plot
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
res=jnPlot(fit,plot=FALSE)
res$plot
library(processR)
devtools::document()
devtools::check()
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
library(processR)
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
condPlot(fit,mode=2,pred.values=c(30,50,70),xpos=0.2)
condPlot(fit,mode=2,xpos=0.2)
condPlot(fit,mode=3,xpos=0.5,hjust=c(-0.1,1.1))
condPlot(fit,modx.values=c(2,3,4),mode=3,xpos=0.6)
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
library(processR)
devtools::document()
library(processR)
devtools::document()
devtools::check()
devtools::document()
library(processR)
devtools::document()
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit)
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
# fit=lm(justify~skeptic*frame,data=disaster)
fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(justify~skeptic*frame,data=disaster)
# fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=1;rangemode=2;digits=3
ypos=NULL;linecolor="gray60";linetype=2;linesize=1;arrowsize=1;digits=3
data=fit$model
data
dep=colnames(data)[1]
if(is.null(pred)) {
pred=ifelse(xmode==1,colnames(data)[2],colnames(data)[3])
}
# fit=lm(justify~skeptic*frame,data=disaster)
# fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
#      pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=1;rangemode=2;digits=3;xmode=1
data=fit$model
data
dep=colnames(data)[1]
if(is.null(pred)) {
pred=ifelse(xmode==1,colnames(data)[2],colnames(data)[3])
}
if(is.null(modx)) modx=setdiff(colnames(data)[2:3],pred)
if(length(colnames(data)[3])>3) {
mod2=colnames(data)[4]
} else {
mod2=NULL
}
pred
modx
if(is.null(modx.values)){
if(length(unique(data[[modx]]))<6) {
modx.values=unique(data[[modx]])
} else if(rangemode==1){
modx.values=mean(data[[modx]],na.rm=T)+c(-1,0,1)*sd(data[[modx]],na.rm=T)
} else{
modx.values=quantile(data[[modx]],probs=c(0.16,0.5,0.84),type=6)
}
}
if(is.null(pred.values)){
if(length(unique(data[[pred]]))<6) {
pred.values=unique(data[[pred]])
} else if(rangemode==1) {
pred.values=mean(data[[pred]],na.rm=TRUE)+c(-1,0,1)*sd(data[[pred]],na.rm=TRUE)
} else if(rangemode==2) {
pred.values=quantile(data[[pred]],probs=c(0.16,0.5,0.84),type=6)
}
}
coef<-pvalue<-c()
for(i in seq_along(modx.values)){
equation=deparse(fit$call)
temp=stringr::str_replace(equation,modx,paste0("I(",modx,"-",modx.values[i],")"))
fit1=eval(parse(text=temp))
coef=c(coef,fit1$coef[pred])
pvalue=c(pvalue,summary(fit1)$coef[pred,4])
}
effectDf=data.frame(modx.values,coef,pvalue)
colnames(effectDf)[1]="x"
effectDf
pred.values=pred.values[c(1,length(pred.values))]
p=ggplot(data,aes_string(x=modx,y=dep))
require(ggplot2)
require(tidyverse)
p=ggplot(data,aes_string(x=modx,y=dep))
df1=calEquation(fit,pred=modx,modx.values = pred.values)
require(predict3d)
df1=calEquation(fit,pred=modx,modx.values = pred.values)
df1
p=ggplot(data,aes_string(x=modx,y=dep))
df1=calEquation(fit,pred=modx,modx.values = pred.values)
df1
