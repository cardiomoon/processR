#'makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars,maxylev=6)
#'makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars)
#'cat(makeCatEquation(X="wt",Y="carb",W=c("am","hp"),data=mtcars,maxylev=6))
makeCatEquation=function(X="X",Y="Y",W=NULL,data,prefix="b",maxylev=2,grouplabels=list()){
# X="wt";Y="carb";W=c("am","hp");data=mtcars;maxylev=6;prefix="b";group="d";ygroup="z"
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
if(is.null(grouplabels)) {
group="d"
groupstart=4
}
xcount=length(unique(data[[X]]))
if(is.factor(data[[X]])|((xcount>2)&(xcount<=maxylev))) {
group=ifelse(!is.null(grouplabels[[X]]),grouplabels[[X]],group)
xgroup=paste0(group,1:(xcount-1))
groupstart=5
} else{
xgroup=X
}
for(i in seq_along(W)){
wcount=length(unique(data[[W[i]]]))
if(is.factor(data[[W[i]]])|((wcount>2)&(wcount<=maxylev))) {
group=ifelse(!is.null(grouplabels[[W[i]]]),grouplabels[[W[i]]],letters[groupstart])
wgroup=c(wgroup,paste0(letters[groupstart],1:(wcount-1)))
groupstart=groupstart+1
} else{
wgroup=c(wgroup,W[i])
}
}
res=xgroup
if(length(wgroup)>0){
res=c(res,wgroup)
for(i in seq_along(xgroup)){
for(j in seq_along(wgroup)){
res=c(res,paste0(xgroup[i],":",wgroup[j]))
}
}
}
ycount=length(unique(data[[Y]]))
res
ycount
if(is.factor(data[[Y]])|((ycount>2)&(ycount<=maxylev))){
no=1
temp=c()
for(i in 1:ycount){
ygroup=ifelse(!is.null(grouplabels[[Y]]),grouplabels[[Y]],letters[groupstart])
temp1=paste0(prefix,no:(no+length(res)-1),"*",res)
temp=c(temp,paste0(ygroup,i,"~",paste0(temp1,collapse="+")))
no=no+length(res)
}
eq=paste0(temp,collapse="\n")
} else{
res=paste0(prefix,1:length(res),"*",res)
eq=paste0(Y,"~",paste0(res,collapse="+"))
}
eq
}
makeCatEquation(X="wt",Y="mpg",data=mtcars)
makeCatEquation(X="wt",Y="mpg",W="cyl",data=mtcars)
makeCatEquation(X="wt",Y="mpg",W=c("cyl","hp"),data=mtcars)
makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars,maxylev=6)
makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars)
cat(makeCatEquation(X="wt",Y="carb",W=c("am","hp"),data=mtcars,maxylev=6))
makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars,maxylev=6)
grouplabels=list(carb="d")
makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars,maxylev=6)
cat(makeCatEquation(X="wt",Y="carb",W=c("am","hp"),data=mtcars,maxylev=6))
cat(makeCatEquation(X="wt",Y="carb",W=c("am","hp"),data=mtcars,maxylev=6,grouplabels=grouplabels))
makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars,maxylev=6)
makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars,maxylev=6)
makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars)
cat(makeCatEquation(X="wt",Y="carb",W=c("am","hp"),data=mtcars,maxylev=6,grouplabels=grouplabels))
grouplabels=list(carb="f")
cat(makeCatEquation(X="wt",Y="carb",W=c("am","hp"),data=mtcars,maxylev=6,grouplabels=grouplabels))
catEquation(X="cyl",Y="am",W="wt",data=mtcars)
makeCatEquation(X="cyl",Y="am",W="wt",data=mtcars)
#'@param prefix
#'@param maxylev
#'@examples
#'makeCatEquation(X="wt",Y="mpg",data=mtcars)
#'makeCatEquation(X="wt",Y="mpg",W="cyl",data=mtcars)
#'makeCatEquation(X="wt",Y="mpg",W=c("cyl","hp"),data=mtcars)
#'grouplabels=list(carb="f")
#'makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars,maxylev=6)
#'makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars)
#'cat(makeCatEquation(X="wt",Y="carb",W=c("am","hp"),data=mtcars,maxylev=6,grouplabels=grouplabels))
makeCatEquation=function(X="X",Y="Y",W=NULL,data,prefix="b",maxylev=6,grouplabels=list()){
# X="wt";Y="carb";W=c("am","hp");data=mtcars;maxylev=6;prefix="b";group="d";ygroup="z"
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
if(is.null(grouplabels)) {
group="d"
groupstart=4
}
xcount=length(unique(data[[X]]))
if(is.factor(data[[X]])|((xcount>2)&(xcount<=maxylev))) {
group=ifelse(!is.null(grouplabels[[X]]),grouplabels[[X]],group)
xgroup=paste0(group,1:(xcount-1))
groupstart=5
} else{
xgroup=X
}
for(i in seq_along(W)){
wcount=length(unique(data[[W[i]]]))
if(is.factor(data[[W[i]]])|((wcount>2)&(wcount<=maxylev))) {
group=ifelse(!is.null(grouplabels[[W[i]]]),grouplabels[[W[i]]],letters[groupstart])
wgroup=c(wgroup,paste0(letters[groupstart],1:(wcount-1)))
groupstart=groupstart+1
} else{
wgroup=c(wgroup,W[i])
}
}
res=xgroup
if(length(wgroup)>0){
res=c(res,wgroup)
for(i in seq_along(xgroup)){
for(j in seq_along(wgroup)){
res=c(res,paste0(xgroup[i],":",wgroup[j]))
}
}
}
ycount=length(unique(data[[Y]]))
res
ycount
if(is.factor(data[[Y]])|((ycount>2)&(ycount<=maxylev))){
no=1
temp=c()
for(i in 1:ycount){
ygroup=ifelse(!is.null(grouplabels[[Y]]),grouplabels[[Y]],letters[groupstart])
temp1=paste0(prefix,no:(no+length(res)-1),"*",res)
temp=c(temp,paste0(ygroup,i,"~",paste0(temp1,collapse="+")))
no=no+length(res)
}
eq=paste0(temp,collapse="\n")
} else{
res=paste0(prefix,1:length(res),"*",res)
eq=paste0(Y,"~",paste0(res,collapse="+"))
}
eq
}
#'@param prefix
#'@param maxylev
#'@examples
#'makeCatEquation(X="wt",Y="mpg",data=mtcars)
#'makeCatEquation(X="wt",Y="mpg",W="cyl",data=mtcars)
#'makeCatEquation(X="wt",Y="mpg",W=c("cyl","hp"),data=mtcars)
#'grouplabels=list(carb="f")
#'makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars,maxylev=6)
#'makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars)
#'cat(makeCatEquation(X="wt",Y="carb",W=c("am","hp"),data=mtcars,maxylev=6,grouplabels=grouplabels))
makeCatEquation=function(X="X",Y="Y",W=NULL,data,prefix="b",maxylev=6,grouplabels=list()){
# X="wt";Y="carb";W=c("am","hp");data=mtcars;maxylev=6;prefix="b";group="d";ygroup="z"
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
if(is.null(grouplabels)) {
group="d"
groupstart=4
}
xcount=length(unique(data[[X]]))
if(is.factor(data[[X]])|((xcount>2)&(xcount<=maxylev))) {
group=ifelse(!is.null(grouplabels[[X]]),grouplabels[[X]],group)
xgroup=paste0(group,1:(xcount-1))
groupstart=5
} else{
xgroup=X
}
for(i in seq_along(W)){
wcount=length(unique(data[[W[i]]]))
if(is.factor(data[[W[i]]])|((wcount>2)&(wcount<=maxylev))) {
group=ifelse(!is.null(grouplabels[[W[i]]]),grouplabels[[W[i]]],letters[groupstart])
wgroup=c(wgroup,paste0(letters[groupstart],1:(wcount-1)))
groupstart=groupstart+1
} else{
wgroup=c(wgroup,W[i])
}
}
res=xgroup
if(length(wgroup)>0){
res=c(res,wgroup)
for(i in seq_along(xgroup)){
for(j in seq_along(wgroup)){
res=c(res,paste0(xgroup[i],":",wgroup[j]))
}
}
}
ycount=length(unique(data[[Y]]))
res
ycount
if(is.factor(data[[Y]])|((ycount>2)&(ycount<=maxylev))){
no=1
temp=c()
for(i in 1:ycount){
ygroup=ifelse(!is.null(grouplabels[[Y]]),grouplabels[[Y]],letters[groupstart])
temp1=paste0(prefix,no:(no+length(res)-1),"*",res)
temp=c(temp,paste0(ygroup,i,"~",paste0(temp1,collapse="+")))
no=no+length(res)
}
eq=paste0(temp,collapse="\n")
} else{
res=paste0(prefix,1:length(res),"*",res)
eq=paste0(Y,"~",paste0(res,collapse="+"))
}
eq
}
catEquation(X="cyl",Y="am",W="wt",data=mtcars)
makeCatEquation(X="cyl",Y="am",W="wt",data=mtcars)
#'@param prefix
#'@param maxylev
#'@examples
#'makeCatEquation(X="wt",Y="mpg",data=mtcars)
#'makeCatEquation(X="wt",Y="mpg",W="cyl",data=mtcars)
#'makeCatEquation(X="wt",Y="mpg",W=c("cyl","hp"),data=mtcars)
#'grouplabels=list(carb="f")
#'makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars,maxylev=6)
#'makeCatEquation(X="carb",Y="mpg",W=c("cyl","hp"),data=mtcars)
#'cat(makeCatEquation(X="wt",Y="carb",W=c("am","hp"),data=mtcars,maxylev=6,grouplabels=grouplabels))
makeCatEquation=function(X="X",Y="Y",W=NULL,data,prefix="b",maxylev=6,grouplabels=list()){
# X="wt";Y="carb";W=c("am","hp");data=mtcars;maxylev=6;prefix="b";group="d";ygroup="z"
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
if(is.null(grouplabels)) {
group="d"
groupstart=4
}
xcount=length(unique(data[[X]]))
if(is.factor(data[[X]])|((xcount>2)&(xcount<=maxylev))) {
group=ifelse(!is.null(grouplabels[[X]]),grouplabels[[X]],group)
xgroup=paste0(group,1:(xcount-1))
groupstart=5
} else{
xgroup=X
}
for(i in seq_along(W)){
wcount=length(unique(data[[W[i]]]))
if(is.factor(data[[W[i]]])|((wcount>2)&(wcount<=maxylev))) {
group=ifelse(!is.null(grouplabels[[W[i]]]),grouplabels[[W[i]]],letters[groupstart])
wgroup=c(wgroup,paste0(letters[groupstart],1:(wcount-1)))
groupstart=groupstart+1
} else{
wgroup=c(wgroup,W[i])
}
}
res=xgroup
if(length(wgroup)>0){
res=c(res,wgroup)
for(i in seq_along(xgroup)){
for(j in seq_along(wgroup)){
res=c(res,paste0(xgroup[i],":",wgroup[j]))
}
}
}
ycount=length(unique(data[[Y]]))
res
ycount
if(is.factor(data[[Y]])|((ycount>2)&(ycount<=maxylev))){
no=1
temp=c()
for(i in 1:ycount){
ygroup=ifelse(!is.null(grouplabels[[Y]]),grouplabels[[Y]],letters[groupstart])
temp1=paste0(prefix,no:(no+length(res)-1),"*",res)
temp=c(temp,paste0(ygroup,i,"~",paste0(temp1,collapse="+")))
no=no+length(res)
}
eq=paste0(temp,collapse="\n")
} else{
res=paste0(prefix,1:length(res),"*",res)
eq=paste0(Y,"~",paste0(res,collapse="+"))
}
eq
}
devtools::document()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::check()
devtools::document()
library(processR)
moderator=list(name=c("wt"),site=list(c("a","c")))
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars))
library(processR)
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars))
library(processR)
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars))
library(processR)
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars))
moderator=list(name=c("wt"),site=list(c("a","c")))
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="am",M="cyl",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6,rangemode=2))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6,rangemode=2))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6))
# X="X";M="M";Y="Y";cat="M";count=4;data=NULL;moderator=list();maxylev=6;
# covar=NULL;mode=0;range=TRUE;rangemode=1
# cat=NULL;count=NULL;moderator=list();maxylev=3
# moderator=list(name=c("wt"),site=list(c("a","c")))
X="carb";M="cyl";Y="mpg";data=mtcars;covar=NULL;mode=0;range=TRUE;rangemode=1;maxylev=6
moderator=list(name=c("wt"),site=list(c("a","c")))
res=c()
xcount=length(unique(data[[X]]))
mcount=length(unique(data[[M]]))
vars=c(X,M,Y,moderator$name)
groupvars=c()
grouplabels=list()
for(i in seq_along(vars)) {
count=length(unique(data[[vars[i]]]))
if(is.factor(data[[vars[i]]])) {
groupvars=c(groupvars,vars[i])
} else if((count>2)&(count<=maxylev)){
groupvars=c(groupvars,vars[i])
}
}
for(i in seq_along(groupvars)){
grouplabels[[groupvars]]=letters[3+i]
}
for(i in seq_along(groupvars)){
grouplabels[[groupvars[i]]]=letters[3+i]
}
grouplabels
library(processR)
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6))
library(processR)
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars))
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="am",M="cyl",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6))
moderator=list(name=c("wt"),site=list(c("a","c")))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="am",M="cyl",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6))
library(processR)
moderator=list(name=c("wt"),site=list(c("a","c")))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6))
# X="X";M="M";Y="Y";cat="M";count=4;data=NULL;moderator=list();maxylev=6;
# covar=NULL;mode=0;range=TRUE;rangemode=1
# cat=NULL;count=NULL;moderator=list();maxylev=3
# moderator=list(name=c("wt"),site=list(c("a","c")))
X="carb";M="cyl";Y="mpg";data=mtcars;covar=NULL;mode=0;range=TRUE;rangemode=1;maxylev=6
moderator=list(name=c("wt"),site=list(c("a","c")))
res=c()
xcount=length(unique(data[[X]]))
mcount=length(unique(data[[M]]))
vars=c(X,M,Y,moderator$name)
groupvars=c()
grouplabels=list()
for(i in seq_along(vars)) {
count=length(unique(data[[vars[i]]]))
if(is.factor(data[[vars[i]]])) {
groupvars=c(groupvars,vars[i])
} else if((count>2)&(count<=maxylev)){
groupvars=c(groupvars,vars[i])
}
}
for(i in seq_along(groupvars)){
grouplabels[[groupvars[i]]]=letters[3+i]
}
grouplabels
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
eq1=makeCatEquation(X=X,Y=M,W=XM,data=data,prefix="a",maxylev=maxylev,grouplabels=grouplabels)
library(processR)
moderator=list(name=c("wt"),site=list(c("a","c")))
# X="X";M="M";Y="Y";cat="M";count=4;data=NULL;moderator=list();maxylev=6;
# covar=NULL;mode=0;range=TRUE;rangemode=1
# cat=NULL;count=NULL;moderator=list();maxylev=3
# moderator=list(name=c("wt"),site=list(c("a","c")))
X="carb";M="cyl";Y="mpg";data=mtcars;covar=NULL;mode=0;range=TRUE;rangemode=1;maxylev=6
res=c()
xcount=length(unique(data[[X]]))
mcount=length(unique(data[[M]]))
vars=c(X,M,Y,moderator$name)
groupvars=c()
grouplabels=list()
for(i in seq_along(vars)) {
count=length(unique(data[[vars[i]]]))
if(is.factor(data[[vars[i]]])) {
groupvars=c(groupvars,vars[i])
} else if((count>2)&(count<=maxylev)){
groupvars=c(groupvars,vars[i])
}
}
for(i in seq_along(groupvars)){
grouplabels[[groupvars[i]]]=letters[3+i]
}
grouplabels
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
eq1=makeCatEquation(X=X,Y=M,W=XM,data=data,prefix="a",maxylev=maxylev,grouplabels=grouplabels)
devtools::document()
devtools::document()
library(processR)
moderator=list(name=c("wt"),site=list(c("a","c")))
# X="X";M="M";Y="Y";cat="M";count=4;data=NULL;moderator=list();maxylev=6;
# covar=NULL;mode=0;range=TRUE;rangemode=1
# cat=NULL;count=NULL;moderator=list();maxylev=3
# moderator=list(name=c("wt"),site=list(c("a","c")))
X="carb";M="cyl";Y="mpg";data=mtcars;covar=NULL;mode=0;range=TRUE;rangemode=1;maxylev=6
res=c()
xcount=length(unique(data[[X]]))
mcount=length(unique(data[[M]]))
vars=c(X,M,Y,moderator$name)
groupvars=c()
grouplabels=list()
for(i in seq_along(vars)) {
count=length(unique(data[[vars[i]]]))
if(is.factor(data[[vars[i]]])) {
groupvars=c(groupvars,vars[i])
} else if((count>2)&(count<=maxylev)){
groupvars=c(groupvars,vars[i])
}
}
for(i in seq_along(groupvars)){
grouplabels[[groupvars[i]]]=letters[3+i]
}
grouplabels
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
eq1=makeCatEquation(X=X,Y=M,W=XM,data=data,prefix="a",maxylev=maxylev,grouplabels=grouplabels)
# maxylev
eq1
if((!is.null(covar)) & !(M %in% groupvars)){
covar$site=lapply(covar$site,function(x) str_replace(x,"M",M))
if(mode){
eq1=addCovarEquation(eq1,covar,prefix=NULL)
} else{
eq1=addCovarEquation(eq1,covar)
}
}
eq1
temp1=unlist(strsplit(eq1,"\n"))
temp1=lapply(1:length(temp1),function(i){
unlist(strsplit(unlist(strsplit(temp1[i],"~",fixed=TRUE))[2],"+",fixed=TRUE))
})
temp1
eq2=makeCatEquation(X=M,Y=Y,W=MY,data=data,prefix="b",maxylev=maxylev,grouplabels=grouplabels)
eq2
temp2=unlist(strsplit(eq2,"~"))[2]
temp2=unlist(strsplit(temp2,"+",fixed=TRUE))
temp2
eq3=makeCatEquation(X=X,Y=Y,W=XY,data=data,prefix="c",maxylev=maxylev,grouplabels=grouplabels)
eq3
temp3=unlist(strsplit(eq3,"~"))[2]
temp3
temp3=unlist(strsplit(temp3,"+",fixed=TRUE))
(eq=sumEquation(eq2,eq3))
equation=paste(eq1,eq,sep="\n")
equation
if((!is.null(covar)) & !(Y %in% groupvars)){
covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
if(mode){
eq=addCovarEquation(eq,covar,prefix=NULL)
} else{
eq=addCovarEquation(eq,covar)
}
}
if(mode==0){
moderatorNames=moderator$name
for(i in seq_along(moderatorNames)){
name=moderatorNames[i]
temp=paste0(name," ~ ",name,".mean*1\n")
temp=paste0(temp,name," ~~ ",name,".var*",name,"\n")
equation=paste0(equation,"\n",temp)
}
if(length(moderatorNames)>0){
if(X %in% groupvars) {
count1=xcount
X1=paste0("d",1:(count1-1))
} else{
X1=X
}
if(M %in% groupvars) {
count1=mcount
M1=paste0("e",1:(count1-1))
} else{
M1=M
}
temp=makeIndirectEquationCat(X1,M1,temp1,temp2,temp3,moderatorNames,range=range,data=data,rangemode=rangemode)
temp
equation=paste0(equation,temp)
}
}
equation
library(processR)
moderator=list(name=c("wt"),site=list(c("a","c")))
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars))
cat(catMediation(X="cyl",M="am",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="am",M="cyl",Y="mpg",data=mtcars,moderator=moderator))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6))
cat(catMediation(X="carb",M="cyl",Y="mpg",data=mtcars,moderator=moderator))
library(processR)
moderator=list(name=c("carb"),site=list(c("a","c")))
cat(catMediation(X="am",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6))
library(processR)
moderator=list(name=c("carb"),site=list(c("a","c")))
covar=list(name=c("C1","C2","C3"),label=c("ese","sex","tenure"),site=list(c("M","Y"),"Y","Y"))
cat(catMediation(X="am",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6))
library(processR)
moderator=list(name=c("carb"),site=list(c("a","c")))
cat(catMediation(X="am",M="cyl",Y="mpg",data=mtcars,moderator=moderator,maxylev=6))
devtoools::document()
devtools::document()
devtools::document()
devtoools::check()
devtools::check()
