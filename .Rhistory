vars=list(); moderator=list();semfit=NULL;equation=NULL;covar=NULL
labels=list(X="baby",M="wine",Y="tile")
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
if(is.null(radx)) radx=ifelse(nodemode %in% c(1,4),0.08,0.12)
if(!is.null(covar)){
for(i in seq_along(covar$name)){
if(is.null(covar$label)){
labels[[paste0("C",i)]]=covar$name[i]
} else{
labels[[covar$label[i]]]=covar$name[i]
}
}
}
if(length(vars)>0){
if(is.null(vars$label)){
if(length(vars$name)==1){
labels[["W"]]=vars$name[[1]][1]
labels[["Z"]]=vars$name[[1]][2]
} else{
for(i in seq_along(vars$name)){
labels[[paste0("W",i)]]=vars$name[[i]][1]
labels[[paste0("Z",i)]]=vars$name[[i]][2]
}
}
} else{
if(length(vars$name)==1){
labels[[vars$label[[1]][1]]]=vars$name[[1]][1]
labels[[vars$label[[1]][2]]]=vars$name[[1]][2]
} else{
for(i in seq_along(vars$name)){
labels[[vars$label[[i]][1]]]=vars$name[[i]][1]
labels[[vars$label[[i]][2]]]=vars$name[[i]][2]
}
}
}
}
if(length(moderator)>0){
if(is.null(moderator$label)){
prefix=ifelse(length(vars)==0,"W","V")
if(length(moderator$name)==1){
labels[[prefix]]=moderator$name
} else{
for(i in 1:length(moderator$name)){
labels[[paste0(prefix,i)]]=moderator$name[i]
}
}
} else{
for(i in 1:length(moderator$label)){
labels[[moderator$label[i]]]=moderator$name[i]
}
}
}
if(is.null(semfit)){
if(is.null(data)){
df1=labels2table(labels=labels,vars=vars,moderator=moderator,
covar=covar,serial=serial,bmatrix=bmatrix,
eq=equation)
df1$end=df1$Variables
df1$start=df1$Predictors
#print(df1)
} else{
eq=tripleEquation(labels=labels,vars=vars,moderator=moderator,covar=covar,data=data,mode=1)
semfit=eq2fit(eq,data=data)
}
}
# ymargin=0.02;xlim=NULL;ylim=NULL
# rady=0.04;maxypos=0.6;minypos=0;ypos=c(1,0.5);mpos=c(0.5,0.9)
# xinterval=NULL;yinterval=NULL;xspace=NULL;arrow.pos=list()
# digits=3;serial=FALSE
# interactionFirst=TRUE;totalOnly=TRUE;semfit=NULL;moderator=list();kmediator=TRUE
# parallel=FALSE;kmediator=FALSE
# labels=list(X="X",M="M",Y="Y")
# vars=list(name=list(c("W","Z")),site=list("a"),arr.pos=list(c(0.5)))
# labels=list(X="cond",M="pmi",Y="reaction");data=pmi
# vars=list(); moderator=list();semfit=NULL;equation=NULL;covar=NULL
data=NULL
if(is.null(radx)) radx=ifelse(nodemode %in% c(1,4),0.08,0.12)
if(!is.null(covar)){
for(i in seq_along(covar$name)){
if(is.null(covar$label)){
labels[[paste0("C",i)]]=covar$name[i]
} else{
labels[[covar$label[i]]]=covar$name[i]
}
}
}
if(length(vars)>0){
if(is.null(vars$label)){
if(length(vars$name)==1){
labels[["W"]]=vars$name[[1]][1]
labels[["Z"]]=vars$name[[1]][2]
} else{
for(i in seq_along(vars$name)){
labels[[paste0("W",i)]]=vars$name[[i]][1]
labels[[paste0("Z",i)]]=vars$name[[i]][2]
}
}
} else{
if(length(vars$name)==1){
labels[[vars$label[[1]][1]]]=vars$name[[1]][1]
labels[[vars$label[[1]][2]]]=vars$name[[1]][2]
} else{
for(i in seq_along(vars$name)){
labels[[vars$label[[i]][1]]]=vars$name[[i]][1]
labels[[vars$label[[i]][2]]]=vars$name[[i]][2]
}
}
}
}
if(length(moderator)>0){
if(is.null(moderator$label)){
prefix=ifelse(length(vars)==0,"W","V")
if(length(moderator$name)==1){
labels[[prefix]]=moderator$name
} else{
for(i in 1:length(moderator$name)){
labels[[paste0(prefix,i)]]=moderator$name[i]
}
}
} else{
for(i in 1:length(moderator$label)){
labels[[moderator$label[i]]]=moderator$name[i]
}
}
}
if(is.null(semfit)){
if(is.null(data)){
df1=labels2table(labels=labels,vars=vars,moderator=moderator,
covar=covar,serial=serial,bmatrix=bmatrix,
eq=equation)
df1$end=df1$Variables
df1$start=df1$Predictors
#print(df1)
} else{
eq=tripleEquation(labels=labels,vars=vars,moderator=moderator,covar=covar,data=data,mode=1)
semfit=eq2fit(eq,data=data)
}
}
if(!is.null(semfit)){
if(class(semfit)=="lavaan"){
res=parameterEstimates(semfit)
res=res[res$op=="~",]
res
res=res[c(1,3,4,5,8)]
} else if(class(semfit)=="list"){
res=fit2table(semfit,labels=labels,digits=digits)
res=res[c(6,5,7,1,4)]
}
}
if(!is.null(semfit)){
colnames(res)=c("end","start","name","est","p")
res
res$start=changeLabelName(res$start,labels,add=FALSE)
res$end=changeLabelName(res$end,labels,add=FALSE)
df1=res
}
df1
if(is.null(radx)) radx=ifelse(nodemode %in% c(1,4),0.08,0.12)
if(!is.null(covar)){
for(i in seq_along(covar$name)){
if(is.null(covar$label)){
labels[[paste0("C",i)]]=covar$name[i]
} else{
labels[[covar$label[i]]]=covar$name[i]
}
}
}
if(length(vars)>0){
if(is.null(vars$label)){
if(length(vars$name)==1){
labels[["W"]]=vars$name[[1]][1]
labels[["Z"]]=vars$name[[1]][2]
} else{
for(i in seq_along(vars$name)){
labels[[paste0("W",i)]]=vars$name[[i]][1]
labels[[paste0("Z",i)]]=vars$name[[i]][2]
}
}
} else{
if(length(vars$name)==1){
labels[[vars$label[[1]][1]]]=vars$name[[1]][1]
labels[[vars$label[[1]][2]]]=vars$name[[1]][2]
} else{
for(i in seq_along(vars$name)){
labels[[vars$label[[i]][1]]]=vars$name[[i]][1]
labels[[vars$label[[i]][2]]]=vars$name[[i]][2]
}
}
}
}
if(length(moderator)>0){
if(is.null(moderator$label)){
prefix=ifelse(length(vars)==0,"W","V")
if(length(moderator$name)==1){
labels[[prefix]]=moderator$name
} else{
for(i in 1:length(moderator$name)){
labels[[paste0(prefix,i)]]=moderator$name[i]
}
}
} else{
for(i in 1:length(moderator$label)){
labels[[moderator$label[i]]]=moderator$name[i]
}
}
}
if(is.null(semfit)){
if(is.null(data)){
df1=labels2table(labels=labels,vars=vars,moderator=moderator,
covar=covar,serial=serial,bmatrix=bmatrix,
eq=equation)
df1$end=df1$Variables
df1$start=df1$Predictors
#print(df1)
} else{
eq=tripleEquation(labels=labels,vars=vars,moderator=moderator,covar=covar,data=data,mode=1)
semfit=eq2fit(eq,data=data)
}
}
# ymargin=0.02;xlim=NULL;ylim=NULL
# rady=0.04;maxypos=0.6;minypos=0;ypos=c(1,0.5);mpos=c(0.5,0.9)
# xinterval=NULL;yinterval=NULL;xspace=NULL;arrow.pos=list()
# digits=3;serial=FALSE
# interactionFirst=TRUE;totalOnly=TRUE;semfit=NULL;moderator=list();kmediator=TRUE
# parallel=FALSE;kmediator=FALSE
# labels=list(X="X",M="M",Y="Y")
# vars=list(name=list(c("W","Z")),site=list("a"),arr.pos=list(c(0.5)))
# labels=list(X="cond",M="pmi",Y="reaction");data=pmi
# vars=list(); moderator=list();semfit=NULL;equation=NULL;covar=NULL
data=NULL;  bmatrix=NULL; serial=FALSE
labels=list(X="baby",M="wine",Y="tile")
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
if(is.null(radx)) radx=ifelse(nodemode %in% c(1,4),0.08,0.12)
if(!is.null(covar)){
for(i in seq_along(covar$name)){
if(is.null(covar$label)){
labels[[paste0("C",i)]]=covar$name[i]
} else{
labels[[covar$label[i]]]=covar$name[i]
}
}
}
if(length(vars)>0){
if(is.null(vars$label)){
if(length(vars$name)==1){
labels[["W"]]=vars$name[[1]][1]
labels[["Z"]]=vars$name[[1]][2]
} else{
for(i in seq_along(vars$name)){
labels[[paste0("W",i)]]=vars$name[[i]][1]
labels[[paste0("Z",i)]]=vars$name[[i]][2]
}
}
} else{
if(length(vars$name)==1){
labels[[vars$label[[1]][1]]]=vars$name[[1]][1]
labels[[vars$label[[1]][2]]]=vars$name[[1]][2]
} else{
for(i in seq_along(vars$name)){
labels[[vars$label[[i]][1]]]=vars$name[[i]][1]
labels[[vars$label[[i]][2]]]=vars$name[[i]][2]
}
}
}
}
if(length(moderator)>0){
if(is.null(moderator$label)){
prefix=ifelse(length(vars)==0,"W","V")
if(length(moderator$name)==1){
labels[[prefix]]=moderator$name
} else{
for(i in 1:length(moderator$name)){
labels[[paste0(prefix,i)]]=moderator$name[i]
}
}
} else{
for(i in 1:length(moderator$label)){
labels[[moderator$label[i]]]=moderator$name[i]
}
}
}
if(is.null(semfit)){
if(is.null(data)){
df1=labels2table(labels=labels,vars=vars,moderator=moderator,
covar=covar,serial=serial,bmatrix=bmatrix,
eq=equation)
df1$end=df1$Variables
df1$start=df1$Predictors
#print(df1)
} else{
eq=tripleEquation(labels=labels,vars=vars,moderator=moderator,covar=covar,data=data,mode=1)
semfit=eq2fit(eq,data=data)
}
}
df1=labels2table(labels=labels,vars=vars,moderator=moderator,
covar=covar,serial=serial,bmatrix=bmatrix,
eq=equation)
# vars=list();eq=NULL;covar=NULL;serial=TRUE;bmatrix=NULL
# labels=list(X="X",M="M",Y="Y")
# moderator=list(name="X",site=list(c("b")))
# labels=list(X="baby",M=c("wine","tent","sand"),Y="tile")
# bmatrix=c(1,1,0,1,0,0,1,1,1,1)
# moderator=list(name=c("milk","hair"),labels=c("W","Z"),
#                matrix=list(c(1,0,0,0,0,0,0,0,0,0),c(0,0,0,0,0,0,0,1,0,0)))
labels=list(X="baby",M="wine",Y="tile")
vars=list()
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
serial=FALSE
bmatrix=NULL
eq=NULL
eq=multipleMediation(labels=labels,vars=vars,moderator=moderator,covar=covar,mode=1,
serial=serial,bmatrix=bmatrix)
eq
eq=checkEquationVars(eq)
labels
if(!is.null(covar)){
for(i in seq_along(covar$name)){
labels=addLabels(labels,paste0("C",i),covar$name[i])
}
}
if(length(vars)>0){
if(is.null(vars$label)){
if(length(vars$name)==1){
labels=addLabels(labels,"W",vars$name[[1]][1])
labels=addLabels(labels,"Z",vars$name[[1]][2])
} else{
for(i in seq_along(vars$name)){
labels=addLabels(labels,paste0("W",i),vars$name[[i]][1])
labels=addLabels(labels,paste0("Z",i),vars$name[[i]][2])
}
}
} else{
if(length(vars$name)==1){
labels=addLabels(labels,vars$label[[1]][1],vars$name[[1]][1])
labels=addLabels(labels,vars$label[[1]][2],vars$name[[1]][2])
} else{
for(i in seq_along(vars$name)){
labels=addLabels(labels,vars$label[[i]][1],vars$name[[i]][1])
labels=addLabels(labels,vars$label[[i]][2],vars$name[[i]][2])
}
}
}
}
if(length(moderator)>0){
# prefix=ifelse(length(vars)==0,"W","V")
# if(length(moderator$name)==1){
#   labels=addLabels(labels,prefix,moderator$name)
# } else{
# for(i in seq_along(moderator$name)){
#   labels=addLabels(labels,paste0(prefix,i),moderator$name[i])
# }
# }
if(is.null(moderator$label)){
prefix=ifelse(length(vars)==0,"W","V")
if(length(moderator$name)==1){
labels=addLabels(labels,prefix,moderator$name)
} else{
for(i in 1:length(moderator$name)){
labels=addLabels(labels,paste0(prefix,i),moderator$name[i])
}
}
} else{
for(i in 1:length(moderator$label)){
labels=addLabels(labels,moderator$label[i],moderator$name[i])
}
}
}
eq
labels
if(length(moderator)>0){
# prefix=ifelse(length(vars)==0,"W","V")
# if(length(moderator$name)==1){
#   labels=addLabels(labels,prefix,moderator$name)
# } else{
# for(i in seq_along(moderator$name)){
#   labels=addLabels(labels,paste0(prefix,i),moderator$name[i])
# }
# }
if(is.null(moderator$label)){
prefix=ifelse(length(vars)==0,"W","V")
if(length(moderator$name)==1){
labels=addLabels(labels,prefix,moderator$name)
} else{
for(i in 1:length(moderator$name)){
labels=addLabels(labels,paste0(prefix,i),moderator$name[i])
}
}
} else{
for(i in 1:length(moderator$label)){
labels=addLabels(labels,moderator$label[i],moderator$name[i])
}
}
}
eq
labels
# vars=list();eq=NULL;covar=NULL;serial=TRUE;bmatrix=NULL
# labels=list(X="X",M="M",Y="Y")
# moderator=list(name="X",site=list(c("b")))
# labels=list(X="baby",M=c("wine","tent","sand"),Y="tile")
# bmatrix=c(1,1,0,1,0,0,1,1,1,1)
# moderator=list(name=c("milk","hair"),labels=c("W","Z"),
#                matrix=list(c(1,0,0,0,0,0,0,0,0,0),c(0,0,0,0,0,0,0,1,0,0)))
labels=list(X="baby",M="wine",Y="tile")
vars=list()
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
serial=FALSE
bmatrix=NULL
eq=NULL
if(is.null(eq)) {
eq=multipleMediation(labels=labels,vars=vars,moderator=moderator,covar=covar,mode=1,
serial=serial,bmatrix=bmatrix)
}
eq
eq=checkEquationVars(eq)
labels
if(length(vars)>0){
if(is.null(vars$label)){
if(length(vars$name)==1){
labels=addLabels(labels,"W",vars$name[[1]][1])
labels=addLabels(labels,"Z",vars$name[[1]][2])
} else{
for(i in seq_along(vars$name)){
labels=addLabels(labels,paste0("W",i),vars$name[[i]][1])
labels=addLabels(labels,paste0("Z",i),vars$name[[i]][2])
}
}
} else{
if(length(vars$name)==1){
labels=addLabels(labels,vars$label[[1]][1],vars$name[[1]][1])
labels=addLabels(labels,vars$label[[1]][2],vars$name[[1]][2])
} else{
for(i in seq_along(vars$name)){
labels=addLabels(labels,vars$label[[i]][1],vars$name[[i]][1])
labels=addLabels(labels,vars$label[[i]][2],vars$name[[i]][2])
}
}
}
}
if(length(moderator)>0){
# prefix=ifelse(length(vars)==0,"W","V")
# if(length(moderator$name)==1){
#   labels=addLabels(labels,prefix,moderator$name)
# } else{
# for(i in seq_along(moderator$name)){
#   labels=addLabels(labels,paste0(prefix,i),moderator$name[i])
# }
# }
if(is.null(moderator$label)){
prefix=ifelse(length(vars)==0,"W","V")
if(length(moderator$name)==1){
labels=addLabels(labels,prefix,moderator$name)
} else{
for(i in 1:length(moderator$name)){
labels=addLabels(labels,paste0(prefix,i),moderator$name[i])
}
}
} else{
for(i in 1:length(moderator$label)){
labels=addLabels(labels,moderator$label[i],moderator$name[i])
}
}
}
if(!is.null(covar)){
for(i in seq_along(covar$name)){
labels=addLabels(labels,paste0("C",i),covar$name[i])
}
}
eq
labels
df=equations2var(eq,labels=labels)
df
library(processR)
labels=list(X="baby",M="wine",Y="tile")
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
drawModel(labels=labels,moderator=moderator,covar=covar)
labels=list(X="baby",M="wine",Y="tile")
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
labels2table(labels,moderator=moderator,covar=covar,serial=FALSE)
library(processR)
labels=list(X="baby",M="wine",Y="tile")
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
labels2table(labels,moderator=moderator,covar=covar,serial=FALSE)
labels=list(X="baby",M="wine",Y="tile")
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
drawModel(labels=labels,moderator=moderator,covar=covar)
library(processR)
labels=list(X="baby",M="wine",Y="tile")
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
drawModel(labels=labels,moderator=moderator,covar=covar)
devtools::document()
library(processR)
devtools::document()
labels=list(X="baby",M="wine",Y="tile")
moderator=list(name=c("milk"),site=list("a"))
covar=list(name=c("milk","tent","sand"),site=list(c("Y"),c("M","Y"),c("M","Y")))
drawModel(labels=labels,moderator=moderator,covar=covar)
devtools::document()
devtools::check()
library(processR)
devtools::document()
library(processR)
devtools::check()
library(processR)
