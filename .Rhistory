cat(multipleMediation(labels=labels,moderator=moderator,data=mtcars,range=FALSE))
labels=list(X="wt",M=c("cyl","am"),Y="mpg")
moderator=list(name=c("vs"),site=list(c("a1","a2")))
cat(multipleMediation(labels=labels,moderator=moderator,data=mtcars,range=FALSE))
library(processR)
labels=list(X="wt",M=c("cyl","am"),Y="mpg")
moderator=list(name=c("vs"),site=list(c("a1","a2")))
cat(multipleMediation(labels=labels,moderator=moderator,data=mtcars,range=FALSE))
labels=list(X="wt",M=c("cyl","am"),Y="mpg")
moderator=list(name=c("vs"),site=list(c("b1","b2")))
cat(multipleMediation(labels=labels,moderator=moderator,data=mtcars,range=FALSE))
labels=list(X="wt",M=c("cyl","am"),Y="mpg")
moderator=list(name=c("vs"),site=list(c("a1","a2")))
cat(multipleMediation(labels=labels,moderator=moderator,data=mtcars,range=FALSE))
labels=list(X="wt",M=c("cyl","am"),Y="mpg")
moderator=list(name=c("vs"),site=list(c("a1","a2")))
data=mtcars;X=NULL;M=NULL;Y=NULL
covar=NULL;mode=0;range=TRUE;rangemode=1
if(is.null(X)) X=labels$X
if(is.null(M)) if(!is.null(labels$M)) M=labels$M
if(is.null(Y)) Y=labels$Y
res=c()
xcount=length(X)
if(!is.null(M)) {
mcount=length(M)
} else{
mcount=0
}
ycount=length(Y)
vars=c(X,M,Y,moderator$name,covar$name)
#         groupvars=c(groupvars,vars[i])
#     } else if((count>2)&(count<=maxylev)){
#         groupvars=c(groupvars,vars[i])
#     }
# }
# for(i in seq_along(groupvars)){
#     grouplabels[[groupvars[i]]]=LETTERS[3+i]
#     attr(grouplabels[[groupvars[i]]],"length")=length(unique(data[[groupvars[i]]]))-1
# }
# str(grouplabels)
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
# moderator=list(name=c("vs"),site=list(c("b1","b2")))
# name="vs"
# prefix="b"
# moderator
# name=MY
# name
# prefix="b"
mod2pos=function(moderator,name,prefix){
pos=list()
pos1=c()
# i=1
for(i in seq_along(name)) {
pos1=grep(name[i],moderator$name)
pos1
if(length(pos1)==1){
temp=moderator$site[[pos1]]
temp1=temp[str_detect(temp,prefix)]
temp1
res=str_extract(temp1,"[0-9]")
res
if(length(res)==1){
if(is.na(res)){
pos=NULL
} else {
pos=as.numeric(res)
}
} else{
pos=unlist(as.numeric(res))
}
}
}
pos
}
pos=mod2pos(moderator,name=XM,prefix="a")
pos
eq1=makeCatEquation2(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos)
# maxylev
eq1
mode
makeCatEquation2(X="wt",Y=c("hp","vs"),W="cyl",prefix="a")
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl","am"),prefix="a",pos=list(1,2))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl","am"),prefix="a",pos=c(1,2))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(1,2))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(1,2))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=c(1,2))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=c(1,2))
library(processR)
labels=list(X="wt",M=c("cyl","am"),Y="mpg")
moderator=list(name=c("vs"),site=list(c("a1","a2")))
cat(multipleMediation(labels=labels,data=mtcars,range=FALSE))
cat(multipleMediation(labels=labels,moderator=moderator,data=mtcars,range=FALSE))
labels=list(X="wt",M=c("cyl","am"),Y="mpg")
moderator=list(name=c("vs"),site=list(c("b1","b2")))
cat(multipleMediation(labels=labels,moderator=moderator,data=mtcars,range=FALSE))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(c(1,2)))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(c(1,2)))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(1))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(c(1,2)))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(c(1,2)))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
# X="wt";Y=c("hp","vs");W=c("am");data=mtcars;prefix="a";mode=0;pos=NULL
X=c("hp","vs");Y="mpg";W=c("cyl");prefix="b";mode=0;pos=list(c(1,2))
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
# X="wt";Y=c("hp","vs");W=c("am");data=mtcars;prefix="a";mode=0;pos=NULL
X=c("hp","vs");Y="mpg";W=c("cyl");prefix="b";mode=0;pos=list(c(1,2))
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
j=1
i=1
res1=c()
res=c()
no=max(i,j)
res=c(res,X[i])
j=1
i=1
res1=c()
res=c()
res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
res
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
# X="wt";Y=c("hp","vs");W=c("am");data=mtcars;prefix="a";mode=0;pos=NULL
X=c("hp","vs");Y="mpg";W=c("cyl");prefix="b";mode=0;pos=list(c(1,2))
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
for(j in 1:ycount){
res1=c()
for(i in 1:xcount){
res=c()
res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
eq=paste0(temp,collapse="\n")
eq
X="wt";Y=c("hp","vs");W=c("am");data=mtcars;prefix="a";mode=0;pos=list(c(1,2))
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
for(j in 1:ycount){
res1=c()
for(i in 1:xcount){
res=c()
res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
X="wt";Y="mpg";W="cyl";labels=list();prefix="b";mode=0;pos=list()
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
for(j in 1:ycount){
res1=c()
for(i in 1:xcount){
res=c()
res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
X="wt";Y="mpg";W="cyl";labels=list();prefix="b";mode=0;pos=list()
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
for(j in 1:ycount){
res1=c()
for(i in 1:xcount){
res=c()
res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
pos
pos[[1]]
pos
length(pos)
X="wt";Y="mpg";W="cyl";labels=list();prefix="b";mode=0;pos=list()
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
length(pos)
for(j in 1:ycount){
res1=c()
for(i in 1:xcount){
res=c()
res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos)==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
X="wt";Y=c("hp","vs");W=c("am");data=mtcars;prefix="a";mode=0;pos=list()
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
length(pos)
for(j in 1:ycount){
res1=c()
for(i in 1:xcount){
res=c()
res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos)==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
eq=paste0(temp,collapse="\n")
eq
X="wt";Y="mpg";W="cyl";labels=list();prefix="b";mode=0;pos=list()
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
X=c("hp","vs");Y="mpg";W=c("cyl");prefix="b";mode=0;pos=list(c(1,2))
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
for(j in 1:ycount){
res1=c()
for(i in 1:xcount){
res=c()
res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos)==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
eq=paste0(temp,collapse="\n")
eq
X=c("hp","vs");Y="mpg";W=c("cyl","wt");prefix="b";mode=0;pos=list(c(1,2),c(1))
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
xcount=length(X)
wcount=length(W)
ycount=length(Y)
temp=c()
for(j in 1:ycount){
res1=c()
for(i in 1:xcount){
res=c()
res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos)==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
eq=paste0(temp,collapse="\n")
eq
library(processR)
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(c(1,2)))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b")
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=c(1,2))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
library(processR)
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(1))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(c(1,2)))
library(processR)
