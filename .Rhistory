}
} else if(str_detect(temp[i],":X[1-9]?")){
result=c(result,paste0("c",j))
j=j+1
} else{
result=c(result,paste0("b",l))
l=l+1
}
} else if(dep=="M"){
if(temp[i]=="(Intercept)"){
result=c(result,"iM")
} else if(str_detect(temp[i],"^C[1-9]?")){
if(nchar(temp[i])==1){
result=c(result,"f")
} else{
result=c(result,paste0("f",substr(temp[i],2,2)))
}
} else{
result=c(result,paste0("a",j))
j=j+1
}
} else{    ##  "M1","M2",...
if(temp[i]=="(Intercept)"){
result=c(result,paste0("i",dep))
} else if(str_detect(temp[i],"^C[1-9]?")){
result=c(result,paste0("f",k))
k=k+1
} else if(str_detect(temp[i],"^M[1:9]?")){
if(nchar(temp[i])==2){  # M1
result=c(result,paste0("d",substr(dep,2,2),substr(temp[i],2,2)))
} else{  ## M1:W
result=c(result,paste0("d",substr(dep,2,2),substr(temp[i],2,2),l))
l<-l+1
}
} else if(str_detect(temp[i],"^(W|V|Z)[1-9]?")){
if(paste0("X:",temp[i]) %in% temp){
result=c(result,paste0("a",j,substr(dep,2,2)))
j=j+1
} else{
tempvar=temp[str_detect(temp,"^M[1-9]:")][1]
result=c(result,paste0("d",substr(dep,2,2),substr(tempvar,2,2),l))
# result=c(result,paste0(prefix,l))
l<-l+1
# result=c(result,paste0("b",l))
# l=l+1
}
} else{
if(length(temp[i])==1){
result=c(result,paste0("a",substr(dep,2,2)))
} else{
result=c(result,paste0("a",j,substr(dep,2,2)))
j=j+1
}
}
}
# if(temp[i]=="(Intercept)") {
#    if(dep=="M1") {
#      result=c(result,"iM1")
#    } else if(dep=="M2"){
#      result=c(result,"iM2")
#    } else {
#      result=c(result,constant)
#    }
# } else if(temp[i]=="M") {
#   result=c(result,paste0("b",l))
#   l=l+1
# } else if(substr(temp[i],1,1)=="C"){
#   if(dep=="Y") {
#     result=c(result,paste0("g",k))
#   } else{
#     result=c(result,paste0("f",k))
#
#   }
#   k<-k+1
# } else if(temp[i]=="X"){
#   if(dep=="Y") {
#      result=c(result,paste0(ifelse(any(str_detect(temp,"^M")),"c'","c"),j))
#
#   } else if(str_detect(dep,"^M")){
#      result=c(result,paste0("a",j))
#   }  else{
#     result=c(result,paste0(prefix,j))
#
#   }
#   j<-j+1
# } else if(temp[i]=="W"){
#   if(("X:W" %in% temp)|("W:X" %in% temp)|("D1:W" %in% temp)|("W:D1" %in% temp)){
#     if(dep=="Y") {
#       result=c(result,paste0(ifelse(any(str_detect(temp,"^M")),"c'","c"),j))
#
#     } else{
#       result=c(result,paste0(prefix,j))
#
#     }
#     j<-j+1
#   } else if(dep %in% c(paste0("M",2:9))) {
#     tempvar=temp[str_detect(temp,"^M[1-9]:")][1]
#     temp1=paste0("d",substr(dep,2,2),substr(tempvar,2,2))
#     if(m>1) temp1=paste0(temp1,m)
#     result=c(result,temp1)
#     m<-m+1
#   } else{
#     # result=c(result,paste0("b",l))
#     # l<-l+1
#     if(any(str_detect(temp,"^M[1-9]:"))){
#       # tempvar=temp[str_detect(temp,"^M[1-9]:")][1]
#       # cat("tempvar=",tempvar,"\n")
#       # result=c(result,paste0(prefix,substr(tempvar,2,2),l))
#       result=c(result,paste0(prefix,l))
#       l<-l+1
#     } else{
#       result=c(result,paste0(prefix,j))
#       l<-l+1
#     }
#
#   }
#
# } else if(temp[i] %in% c("X:W","W:X")){
#   if(dep=="Y") {
#     result=c(result,paste0(ifelse(any(str_detect(temp,"^M")),"c'","c"),j))
#
#   } else{
#     result=c(result,paste0(prefix,j))
#
#   }
#   j<-j+1
#
#
# } else if(str_detect(temp[i],"^D[0-9]")){
#   if(dep=="Y") {
#     result=c(result,paste0(ifelse("M" %in% temp,"c'","c"),j))
#
#   } else{
#     result=c(result,paste0(prefix,j))
#
#   }
#   j<-j+1
#
#
# } else if(str_detect(temp[i],"^M[1-9]:?")){
#
#   if(dep %in% c(paste0("M",2:9))) {
#      temp1=paste0("d",substr(dep,2,2),substr(temp[i],2,2))
#      if(m>1) temp1=paste0(temp1,m)
#      result=c(result,temp1)
#      m<-m+1
#   } else{
#     # result=c(result,paste0("b",substr(temp[i],2,2),l))
#     result=c(result,paste0("b",l))
#     l=l+1
#   }
# } else {  #if(temp[i]=="M:W")
#    result=c(result,paste0("b",l))
#    l=l+1
#
# }
}
result
temp
library(processR)
# labels=list(X="cond",M=c("import","pmi"),Y="reaction")
#  name=c("X","M1","M2")
#  dep="M3"
# labels=list(X="X",M=c("M1","M2","M3"),Y="Y")
# cat("name=",name,"\n")
# name=c("M","X","M:W","W","X:W")
# dep="Y"
# labels=list(X="X",M="M",Y="Y")
# constant="iy"
# prefix="b"
name=c("baby","milk","baby:milk")
prefix="a"
dep="wine";constant="iy"
labels=list(X="baby",M=c("wine","tent","sand"),Y="tile",W="milk")
result=c()
dep=changeLabelName(dep,labels,add=FALSE)
dep
# cat("dep=",dep,"\n")
j<-k<-l<-m<-1
temp=changeLabelName(name,labels,add=FALSE)
for(i in seq_along(temp)){
if(dep=="Y"){
if(temp[i]=="(Intercept)"){
result=c(result,"iY")
} else if(str_detect(temp[i],"^X[1-9]?")){
result=c(result,paste0("c",j))
j=j+1
} else if(str_detect(temp[i],"^C[1-9]?")){
if(nchar(temp[i])==1){
result=c(result,paste0("g"))
} else{
result=c(result,paste0("g",substr(temp[i],2,2)))
}
} else if(str_detect(temp[i],"^(W|V|Z)[1-9]?")){
if(paste0("X:",temp[i]) %in% temp){
result=c(result,paste0("c",j))
j=j+1
} else{
result=c(result,paste0("b",l))
l=l+1
}
} else if(str_detect(temp[i],":X[1-9]?")){
result=c(result,paste0("c",j))
j=j+1
} else{
result=c(result,paste0("b",l))
l=l+1
}
} else if(dep=="M"){
if(temp[i]=="(Intercept)"){
result=c(result,"iM")
} else if(str_detect(temp[i],"^C[1-9]?")){
if(nchar(temp[i])==1){
result=c(result,"f")
} else{
result=c(result,paste0("f",substr(temp[i],2,2)))
}
} else{
result=c(result,paste0("a",j))
j=j+1
}
} else{    ##  "M1","M2",...
if(temp[i]=="(Intercept)"){
result=c(result,paste0("i",dep))
} else if(str_detect(temp[i],"^C[1-9]?")){
result=c(result,paste0("f",k))
k=k+1
} else if(str_detect(temp[i],"^M[1:9]?")){
if(nchar(temp[i])==2){  # M1
result=c(result,paste0("d",substr(dep,2,2),substr(temp[i],2,2)))
} else{  ## M1:W
result=c(result,paste0("d",substr(dep,2,2),substr(temp[i],2,2),l))
l<-l+1
}
} else if(str_detect(temp[i],"^(W|V|Z)[1-9]?")){
if(paste0("X:",temp[i]) %in% temp){
result=c(result,paste0("a",j,substr(dep,2,2)))
j=j+1
} else{
tempvar=temp[str_detect(temp,"^M[1-9]:")][1]
result=c(result,paste0("d",substr(dep,2,2),substr(tempvar,2,2),l))
# result=c(result,paste0(prefix,l))
l<-l+1
# result=c(result,paste0("b",l))
# l=l+1
}
} else{
if(length(temp)==1){
result=c(result,paste0("a",substr(dep,2,2)))
} else{
result=c(result,paste0("a",j,substr(dep,2,2)))
j=j+1
}
}
}
# if(temp[i]=="(Intercept)") {
#    if(dep=="M1") {
#      result=c(result,"iM1")
#    } else if(dep=="M2"){
#      result=c(result,"iM2")
#    } else {
#      result=c(result,constant)
#    }
# } else if(temp[i]=="M") {
#   result=c(result,paste0("b",l))
#   l=l+1
# } else if(substr(temp[i],1,1)=="C"){
#   if(dep=="Y") {
#     result=c(result,paste0("g",k))
#   } else{
#     result=c(result,paste0("f",k))
#
#   }
#   k<-k+1
# } else if(temp[i]=="X"){
#   if(dep=="Y") {
#      result=c(result,paste0(ifelse(any(str_detect(temp,"^M")),"c'","c"),j))
#
#   } else if(str_detect(dep,"^M")){
#      result=c(result,paste0("a",j))
#   }  else{
#     result=c(result,paste0(prefix,j))
#
#   }
#   j<-j+1
# } else if(temp[i]=="W"){
#   if(("X:W" %in% temp)|("W:X" %in% temp)|("D1:W" %in% temp)|("W:D1" %in% temp)){
#     if(dep=="Y") {
#       result=c(result,paste0(ifelse(any(str_detect(temp,"^M")),"c'","c"),j))
#
#     } else{
#       result=c(result,paste0(prefix,j))
#
#     }
#     j<-j+1
#   } else if(dep %in% c(paste0("M",2:9))) {
#     tempvar=temp[str_detect(temp,"^M[1-9]:")][1]
#     temp1=paste0("d",substr(dep,2,2),substr(tempvar,2,2))
#     if(m>1) temp1=paste0(temp1,m)
#     result=c(result,temp1)
#     m<-m+1
#   } else{
#     # result=c(result,paste0("b",l))
#     # l<-l+1
#     if(any(str_detect(temp,"^M[1-9]:"))){
#       # tempvar=temp[str_detect(temp,"^M[1-9]:")][1]
#       # cat("tempvar=",tempvar,"\n")
#       # result=c(result,paste0(prefix,substr(tempvar,2,2),l))
#       result=c(result,paste0(prefix,l))
#       l<-l+1
#     } else{
#       result=c(result,paste0(prefix,j))
#       l<-l+1
#     }
#
#   }
#
# } else if(temp[i] %in% c("X:W","W:X")){
#   if(dep=="Y") {
#     result=c(result,paste0(ifelse(any(str_detect(temp,"^M")),"c'","c"),j))
#
#   } else{
#     result=c(result,paste0(prefix,j))
#
#   }
#   j<-j+1
#
#
# } else if(str_detect(temp[i],"^D[0-9]")){
#   if(dep=="Y") {
#     result=c(result,paste0(ifelse("M" %in% temp,"c'","c"),j))
#
#   } else{
#     result=c(result,paste0(prefix,j))
#
#   }
#   j<-j+1
#
#
# } else if(str_detect(temp[i],"^M[1-9]:?")){
#
#   if(dep %in% c(paste0("M",2:9))) {
#      temp1=paste0("d",substr(dep,2,2),substr(temp[i],2,2))
#      if(m>1) temp1=paste0(temp1,m)
#      result=c(result,temp1)
#      m<-m+1
#   } else{
#     # result=c(result,paste0("b",substr(temp[i],2,2),l))
#     result=c(result,paste0("b",l))
#     l=l+1
#   }
# } else {  #if(temp[i]=="M:W")
#    result=c(result,paste0("b",l))
#    l=l+1
#
# }
}
result
if(!("c2" %in% result)) result[result=="c1"]="c"
if(!("c'2" %in% result)) result[result=="c'1"]="c'"
if(!("b2" %in% result)) result[result=="b1"]="b"
if(!dep %in% c("M1","M2","M3")){
if(!("a2" %in% result)) result[result=="a1"]="a"
}
if(!("f2" %in% result)) result[result=="f1"]="f"
if(!("g2" %in% result)) result[result=="g1"]="g"
if("W:X" %in% temp) {
result[result=="c'1"]="c'4"
result[result=="c'2"]="c'1"
result[result=="c'4"]="c'2"
}
# cat("result=",result,"\n")
result
library(processR)
# Three mediator with two moderator
labels=list(X="baby",M=c("wine","tent","sand"),Y="tile")
bmatrix=c(1,1,0,1,0,0,1,1,1,1)
moderator=list(name=c("milk","hair"),labels=c("W","Z"),
matrix=list(c(1,0,0,0,0,0,0,0,0,0),c(0,0,0,0,0,0,0,1,0,0)))
drawConcept(labels=labels,parallel=TRUE,bmatrix=bmatrix,moderator=moderator)
drawModel(labels=labels,parallel=TRUE,bmatrix=bmatrix,moderator=moderator)
labels=list(X="estress",M="affect",Y="withdraw")
vars=list(name=list(c("tenure","age")),site=list(c("a","b")))
moderator=list(name=c("age","sex"),site=list(c("c"),c("b","c")))
drawConcept(labels=labels)
library(processR)
labels=list(X="estress",M="affect",Y="withdraw")
vars=list(name=list(c("tenure","age")),site=list(c("a","b")))
moderator=list(name=c("age","sex"),site=list(c("c"),c("b","c")))
drawConcept(labels=labels)
drawConcept(labels=labels,vars=vars)
drawConcept(labels=labels,moderator=moderator)
drawConcept(labels=labels,vars=vars,moderator=moderator)
drawConcept(labels=labels)
devtools::document()
labels=list(X="estress",M="affect",Y="withdraw")
vars=list(name=list(c("tenure","age")),site=list(c("a","b")))
library(processR)
moderator=list(name=c("age","sex"),site=list(c("c"),c("b","c")))
drawConcept(labels=labels)
drawConcept(labels=labels,drawbox=TRUE)
drawConcept(labels=labels)
drawConcept(labels=labels,drawbox=TRUE)
drawConcept(labels=labels,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,drawbox=TRUE)
drawConcept(labels=labels,moderator=moderator,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,moderator=moderator,label.pos=2,drawbox=TRUE)
labels=list(X="estress",M="affect",Y="withdraw")
vars=list(name=list(c("tenure","age")),site=list(c("a","b")))
moderator=list(name=c("age","sex"),site=list(c("c"),c("b","c")))
drawConcept(labels=labels,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,moderator=moderator,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,moderator=moderator)
moderator=list(name=c("age","sex"),site=list(c("c"),c("b","c")),pos=c(1,2))
drawConcept(labels=labels,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,moderator=moderator,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,moderator=moderator)
moderator=list(name=c("age","sex"),site=list(c("c"),c("b","c")),pos=c(1,2),arr.pos=list(c(0.5),c(0.3,0.7)))
drawConcept(labels=labels,moderator=moderator,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,moderator=moderator)
moderator=list(name=c("age","sex"),site=list(c("c"),c("b","c")),pos=c(1,2),arr.pos=list(c(0.3),c(0.3,0.7)))
drawConcept(labels=labels,moderator=moderator,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,moderator=moderator)
labels=list(X="estress",M="affect",Y="withdraw")
vars=list(name=list(c("tenure","age")),site=list(c("a","b")))
moderator=list(name=c("age","sex"),site=list(c("c"),c("b","c")),pos=c(1,2),arr.pos=list(c(0.3),c(0.3,0.7)))
drawConcept(labels=labels,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,moderator=moderator,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,moderator=moderator)
drawConcept(labels=labels,vars=vars,moderator=moderator,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,moderator=moderator,label.pos=2,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,moderator=moderator,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,moderator=moderator,drawbox=TRUE)
library(processR)
drawConcept(labels=labels,vars=vars,moderator=moderator,drawbox=TRUE)
drawConcept(labels=labels,drawbox=TRUE)
labels=list(X="estress",M="affect",Y="withdraw")
vars=list(name=list(c("tenure","age")),site=list(c("a","b")))
moderator=list(name=c("age","sex"),site=list(c("c"),c("b","c")),pos=c(1,2),arr.pos=list(c(0.3),c(0.3,0.7)))
drawConcept(labels=labels,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,drawbox=TRUE)
drawConcept(labels=labels,moderator=moderator,drawbox=TRUE)
drawConcept(labels=labels,vars=vars,moderator=moderator,drawbox=TRUE)
labels=list(X="X",M=c("M1","M2","M3"),Y="Y")
drawConcept(labels=labels,serial=TRUE)
drawConcept(labels=labels,parallel=TRUE,bmatrix=c(1,1,0,1,0,0,1,1,1,1))
drawConcept(labels=labels,parallel2=TRUE,bmatrix=c(1,1,0,1,0,0,1,1,1,1))
labels=list(X="baby",M=c("wine","tent","sand"),Y="tile")
bmatrix=c(1,1,0,1,0,0,1,1,1,1)
drawConcept(labels=labels,parallel=TRUE,bmatrix=bmatrix)
moderator=list(name=c("milk","hair"),
matrix=list(c(1,1,0,1,0,0,0,0,0,0),c(0,0,0,0,0,0,0,1,0,0)))
drawConcept(labels=labels,parallel=TRUE,bmatrix=bmatrix,moderator=moderator)
bmatrix=c(1,1,0,0,1,1,1,1,0,1)
moderator=list(name=c("milk","hair"),
matrix=list(c(1,0,0,0,1,0,1,0,0,0),c(1,1,0,0,0,0,0,0,0,0)),
pos=c(1,4))
node.pos=list(X=c(0,0.5),M1=c(0.3,0.9),M2=c(0.3,0.1),M3=c(0.7,0.9),
Y=c(1,0.5),W1=c(0.7,0.1),W2=c(0,0.9))
drawConcept(labels=labels,bmatrix=bmatrix,moderator=moderator,node.pos=node.pos)
labels=list(X="baby",M=c("wine","tent","sand"),Y="tile")
vars=list(name=list(c("milk","hair")),matrix=list(c(1,0,0,0,0,0,1,0,0,0)),pos=2)
bmatrix=c(1,1,0,1,0,0,1,1,1,1)
drawConcept(labels=labels,parallel=TRUE,bmatrix=bmatrix,vars=vars)
labels=list(X="X",M=c("M1","M2"),Y="Y")
vars=list(name=list(c("W","Z")),matrix=list(c(0,0,1,0,0,0)),pos=5)
bmatrix=c(1,1,1,1,1,1)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars)
labels=list(X="X",M="M",Y="Y")
vars=list(name=list(c("W","Z")),site=list(c("a","c")),arr.pos=list(c(0.7,0.3)))
moderator=list(name=c("V","Q"),site=list(c("b","c"),c("c")),
pos=c(2,5),arr.pos=list(c(0.3,0.7),0.5))
drawConcept(labels=labels,vars=vars,moderator=moderator,nodemode=2)
drawConcept(labels=labels,vars=vars,moderator=moderator,nodemode=2)
labels=list(X="baby",M=c("wine","tent","sand"),Y="tile")
vars=list(name=list(c("milk","hair")),matrix=list(c(1,0,0,0,0,0,1,0,0,0)),pos=2)
bmatrix=c(1,1,0,1,0,0,1,1,1,1)
drawConcept(labels=labels,parallel=TRUE,bmatrix=bmatrix,vars=vars)
labels=list(X="X",M=c("M1","M2"),Y="Y")
vars=list(name=list(c("W","Z")),matrix=list(c(0,0,1,0,0,0)),pos=5)
bmatrix=c(1,1,1,1,1,1)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars)
library(processR)
library(processR)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars,label.pos=2)
library(processR)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars,label.pos=2)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars,label.pos=2)
devtools::document()
library(processR)
labels=list(X="X",M=c("M1","M2"),Y="Y")
vars=list(name=list(c("W","Z")),matrix=list(c(0,0,1,0,0,0)),pos=5)
bmatrix=c(1,1,1,1,1,1)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars)
vars=list(name=list(c("W","Z")),matrix=list(c(0,0,1,0,0,0)),pos=6)
bmatrix=c(1,1,1,1,1,1)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars)
labels=list(X="X",M="M",Y="Y")
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars)
labels=list(X="X",M=c("M1","M2"),Y="Y")
vars=list(name=list(c("W","Z")),matrix=list(c(0,0,1,0,0,0)),pos=6)
bmatrix=c(1,1,1,1,1,1)
drawConcept(labels=labels,bmatrix=bmatrix,vars=vars)
devtools::check()
devtools::document()
devtools::check()
