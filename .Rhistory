res1=c(res1,Y[k])
}
}
}
} else if(!is.null(bmatrix)){
if(depy){
pos=i+sum(1:xcount)
if(bmatrix[pos]==1){
if(mode==0){
res1=c(res1,paste0("b",i,"*",X[i]))
} else{
res1=c(res1,X[i])
}
}
} else{
if(j>1) {
for(k in 2:max(2,j-1)){
pos=1+sum(1:(j-1))+(k-1)
cat("j=",j,",k=",k,"\n")
cat("pos=",pos,"\n")
cat("bmatrix[",pos,"]=",bmatrix[pos],"\n")
if(bmatrix[pos]==1){
if(mode==0) {
res1=c(res1,paste0("d",j,k-1,"*",Y[k-1]))
} else{
res1=c(res1,Y[k-1])
}
}
}
}
}
}
for(i in 1:xcount){
res=c()
if(is.null(bmatrix)) res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos)==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in seq_along(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
if(serial) {
if(j>1) {
for(k in 1:(j-1)){
if(mode==0) {
res1=c(res1,paste0("d",j,k,"*",Y[k]))
} else{
res1=c(res1,Y[k])
}
}
}
} else if(!is.null(bmatrix)){
if(depy){
pos=i+sum(1:xcount)
if(bmatrix[pos]==1){
if(mode==0){
res1=c(res1,paste0("b",i,"*",X[i]))
} else{
res1=c(res1,X[i])
}
}
} else{
if(j>1) {
for(k in 2:max(2,j-1)){
pos=1+sum(1:(j-1))+(k-1)
cat("j=",j,",k=",k,"\n")
cat("pos=",pos,"\n")
cat("bmatrix[",pos,"]=",bmatrix[pos],"\n")
if(bmatrix[pos]==1){
if(mode==0) {
res1=c(res1,paste0("d",j,k-1,"*",Y[k-1]))
} else{
res1=c(res1,Y[k-1])
}
}
}
}
}
}
}
res1
X=c("M1","M2","M3");Y="Y";W=NULL;labels=list();prefix="a";mode=0;pos=list();serial=FALSE;
bmatrix=c(1,1,0,1,1,0,1,1,1,1);depy=TRUE
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
(xcount=length(X))
(wcount=length(W))
(ycount=length(Y))
temp=c()
for(j in 1:ycount){
res1=c()
i=1
for(i in 1:xcount){
res=c()
if(is.null(bmatrix)) res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos)==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in seq_along(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
if(serial) {
if(j>1) {
for(k in 1:(j-1)){
if(mode==0) {
res1=c(res1,paste0("d",j,k,"*",Y[k]))
} else{
res1=c(res1,Y[k])
}
}
}
} else if(!is.null(bmatrix)){
if(depy){
pos=i+sum(1:xcount)
if(bmatrix[pos]==1){
if(mode==0){
res1=c(res1,paste0("b",i,"*",X[i]))
} else{
res1=c(res1,X[i])
}
}
} else{
if(j>1) {
for(k in 2:max(2,j-1)){
pos=1+sum(1:(j-1))+(k-1)
cat("j=",j,",k=",k,"\n")
cat("pos=",pos,"\n")
cat("bmatrix[",pos,"]=",bmatrix[pos],"\n")
if(bmatrix[pos]==1){
if(mode==0) {
res1=c(res1,paste0("d",j,k-1,"*",Y[k-1]))
} else{
res1=c(res1,Y[k-1])
}
}
}
}
}
}
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
eq=paste0(temp,collapse="\n")
eq
#'makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1)))
#'makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b")
#'makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
#'cat(makeCatEquation2(X="wt",Y="carb",W=c("am","hp")))
#'cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a",serial=TRUE))
#'cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a"))
#'cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a"),
#'   bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE)
#'cat(makeCatEquation2(X=c("M1","M2","M3"),Y="Y",W=NULL,prefix="a"),
#'   bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE)
makeCatEquation2=function(X=NULL,Y=NULL,W=NULL,labels=list(),prefix="b",mode=0,pos=list(),serial=FALSE,
bmatrix=NULL,depy=FALSE){
# X="wt";Y=c("hp","vs");W=c("am");data=mtcars;prefix="a";mode=0;pos=list()
# X=c("hp","vs");Y="mpg";W=c("cyl","wt");prefix="b";mode=0;pos=list(c(1,2),c(1))
# X="wt";Y="mpg";W="cyl";labels=list();prefix="b";mode=0;pos=list()
# X="X";Y=c("M1","M2","M3");W=NULL;labels=list();prefix="a";mode=1;pos=list();serial=TRUE
# X="X";Y=c("M1","M2","M3");W=NULL;labels=list();prefix="a";mode=0;pos=list();serial=FALSE;
# bmatrix=c(1,1,0,1,1,0,1,1,1,1);depy=FALSE
# X=c("M1","M2","M3");Y="Y";W=NULL;labels=list();prefix="a";mode=0;pos=list();serial=FALSE;
# bmatrix=c(1,1,0,1,1,0,1,1,1,1);depy=TRUE
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
(xcount=length(X))
(wcount=length(W))
(ycount=length(Y))
temp=c()
for(j in 1:ycount){
res1=c()
i=1
for(i in 1:xcount){
res=c()
if(is.null(bmatrix)) res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos)==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in seq_along(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
if(serial) {
if(j>1) {
for(k in 1:(j-1)){
if(mode==0) {
res1=c(res1,paste0("d",j,k,"*",Y[k]))
} else{
res1=c(res1,Y[k])
}
}
}
} else if(!is.null(bmatrix)){
if(depy){
pos=i+sum(1:xcount)
if(bmatrix[pos]==1){
if(mode==0){
res1=c(res1,paste0("b",i,"*",X[i]))
} else{
res1=c(res1,X[i])
}
}
} else{
if(j>1) {
for(k in 2:max(2,j-1)){
pos=1+sum(1:(j-1))+(k-1)
cat("j=",j,",k=",k,"\n")
cat("pos=",pos,"\n")
cat("bmatrix[",pos,"]=",bmatrix[pos],"\n")
if(bmatrix[pos]==1){
if(mode==0) {
res1=c(res1,paste0("d",j,k-1,"*",Y[k-1]))
} else{
res1=c(res1,Y[k-1])
}
}
}
}
}
}
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
eq=paste0(temp,collapse="\n")
eq
}
cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a"),
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE)
cat(makeCatEquation2(X=c("M1","M2","M3"),Y="Y",W=NULL,prefix="a"),
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE)
cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a",
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE))
cat(makeCatEquation2(X=c("M1","M2","M3"),Y="Y",W=NULL,prefix="a",
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE))
#'makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1)))
#'makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b")
#'makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
#'cat(makeCatEquation2(X="wt",Y="carb",W=c("am","hp")))
#'cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a",serial=TRUE))
#'cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a"))
#'cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a",
#'   bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE))
#'cat(makeCatEquation2(X=c("M1","M2","M3"),Y="Y",W=NULL,prefix="a",
#'   bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE))
makeCatEquation2=function(X=NULL,Y=NULL,W=NULL,labels=list(),prefix="b",mode=0,pos=list(),serial=FALSE,
bmatrix=NULL,depy=FALSE){
# X="wt";Y=c("hp","vs");W=c("am");data=mtcars;prefix="a";mode=0;pos=list()
# X=c("hp","vs");Y="mpg";W=c("cyl","wt");prefix="b";mode=0;pos=list(c(1,2),c(1))
# X="wt";Y="mpg";W="cyl";labels=list();prefix="b";mode=0;pos=list()
# X="X";Y=c("M1","M2","M3");W=NULL;labels=list();prefix="a";mode=1;pos=list();serial=TRUE
# X="X";Y=c("M1","M2","M3");W=NULL;labels=list();prefix="a";mode=0;pos=list();serial=FALSE;
# bmatrix=c(1,1,0,1,1,0,1,1,1,1);depy=FALSE
# X=c("M1","M2","M3");Y="Y";W=NULL;labels=list();prefix="a";mode=0;pos=list();serial=FALSE;
# bmatrix=c(1,1,0,1,1,0,1,1,1,1);depy=TRUE
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
(xcount=length(X))
(wcount=length(W))
(ycount=length(Y))
temp=c()
for(j in 1:ycount){
res1=c()
i=1
for(i in 1:xcount){
res=c()
if(is.null(bmatrix)) res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos)==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in seq_along(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
if(serial) {
if(j>1) {
for(k in 1:(j-1)){
if(mode==0) {
res1=c(res1,paste0("d",j,k,"*",Y[k]))
} else{
res1=c(res1,Y[k])
}
}
}
} else if(!is.null(bmatrix)){
if(depy){
pos=i+sum(1:xcount)
if(bmatrix[pos]==1){
if(mode==0){
res1=c(res1,paste0("b",i,"*",X[i]))
} else{
res1=c(res1,X[i])
}
}
} else{
if(j>1) {
for(k in 2:max(2,j-1)){
pos=1+sum(1:(j-1))+(k-1)
# cat("j=",j,",k=",k,"\n")
# cat("pos=",pos,"\n")
# cat("bmatrix[",pos,"]=",bmatrix[pos],"\n")
if(bmatrix[pos]==1){
if(mode==0) {
res1=c(res1,paste0("d",j,k-1,"*",Y[k-1]))
} else{
res1=c(res1,Y[k-1])
}
}
}
}
}
}
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
eq=paste0(temp,collapse="\n")
eq
}
cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a",
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE))
cat(makeCatEquation2(X=c("M1","M2","M3"),Y="Y",W=NULL,prefix="a",
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE))
cat(makeCatEquation2(X=c("M1","M2","M3"),Y="Y",W=NULL,prefix="a",
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=TRUE))
cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a",
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE))
#'makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1)))
#'makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b")
#'makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
#'cat(makeCatEquation2(X="wt",Y="carb",W=c("am","hp")))
#'cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a",serial=TRUE))
#'cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a"))
#'cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a",
#'   bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE))
#'cat(makeCatEquation2(X=c("M1","M2","M3"),Y="Y",W=NULL,prefix="a",
#'   bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=TRUE))
makeCatEquation2=function(X=NULL,Y=NULL,W=NULL,labels=list(),prefix="b",mode=0,pos=list(),serial=FALSE,
bmatrix=NULL,depy=FALSE){
# X="wt";Y=c("hp","vs");W=c("am");data=mtcars;prefix="a";mode=0;pos=list()
# X=c("hp","vs");Y="mpg";W=c("cyl","wt");prefix="b";mode=0;pos=list(c(1,2),c(1))
# X="wt";Y="mpg";W="cyl";labels=list();prefix="b";mode=0;pos=list()
# X="X";Y=c("M1","M2","M3");W=NULL;labels=list();prefix="a";mode=1;pos=list();serial=TRUE
# X="X";Y=c("M1","M2","M3");W=NULL;labels=list();prefix="a";mode=0;pos=list();serial=FALSE;
# bmatrix=c(1,1,0,1,1,0,1,1,1,1);depy=FALSE
# X=c("M1","M2","M3");Y="Y";W=NULL;labels=list();prefix="a";mode=0;pos=list();serial=FALSE;
# bmatrix=c(1,1,0,1,1,0,1,1,1,1);depy=TRUE
if(is.null(X)) X=labels$X
if(is.null(W)) if(!is.null(labels$W)) W=labels$W
if(is.null(Y)) Y=labels$Y
xgroup<-wgroup<-c()
xcount<-wcount<-ycount<-0
(xcount=length(X))
(wcount=length(W))
(ycount=length(Y))
temp=c()
for(j in 1:ycount){
res1=c()
i=1
for(i in 1:xcount){
res=c()
if(depy==FALSE) res=c(res,X[i])
res
for(l in seq_along(W)){
if(length(pos)==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(length(pos[[l]])==0){
res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in seq_along(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
if(serial) {
if(j>1) {
for(k in 1:(j-1)){
if(mode==0) {
res1=c(res1,paste0("d",j,k,"*",Y[k]))
} else{
res1=c(res1,Y[k])
}
}
}
} else if(!is.null(bmatrix)){
if(depy){
pos=i+sum(1:xcount)
if(bmatrix[pos]==1){
if(mode==0){
res1=c(res1,paste0("b",i,"*",X[i]))
} else{
res1=c(res1,X[i])
}
}
} else{
if(j>1) {
for(k in 2:max(2,j-1)){
pos=1+sum(1:(j-1))+(k-1)
# cat("j=",j,",k=",k,"\n")
# cat("pos=",pos,"\n")
# cat("bmatrix[",pos,"]=",bmatrix[pos],"\n")
if(bmatrix[pos]==1){
if(mode==0) {
res1=c(res1,paste0("d",j,k-1,"*",Y[k-1]))
} else{
res1=c(res1,Y[k-1])
}
}
}
}
}
}
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
eq=paste0(temp,collapse="\n")
eq
}
cat(makeCatEquation2(X="X",Y=c("M1","M2","M3"),W=NULL,prefix="a",
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=FALSE))
cat(makeCatEquation2(X=c("M1","M2","M3"),Y="Y",W=NULL,prefix="a",
bmatrix=c(1,1,0,1,1,0,1,1,1,1),depy=TRUE))
makeCatEquation2(X="wt",Y="mpg")
makeCatEquation2(X="wt",Y="mpg",W="cyl")
makeCatEquation2(X="wt",Y=c("hp","vs"),W="cyl",prefix="a")
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl","am"),prefix="a",pos=list(1,2))
library(processR)
devtools::document()
devtools::document()
library(processR)
labels=list(X="X",M=c("M1","M2"),Y="Y")
cat(multipleMediation(labels=labels))
labels=list(X="X",M=c("M1","M2"),Y="Y")
cat(multipleMediation(labels=labels))
