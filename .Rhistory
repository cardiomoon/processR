if(is.null(W)) df1$name[count]=("cg-1")
df1$start=df1$label
df1$end="Y"
count=length(df1$label)
df1
df2<-df1
df2$name=paste0("a",1:count)
if(is.null(W)) df2$name[count]=("ag-1")
df2$end="M"
df2
df3=data.frame(label="M",lty=1,name="b",start="M",end="Y",stringsAsFactors = FALSE)
df=rbind(df1,df2,df3)
df
X=paste0("D",1:(xcount-1))
if(is.null(W)) X=c(X,"Dg-1")
Y="Y"
XW=NULL
if(!is.null(W)) {
XW=paste0("D",1:(xcount-1),W)
} else{
if(addDots) {
count=length(X)
X= c(X,X[count])
X[count]="dot"
count=length(X)
}
}
X
XW
df1=data.frame(label=c(X,XW),stringsAsFactors = FALSE)
df1
df1$lty=1
df1$name=paste0("c",rep(1:nrow(df1),2))
xcount=3;M="M";W="W";whatLabel="name";addDots=TRUE
xmargin=0.01;radx=0.12
ymargin=0.02;xlim=c(-0.2,1.2);ylim=xlim
rady=0.04;maxypos=0.6;minypos=0.2;ypos=c(1,0.5);mpos=c(0.5,0.9)
xinterval=NULL;yinterval=NULL;box.col="white";xspace=NULL;label.pos=list()
X=paste0("D",1:(xcount-1))
if(is.null(W)) X=c(X,"Dg-1")
Y="Y"
XW=NULL
if(!is.null(W)) {
XW=paste0("D",1:(xcount-1),W)
} else{
if(addDots) {
count=length(X)
X= c(X,X[count])
X[count]="dot"
count=length(X)
}
}
X
XW
df1=data.frame(label=c(X,XW),stringsAsFactors = FALSE)
df1
xcount=3;M="M";W="W";whatLabel="name";addDots=TRUE
xmargin=0.01;radx=0.12
ymargin=0.02;xlim=c(-0.2,1.2);ylim=xlim
rady=0.04;maxypos=0.6;minypos=0.2;ypos=c(1,0.5);mpos=c(0.5,0.9)
xinterval=NULL;yinterval=NULL;box.col="white";xspace=NULL;label.pos=list()
X=paste0("D",1:(xcount-1))
if(is.null(W)) X=c(X,"Dg-1")
Y="Y"
XW=NULL
if(!is.null(W)) {
XW=paste0("D",1:(xcount-1),W)
XW=c(W,XW)
} else{
if(addDots) {
count=length(X)
X= c(X,X[count])
X[count]="dot"
count=length(X)
}
}
X
XW
df1=data.frame(label=c(X,XW),stringsAsFactors = FALSE)
df1
df1$lty=1
df1$name=paste0("c",1:nrow(df1))
if(is.null(W)) df1$name[count]=("cg-1")
df1$start=df1$label
df1$end="Y"
count=length(df1$label)
df1
df2<-df1
df2$name=paste0("a",1:count)
if(is.null(W)) df2$name[count]=("ag-1")
df2$end="M"
df2
df3=data.frame(label="M",lty=1,name="b",start="M",end="Y",stringsAsFactors = FALSE)
df=rbind(df1,df2,df3)
df
name=c("Y","M",c(X,XW))
nodes=data.frame(name=name,stringsAsFactors = FALSE)
nodes
nodes=data.frame(name=name,stringsAsFactors = FALSE)
nodes
if(is.null(W)){
nodes$xpos=c(ypos[1],mpos[1],rep(0,count))
nodes$ypos=c(ypos[2],mpos[2],count:1)
} else{
nodes$xpos=c(ypos[1],mpos[1],rep(0,(count-1)/2),0.05,rep(0.1,(count-1)/2))
nodes$ypos=c(ypos[2],mpos[2],((count-1)/2):1,0.2,rep(0.1,(count-1)/2))
}
nodes$ypos=adjustypos(nodes$ypos,ymargin=ymargin,rady=rady,
maxypos=maxypos,minypos=minypos)
if(is.null(M)) {
nodes=nodes[-2,]
}
nodes
makeSubscript=function(x){
res=c()
for(i in seq_along(x)){
if(nchar(x[i])==1){
temp=paste0("expression(italic(",x[i],"))")
} else if(str_detect(x[i],paste0(W,"$"))){
temp=paste0("expression(italic(",substr(x[i],1,1),"[",substr(x[i],2,nchar(x[i])-nchar(W)),"]",
substr(x[i],nchar(x[i])-nchar(W)+1,nchar(x[i])),"))")
} else{
temp=paste0("expression(italic(",substr(x[i],1,1),"[",substr(x[i],2,nchar(x[i])),"]))")
}
res=c(res,temp)
}
res
}
nodes$label=makeSubscript(nodes$name)
require(stringr)
nodes$label=makeSubscript(nodes$name)
nodes
arrows=df
arrows$labelpos=0.6
arrows$arrpos=0.8
arrows$no=1
arrows$label1=arrows$label
arrows$label=arrows$name
addprime=TRUE
arrows
# print(nodes)
# print(arrows)
openplotmat(xlim=xlim,ylim=ylim)
require(diagram)
# print(nodes)
# print(arrows)
openplotmat(xlim=xlim,ylim=ylim)
for(i in 1:nrow(arrows)){
temppos=arrows$labelpos[i]
if(!is.null(label.pos[[arrows$name[i]]])) temppos=label.pos[[arrows$name[i]]]
if(arrows$start[i]!="dot"){
myarrow2(nodes, from=arrows$start[i],to=arrows$end[i],
label=arrows$label[i],no=arrows$no[1],xmargin=xmargin,radx=radx,rady=rady,
label.pos=temppos,arr.pos=NULL,lty=arrows$lty[i],addprime=addprime,xspace=xspace)
}
}
for(i in 1:nrow(nodes)){
xpos=nodes$xpos[i]
xpos=adjustxpos(xpos,xmargin,radx,xspace=xspace)
mid=c(xpos,nodes$ypos[i])
label=eval(parse(text=nodes$label[i]))
if(nodes$name[i]!="dot"){
drawtext(mid,radx=radx,rady=rady,lab=label,latent=FALSE,box.col=box.col)
}
}
if(addDots){
nodes
select=which(nodes$name=="dot")
xpos=nodes$xpos[select]
ypos=nodes$ypos[select]
xpos=adjustxpos(xpos,xmargin,radx,xspace=xspace)
textplain(c(xpos,mean(c(ypos,nodes$ypos[select-1]-rady))),lab=".")
textplain(c(xpos,ypos),lab=".")
textplain(c(xpos,mean(c(ypos,nodes$ypos[select+1]+rady))),lab=".")
xnodes=nodes[!(nodes$name %in% c("M","Y")),]
rect(xpos-xmargin-radx-0.01,min(xnodes$ypos)-rady-ymargin,
xpos+xmargin+radx+0.01,max(xnodes$ypos)+rady+ymargin,lty=2)
textplain(c(xpos-xmargin-radx-0.04,mean(xnodes$ypos)),lab=expression(italic(X)))
}
xcount=3;M="M";W="W";whatLabel="name";addDots=TRUE
xmargin=0.01;radx=0.12
ymargin=0.02;xlim=c(-0.2,1.2);ylim=xlim
rady=0.04;maxypos=0.6;minypos=0.2;ypos=c(1,0.5);mpos=c(0.5,0.9)
xinterval=NULL;yinterval=NULL;box.col="white";xspace=NULL;label.pos=list()
X=paste0("D",1:(xcount-1))
if(is.null(W)) X=c(X,"Dg-1")
Y="Y"
XW=NULL
if(!is.null(W)) {
XW=paste0("D",1:(xcount-1),W)
XW=c(W,XW)
} else{
if(addDots) {
count=length(X)
X= c(X,X[count])
X[count]="dot"
count=length(X)
}
}
X
XW
df1=data.frame(label=c(X,XW),stringsAsFactors = FALSE)
df1
df1$lty=1
df1$name=paste0("c",1:nrow(df1))
if(is.null(W)) df1$name[count]=("cg-1")
df1$start=df1$label
df1$end="Y"
count=length(df1$label)
df1
if(!is.null(M)){
df2<-df1
df2$name=paste0("a",1:count)
if(is.null(W)) df2$name[count]=("ag-1")
df2$end="M"
df2
df3=data.frame(label="M",lty=1,name="b",start="M",end="Y",stringsAsFactors = FALSE)
df=rbind(df1,df2,df3)
} else{
df=df1
}
df
name=c("Y","M",c(X,XW))
nodes=data.frame(name=name,stringsAsFactors = FALSE)
nodes
if(is.null(W)){
nodes$xpos=c(ypos[1],mpos[1],rep(0,count))
nodes$ypos=c(ypos[2],mpos[2],count:1)
} else{
nodes$xpos=c(ypos[1],mpos[1],rep(0,(count-1)/2),0.05,rep(0.1,(count-1)/2))
nodes$ypos=c(ypos[2],mpos[2],((count-1)/2):1,0.2,rep(0.1,(count-1)/2))
}
nodes$ypos=adjustypos(nodes$ypos,ymargin=ymargin,rady=rady,
maxypos=maxypos,minypos=minypos)
if(is.null(M)) {
nodes=nodes[-2,]
}
nodes
makeSubscript=function(x){
res=c()
for(i in seq_along(x)){
if(nchar(x[i])==1){
temp=paste0("expression(italic(",x[i],"))")
} else if(str_detect(x[i],paste0(W,"$"))){
temp=paste0("expression(italic(",substr(x[i],1,1),"[",substr(x[i],2,nchar(x[i])-nchar(W)),"]",
substr(x[i],nchar(x[i])-nchar(W)+1,nchar(x[i])),"))")
} else{
temp=paste0("expression(italic(",substr(x[i],1,1),"[",substr(x[i],2,nchar(x[i])),"]))")
}
res=c(res,temp)
}
res
}
nodes$label=makeSubscript(nodes$name)
nodes
arrows=df
arrows$labelpos=0.6
arrows$arrpos=0.8
arrows$no=1
arrows$label1=arrows$label
arrows$label=arrows$name
addprime=TRUE
arrows
devtools::document()
drawCatModel(xcount=4)
drawCatModel(M="M",box.col="yellow")
library(processR)
drawCatModel(xcount=4)
drawCatModel(M="M",box.col="yellow")
drawCatModel(M="M",W="W")
text(0.5,0.5,"test")
text(0.5,0.5,expression(italic(D[1])))
openplotmat(xlim=xlim,ylim=ylim)
openplotmat(xlim=c(0,1),ylim=c(0,1))
text(0.5,0.5,expression(italic(D[1])))
text(0.5,0.5,expression(italic(D[1]W)))
text(0.5,0.5,expression(italic(D[1] W)))
text(0.5,0.5,expression(italic(D[1])italic(W)))
text(0.5,0.5,expression(italic(D[1])*italic(W)))
openplotmat(xlim=xlim,ylim=ylim)
openplotmat(xlim=c(0,1),ylim=c(0,1))
text(0.5,0.5,expression(italic(D[1])*italic(W)))
library(processR)
drawCatModel(M="M",box.col="yellow")
drawCatModel(xcount=4)
drawCatModel(M="M",W="W")
library(processR)
drawCatModel(M="M",W="W")
library(processR)
drawCatModel(M="M",box.col="yellow")
drawCatModel(xcount=4)
drawCatModel(M="M",W="W")
library(processR)
drawCatModel(M="M",box.col="yellow")
drawCatModel(xcount=4)
drawCatModel(M="M",W="W")
library(processR)
drawCatModel(xcount=4)
drawCatModel(M="M",W="W")
drawCatModel(M="M",box.col="yellow")
drawCatModel(xcount=4)
drawCatModel(M="M",box.col="yellow")
drawCatModel(xcount=4)
drawCatModel(M="M",box.col="yellow")
drawCatModel(xcount=4)
drawCatModel(M="M",W="W")
library(processR)
drawCatModel(M="M",box.col="yellow")
drawCatModel(xcount=4)
drawCatModel(M="M",W="W")
library(processR)
drawCatModel(xcount=4)
drawCatModel(M="M",box.col="yellow")
drawCatModel(M="M",W="W")
drawCatModel(M="M",W="W",xcount=4)
drawCatModel(M="M",W="W",xcount=5)
drawCatModel(M="M",W="W",xcount=3)
drawCatModel(M="M",W="W")
drawCatModel(M="M",W="W")
xcount=3;M="M";W="W";whatLabel="name";addDots=TRUE
xmargin=0.01;radx=0.12
ymargin=0.02;xlim=c(-0.2,1.2);ylim=xlim
rady=0.04;maxypos=0.6;minypos=0.2;ypos=c(1,0.5);mpos=c(0.5,0.9)
xinterval=NULL;yinterval=NULL;box.col="white";xspace=NULL;label.pos=list()
X=paste0("D",1:(xcount-1))
if(is.null(W)) X=c(X,"Dg-1")
Y="Y"
XW=NULL
if(!is.null(W)) {
XW=paste0("D",1:(xcount-1),W)
XW=c(W,XW)
} else{
if(addDots) {
count=length(X)
X= c(X,X[count])
X[count]="dot"
count=length(X)
}
}
X
XW
df1=data.frame(label=c(X,XW),stringsAsFactors = FALSE)
df1
df1$lty=1
df1$name=paste0("c",1:nrow(df1))
if(is.null(W)) df1$name[count]=("cg-1")
df1$start=df1$label
df1$end="Y"
count=length(df1$label)
df1
if(!is.null(M)){
df2<-df1
df2$name=paste0("a",1:count)
if(is.null(W)) df2$name[count]=("ag-1")
df2$end="M"
df2
df3=data.frame(label="M",lty=1,name="b",start="M",end="Y",stringsAsFactors = FALSE)
df=rbind(df1,df2,df3)
} else{
df=df1
}
df
name=c("Y","M",c(X,XW))
nodes=data.frame(name=name,stringsAsFactors = FALSE)
nodes
if(is.null(W)){
nodes$xpos=c(ypos[1],mpos[1],rep(0,count))
nodes$ypos=c(ypos[2],mpos[2],count:1)
} else{
nodes$xpos=c(ypos[1],mpos[1],rep(0,(count-1)/2),0.1,seq(from=0.2,by=0.1,length.out=(count-1)/2))
nodes$ypos=c(ypos[2],mpos[2],((count-1)/2+2):3,2,rep(1,(count-1)/2))
}
nodes$ypos=adjustypos(nodes$ypos,ymargin=ymargin,rady=rady,
maxypos=maxypos,minypos=minypos)
if(is.null(M)) {
nodes=nodes[-2,]
}
nodes
makeSubscript=function(x){
res=c()
for(i in seq_along(x)){
if(nchar(x[i])==1){
temp=paste0("expression(italic(",x[i],"))")
} else if(is.null(W)){
temp=paste0("expression(italic(",substr(x[i],1,1),"[",substr(x[i],2,nchar(x[i])),"]))")
} else if(str_detect(x[i],paste0(W,"$"))){
temp=paste0("expression(italic(",substr(x[i],1,1),"[",substr(x[i],2,nchar(x[i])-nchar(W)),"])*italic(",
substr(x[i],nchar(x[i])-nchar(W)+1,nchar(x[i])),"))")
} else{
temp=paste0("expression(italic(",substr(x[i],1,1),"[",substr(x[i],2,nchar(x[i])),"]))")
}
res=c(res,temp)
}
res
}
nodes$label=makeSubscript(nodes$name)
nodes
arrows=df
arrows$labelpos=0.6
arrows$arrpos=0.8
arrows$no=1
arrows$label1=arrows$label
arrows$label=arrows$name
addprime=TRUE
arrows
print(nodes)
print(arrows)
openplotmat(xlim=xlim,ylim=ylim)
for(i in 1:nrow(arrows)){
temppos=arrows$labelpos[i]
if(!is.null(label.pos[[arrows$name[i]]])) temppos=label.pos[[arrows$name[i]]]
if(arrows$start[i]!="dot"){
myarrow2(nodes, from=arrows$start[i],to=arrows$end[i],
label=arrows$label[i],no=arrows$no[1],xmargin=xmargin,radx=radx,rady=rady,
label.pos=temppos,arr.pos=NULL,lty=arrows$lty[i],addprime=addprime,xspace=xspace)
}
}
for(i in 1:nrow(nodes)){
xpos=nodes$xpos[i]
xpos=adjustxpos(xpos,xmargin,radx,xspace=xspace)
mid=c(xpos,nodes$ypos[i])
label=eval(parse(text=nodes$label[i]))
if(nodes$name[i]!="dot"){
drawtext(mid,radx=radx,rady=rady,lab=label,latent=FALSE,box.col=box.col)
}
}
nodes
xnodes=nodes[!(nodes$name %in% c("M","Y","W")),]
xnodes
wnodes=xnodes[(count/2+1):count,]
xnodes=xnodes[1:(count/2),]
wnodes
xnodes
xpos=xnodes$xpos[1]
xpos=adjustxpos(xpos,xmargin,radx,xspace=xspace)
rect(xpos-xmargin-radx-0.01,min(xnodes$ypos)-rady-ymargin,
xpos+xmargin+radx+0.01,max(xnodes$ypos)+rady+ymargin,lty=2)
textplain(c(xpos-xmargin-radx-0.04,mean(xnodes$ypos)),lab=expression(italic(X)))
xpos=wnodes$xpos[1]
xpos2=wnodes$xpos[count/2]
xpos=adjustxpos(xpos,xmargin,radx,xspace=xspace)
xpos2=adjustxpos(xpos2,xmargin,radx,xspace=xspace)
rect(xpos-xmargin-radx-0.01,min(xnodes$ypos)-rady-ymargin,
xpos2+xmargin+radx+0.01,max(xnodes$ypos)+rady+ymargin,lty=2)
rect(xpos-xmargin-radx-0.01,min(wnodes$ypos)-rady-ymargin,
xpos2+xmargin+radx+0.01,max(wnodes$ypos)+rady+ymargin,lty=2)
rect(xpos-xmargin-radx-0.01,min(wnodes$ypos)-rady-ymargin,
xpos2+xmargin+radx+0.01,max(wnodes$ypos)+rady+ymargin,lty=2)
textplain(mean(xpos,xpos1),max(wnodes$ypos)+2*rady+ymargin,lab=expression(italic(XW)))
textplain(mean(xpos,xpos2),max(wnodes$ypos)+2*rady+ymargin,lab=expression(italic(XW)))
textplain(mean(xpos,xpos2),min(wnodes$ypos)-rady-ymargin,lab=expression(italic(XW)))
rect(xpos-xmargin-radx-0.01,min(wnodes$ypos)-rady-ymargin,
xpos2+xmargin+radx+0.01,max(wnodes$ypos)+rady+ymargin,lty=2)
textplain(mean(xpos,xpos2),min(wnodes$ypos)-rady-ymargin,lab=expression(italic(XW)))
wnodes
textplain((xpos+xpos2)/2,min(wnodes$ypos)-rady-ymargin,lab=expression(italic(XW)))
textplain((xpos+xpos2)/2,0.5,lab=expression(italic(XW)))
textplain(0.5,0.5,lab=expression(italic(XW)))
textplain(0.5,0.5,lab=expression(italic(X)))
textplain(0.5,0.5,lab=expression(italic(X)*italic(W)))
text(0.5,0.5,lab=expression(italic(X)*italic(W)))
textplain(0.5,0.6,lab=expression(italic(X)*italic(W)))
text(0.5,0.6,lab=expression(italic(X)*italic(W)))
text((xpos+xpos2)/2,min(wnodes$ypos)-rady-ymargin,lab=expression(italic(X)*italic(W)))
text((xpos+xpos2)/2,min(wnodes$ypos)-2*rady-ymargin,lab=expression(italic(X)*italic(W)))
textplain((xpos+xpos2)/2,min(wnodes$ypos)-2*rady-ymargin,lab=expression(italic(X)*italic(W)))
library(processR)
drawCatModel(M="M",box.col="yellow")
drawCatModel(xcount=4)
drawCatModel(M="M",W="W")
library(processR)
library(processR)
drawCatModel(M="M",box.col="yellow")
drawCatModel(xcount=4)
drawCatModel(M="M",W="W")
library(processR)
drawCatModel(M="M",W="W")
library(processR)
drawCatModel(M="M",W="W",xlim=c(0,1),ylim=c(0.1,1))
drawCatModel(M="M",W="W",xlim=c(-0.5,1),ylim=c(0.1,1))
drawCatModel(M="M",W="W",xlim=c(-0.05,1),ylim=c(0.1,1))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.1,1))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1),ylim=c(0.1,1))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.1,1))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.2,1))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.15,1))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,1))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.9))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95))
drawCatModel(M="M",W="W",xlim=c(-0.08,0.95),ylim=c(0.13,0.95))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95))
library(processR)
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95),ypos=c(1,0.55))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95),ypos=c(1,0.55))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95),ypos=c(1,0.6))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95),ypos=c(1,0.55))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1.2),ylim=c(0.13,0.95),ypos=c(1.2,0.6))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1.3),ylim=c(0.13,0.95),ypos=c(1.2,0.6))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1.4),ylim=c(0.13,0.95),ypos=c(1.2,0.6))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1.5),ylim=c(0.13,0.95),ypos=c(1.2,0.6))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1.4),ylim=c(0.13,0.95),ypos=c(1.2,0.6))
drawCatModel(xcount=5,M="M",W="W",xlim=c(-0.08,1.4),ylim=c(0.13,0.95),ypos=c(1.2,0.6))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1.4),ylim=c(0.13,0.95),ypos=c(1.2,0.6))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1.4),ylim=c(0.13,0.95))
drawCatModel(xcount=4,M="M",W="W")
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95),ypos=c(1,0.55))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95),ypos=c(1,0.55))
drawCatModel(M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95),ypos=c(1,0.55))
drawCatModel(xcount=4,M="M",W="W",xlim=c(-0.08,1),ylim=c(0.13,0.95),ypos=c(1,0.55))
devtools::document()
library(processR)
