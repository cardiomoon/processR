res=c(res,W[l],paste0(X[i],":",W[l]))
} else if(i %in% pos[[l]]){
res=c(res,W[l],paste0(X[i],":",W[l]))
}
}
if(mode==0){
temp1=c()
for(k in 1:length(res)){
temp1=c(temp1,paste0(prefix,k,ifelse(xcount>1,i,""),
ifelse(ycount>1,j,""),"*",res[k]))
}
} else{
temp1=res
}
res1=c(res1,temp1)
}
res1
temp=c(temp,paste0(Y[j],"~",paste0(res1,collapse="+")))
}
temp
eq=paste0(temp,collapse="\n")
eq
library(processR)
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(c(1,2)))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b")
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=c(1,2))
makeCatEquation2(X=c("hp","vs"),Y="mpg",W=c("cyl"),prefix="b",pos=list(c(1,2)))
library(processR)
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(1))
makeCatEquation2(X="wt",Y=c("hp","vs"),W=c("cyl"),prefix="a",pos=list(c(1,2)))
library(processR)
library(ggplot2)
labels=list(X="protest",W="sexism",M="respappr",Y="liking")
catlabels=c("No protest","Individual protest","Collective protest")
catlabels2=c("No protest","Individual protest","Collective protest","Any protest")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))
library(processR)
labels=list(X="protest",W="sexism",M="respappr",Y="liking")
catlabels=c("No protest","Individual protest","Collective protest")
catlabels2=c("No protest","Individual protest","Collective protest","Any protest")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))
condPlotCat(labels=labels,yvar="M",data=protest,addvars=FALSE,mode=3,ypos=c(0.2,0.15,0.1))
condPlotCat(labels=labels,yvar="M",data=protest,addvars=FALSE,mode=3,ypos=c(0.2,0.15,0.1))
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))
labels=list(X="protest",M="respappr",Y="liking",W="sexism")
data=protest;yvar="M";addvars=TRUE;mode=3;rangemode=2
maxylev=6;xpos=0.5
catlabels=NULL;add.slopelabel=FALSE
add.point=TRUE;add.vlines=TRUE;add.anova=TRUE;ypos=NULL
add.arrow=TRUE;hjust=NULL;ypos2=NULL;ceno=1;xinterval=NULL
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,
addvars=addvars,maxylev=6,mode=mode)
# labels=list(X="protest",M="respappr",Y="liking",W="sexism")
data=protest;yvar="M";total=FALSE;addvars=TRUE;mode=3;rangemode=2
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,
addvars=addvars,maxylev=6,mode=mode)
X=labels$X
W=labels$W
Y=ifelse(yvar=="M",labels$M,labels$Y)
if(length(unique(data[[X]]))<=maxylev) catVar="X"
if(length(unique(data[[W]]))<=maxylev) catVar="W"
if(catVar=="W"){
W=labels$X
X=labels$W
}
slopeDf=getCatSlopeDf(labels=labels,data=data,yvar=yvar,total=total,addvars=addvars,
mode=mode,rangemode=rangemode,add.label=add.slopelabel,
maxylev=maxylev)
slopeDf
p<-ggplot(data=data,aes_string(x=W,y=Y))
p<-add_lines(p,slopeDf,add.coord.fixed=add.slopelabel,size=1,xpos=xpos,parse=TRUE)
require(predict3d)
p<-ggplot(data=data,aes_string(x=W,y=Y))
p<-add_lines(p,slopeDf,add.coord.fixed=add.slopelabel,size=1,xpos=xpos,parse=TRUE)
p
fit
count=nrow(slopeDf)
x=quantile(data[[W]],probs=c(0.16,0.5,0.84),type=6)
df=data.frame(x=rep(x,count))
df$color=rep(1:count,each=3)
df
labels=list(X="protest",M="respappr",Y="liking",W="sexism")
data=protest;yvar="M";total=FALSE;addvars=TRUE;mode=3;rangemode=2
maxylev=6;xpos=0.5
catlabels=NULL;add.slopelabel=FALSE
add.point=TRUE;add.vlines=TRUE;add.anova=TRUE;ypos=NULL
add.arrow=TRUE;hjust=NULL;ypos2=NULL;ceno=1;xinterval=NULL
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,
addvars=addvars,maxylev=6,mode=mode)
X=labels$X
W=labels$W
Y=ifelse(yvar=="M",labels$M,labels$Y)
if(length(unique(data[[X]]))<=maxylev) catVar="X"
if(length(unique(data[[W]]))<=maxylev) catVar="W"
if(catVar=="W"){
W=labels$X
X=labels$W
}
slopeDf=getCatSlopeDf(labels=labels,data=data,yvar=yvar,total=total,addvars=addvars,
mode=mode,rangemode=rangemode,add.label=add.slopelabel,
maxylev=maxylev)
slopeDf
p<-ggplot(data=data,aes_string(x=W,y=Y))
labels=list(X="protest",M="respappr",Y="liking",W="sexism")
data=protest;yvar="M";total=FALSE;addvars=TRUE;mode=3;rangemode=2
maxylev=6;xpos=0.5
catlabels=NULL;add.slopelabel=FALSE
add.point=TRUE;add.vlines=TRUE;add.anova=TRUE;ypos=NULL
add.arrow=TRUE;hjust=NULL;ypos2=NULL;ceno=1;xinterval=NULL
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,
addvars=addvars,maxylev=6,mode=mode)
X=labels$X
W=labels$W
Y=ifelse(yvar=="M",labels$M,labels$Y)
if(length(unique(data[[X]]))<=maxylev) catVar="X"
if(length(unique(data[[W]]))<=maxylev) catVar="W"
if(catVar=="W"){
W=labels$X
X=labels$W
}
slopeDf=getCatSlopeDf(labels=labels,data=data,yvar=yvar,total=total,addvars=addvars,
mode=mode,rangemode=rangemode,add.label=add.slopelabel,
maxylev=maxylev)
slopeDf
slopeDf=getCatSlopeDf(labels=labels,data=data,yvar=yvar,total=total,addvars=FALSE,
mode=mode,rangemode=rangemode,add.label=add.slopelabel,
maxylev=maxylev)
slopeDf=getCatSlopeDf(labels=labels,data=data,yvar=yvar,total=total,addvars=TRUE,
mode=mode,rangemode=rangemode,add.label=add.slopelabel,
maxylev=maxylev)
slopeDf
labels=list(X="protest",W="sexism",M="respappr",Y="liking")
data=protest;yvar="Y";total=TRUE;addvars=TRUE
add.label=FALSE;maxylev=6;mode=3;rangemode=2
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,addvars=addvars,mode=mode)
X=labels$X
W=labels$W
Y=ifelse(yvar=="Y",labels$Y,labels$M)
if(length(unique(data[[X]]))<=maxylev) catVar="X"
if(length(unique(data[[W]]))<=maxylev) catVar="W"
if(catVar=="W"){
W=labels$X
X=labels$W
}
if(total==TRUE){
moderator=list(name=labels$W,site=list(c("a","c")))
eq=catMediation(X=X,M=labels$M,Y=Y,moderator=moderator,data=data,maxylev=maxylev,mode=1)
model=unlist(strsplit(eq,"\n"))[2]
temp=unlist(strsplit(model,"~"))[2] %>%
strsplit("\\+") %>% unlist()
model=paste0(Y,"~",paste(paste0("b",1:length(temp),"*",temp),collapse="+"))
} else{
model=makeCatEquation(X=X,Y=Y,W=W,data=data,mode=0)
}
model
require(tidyverse)
if(total==TRUE){
moderator=list(name=labels$W,site=list(c("a","c")))
eq=catMediation(X=X,M=labels$M,Y=Y,moderator=moderator,data=data,maxylev=maxylev,mode=1)
model=unlist(strsplit(eq,"\n"))[2]
temp=unlist(strsplit(model,"~"))[2] %>%
strsplit("\\+") %>% unlist()
model=paste0(Y,"~",paste(paste0("b",1:length(temp),"*",temp),collapse="+"))
} else{
model=makeCatEquation(X=X,Y=Y,W=W,data=data,mode=0)
}
model
count=length(unique(data[[X]]))
ratio=getRatioTable(count,mode=mode)
ratio
colnames(ratio)=paste0("D",1:(count-1))
eq=unlist(strsplit(model,"~"))[2]
eq
eq=str_replace_all(eq,":","*")
eq=str_replace_all(eq,W,"W")
if(total==TRUE) {
eq=str_replace_all(eq,labels$M,as.character(mean(data[[labels$M]],na.rm=TRUE)))
}
eq=paste0("b0+",eq)
eq1=unlist(strsplit(eq,"\\+"))
eq1
ratio
intercept<-slope<-list()
for(i in 1:count){
temp=eq1
temp
ncol(ratio)
for(j in 1:ncol(ratio)){
temp=str_replace(temp,paste0("D",j),as.character(round(ratio[i,j],3)))
}
temp
temp1=temp[str_detect(temp,"W")]
temp2=strGrouping(temp1,"W")$yes
slope[[i]]=paste0(temp2,collapse="+")
intercept[[i]]=paste0(temp[!str_detect(temp,"W")],collapse="+")
}
for(i in 1:length(fit$coef)){
assign(paste0("b",i-1),fit$coef[i])
}
slope
intercept
slope1=unlist(lapply(slope,function(x){eval(parse(text=x))}))
intercept1=unlist(lapply(intercept,function(x){eval(parse(text=x))}))
if(mode==3) {
slope1=c(slope1,(slope1[2]+slope1[3])/2)
intercept1=c(intercept1,(intercept1[2]+intercept1[3])/2)
}
df=data.frame(slope=slope1,intercept=intercept1)
df
if(add.label) {
df$label=paste0(sprintf("%0.3f",df$intercept),ifelse(df$slope>=0," + "," - "),
sprintf("%0.3f",abs(df$slope)),"*italic(W)")
} else{
df$label=""
}
df
getCatSlopeDf(labels=labels,yvar="M",data=protest,mode=3)
getCatSlopeDf(labels=labels,yvar="M",data=protest,mode=3,addvars=FALSE)
getCatSlopeDf(labels=labels,yvar="M",data=protest,mode=3)
getCatSlopeDf(labels=labels,yvar="M",data=protest,mode=1)
labels=list(X="protest",M="respappr",Y="liking",W="sexism")
data=protest;yvar="M";addvars=FALSE;mode=3;rangemode=2
maxylev=6;xpos=0.5
catlabels=NULL;add.slopelabel=FALSE
add.point=TRUE;add.vlines=TRUE;add.anova=TRUE;ypos=NULL
add.arrow=TRUE;hjust=NULL;ypos2=NULL;ceno=1;xinterval=NULL
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,
addvars=addvars,maxylev=6,mode=mode)
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,
addvars=TRUE,maxylev=6,mode=mode)
X=labels$X
W=labels$W
library(processR)
labels=list(X="protest",M="respappr",Y="liking",W="sexism")
data=protest;yvar="M";addvars=TRUE;mode=3;rangemode=2
maxylev=6;xpos=0.5
catlabels=NULL;add.slopelabel=FALSE
add.point=TRUE;add.vlines=TRUE;add.anova=TRUE;ypos=NULL
add.arrow=TRUE;hjust=NULL;ypos2=NULL;ceno=1;xinterval=NULL
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,
addvars=addvars,maxylev=6,mode=mode)
fit
X=labels$X
W=labels$W
Y=ifelse(yvar=="M",labels$M,labels$Y)
if(length(unique(data[[X]]))<=maxylev) catVar="X"
if(length(unique(data[[W]]))<=maxylev) catVar="W"
if(catVar=="W"){
W=labels$X
X=labels$W
}
slopeDf=getCatSlopeDf(labels=labels,data=data,yvar=yvar,total=total,addvars=addvars,
mode=mode,rangemode=rangemode,add.label=add.slopelabel,
maxylev=maxylev)
slopeDf
slopeDf[-nrow(slopeDf),]
slopeDf=slopeDf[-nrow(slopeDf),]
# slopeDf=slopeDf[-nrow(slopeDf),]
p<-ggplot(data=data,aes_string(x=W,y=Y))
p<-add_lines(p,slopeDf,add.coord.fixed=add.slopelabel,size=1,xpos=xpos,parse=TRUE)
p
library(ggplot2)
labels=list(X="protest",W="sexism",M="respappr",Y="liking")
catlabels=c("No protest","Individual protest","Collective protest")
catlabels2=c("No protest","Individual protest","Collective protest","Any protest")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=2)
labels=list(X="protest",M="respappr",Y="liking",W="sexism")
data=protest;yvar="M";addvars=TRUE;mode=3;rangemode=2
maxylev=6;xpos=0.5
catlabels=NULL;add.slopelabel=FALSE
add.point=TRUE;add.vlines=TRUE;add.anova=TRUE;ypos=NULL
add.arrow=TRUE;hjust=NULL;ypos2=NULL;ceno=1;xinterval=NULL
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,
addvars=addvars,maxylev=6,mode=mode)
X=labels$X
W=labels$W
labels=list(X="protest",M="respappr",Y="liking",W="sexism")
data=protest;yvar="M";addvars=TRUE;mode=3;rangemode=2
maxylev=6;xpos=0.5;total=FALSE
catlabels=NULL;add.slopelabel=FALSE
add.point=TRUE;add.vlines=TRUE;add.anova=TRUE;ypos=NULL
add.arrow=TRUE;hjust=NULL;ypos2=NULL;ceno=1;xinterval=NULL
fit=makeCatModel(labels=labels,data=data,yvar=yvar,total=total,
addvars=addvars,maxylev=6,mode=mode)
X=labels$X
W=labels$W
Y=ifelse(yvar=="M",labels$M,labels$Y)
if(length(unique(data[[X]]))<=maxylev) catVar="X"
if(length(unique(data[[W]]))<=maxylev) catVar="W"
if(catVar=="W"){
W=labels$X
X=labels$W
}
slopeDf=getCatSlopeDf(labels=labels,data=data,yvar=yvar,total=total,addvars=addvars,
mode=mode,rangemode=rangemode,add.label=add.slopelabel,
maxylev=maxylev)
# slopeDf=slopeDf[-nrow(slopeDf),]
p<-ggplot(data=data,aes_string(x=W,y=Y))
p<-add_lines(p,slopeDf,add.coord.fixed=add.slopelabel,size=1,xpos=xpos,parse=TRUE)
p
slopeDf=slopeDf[-nrow(slopeDf),]
p<-ggplot(data=data,aes_string(x=W,y=Y))
p<-add_lines(p,slopeDf,add.coord.fixed=add.slopelabel,size=1,xpos=xpos,parse=TRUE)
p
count=nrow(slopeDf)
x=quantile(data[[W]],probs=c(0.16,0.5,0.84),type=6)
df=data.frame(x=rep(x,count))
df$color=rep(1:count,each=3)
df
df$slope=slopeDf$slope[rep(1:count,each=3)]
df$intercept=slopeDf$intercept[rep(1:count,each=3)]
df$y=df$x*df$slope+df$intercept
df
info=getAspectRatio(p)
info
if(is.null(catlabels)) {
catlabels=paste0("D",0:(count-1))
}
df$group=rep(catlabels,each=3)
df$group1=reorder(df$group,df$color)
df$label=sprintf("%0.3f",df$y)
if(add.vlines){
if(catVar=="X"){
df2=data.frame(x=x,y=info$ymin,
label=paste0("W = ",sprintf("%0.3f",x)))
} else{
df2=data.frame(x=x,y=info$ymin,
label=paste0("X = ",sprintf("%0.3f",x)))
}
df2
p<-p+geom_vline(xintercept=x,lty=2,color="gray")+
geom_text(data=df2,aes_string(x="x",y="y",label="label"),family="Times",fontface="italic")
}
p
if(add.point){
p<-p+ geom_point(data=df,aes_string(x="x",y="y",color="group1"),size=2)+
geom_text_repel(data=df,aes_string(x="x",y="y",label="label",color="group1"),
box.padding=1)+
theme(legend.position="top",legend.title = element_blank())
}
require(ggrepel)
p
if(add.point){
p<-p+ geom_point(data=df,aes_string(x="x",y="y",color="group1"),size=2)+
geom_text_repel(data=df,aes_string(x="x",y="y",label="label",color="group1"),
box.padding=1)+
theme(legend.position="top",legend.title = element_blank())
}
p
if(add.anova){
df3=makeAnovaDf(labels=labels,data=data,yvar=yvar,total=total,addvars=addvars,
maxylev=maxylev,mode=mode,rangemode=rangemode)
df3
if(is.null(ypos)) ypos=c(0.2,0.2,0.2)
df3$ypos=info$ymin+(info$ymax-info$ymin)*ypos
#p<-p+geom_text(data=df3,aes(x=W,y=ypos,label=label),parse=TRUE)
p<-p+geom_text(data=df3,aes_string(x="W",y="ypos",label="label3"),family="Times",fontface="italic")
}
p
if(add.arrow){
if(is.null(xinterval)) {
info=getAspectRatio(p)
xinterval=(info$xmax-info$xmin)/30
}
df4 <-eval(parse(text="df %>% select(x,color,y) %>% spread(color,y)"))
colnames(df4)=c("x","y1","y2","y3")
if(1 %in% ceno){
# p<-p+geom_curve(data=df4,aes_string(x="x",y="y1",xend="x",yend="y2"),
#                 curvature=0.2,
#              arrow=arrow(length=unit(0.1,"inches"),angle=15,ends="last",type="closed"))
df4$x2=df4$x+xinterval
if(mode==1){
p<-p+geom_segment(data=df4,aes_string(x="x",y="y1",xend="x2",yend="y1"))+
geom_segment(data=df4,aes_string(x="x2",y="y1",xend="x2",yend="y2"))+
geom_segment(data=df4,aes_string(x="x2",y="y2",xend="x",yend="y2"),
arrow=arrow(length=unit(0.1,"inches"),
angle=15,ends="last",type="closed"))
} else if(mode==3){
df4$y4=(df4$y2+df4$y3)/2
p<-p+geom_segment(data=df4,aes_string(x="x",y="y1",xend="x2",yend="y1"))+
geom_segment(data=df4,aes_string(x="x2",y="y1",xend="x2",yend="y4"))+
geom_segment(data=df4,aes_string(x="x2",y="y4",xend="x",yend="y4"),
arrow=arrow(length=unit(0.1,"inches"),
angle=15,ends="last",type="closed"))
}
}
if(2 %in% ceno){
# p<-p+geom_curve(data=df4,aes_string(x="x",y="y1",xend="x",yend="y3"),
#                 curvature=0.2,
#                 arrow=arrow(length=unit(0.1,"inches"),angle=15,ends="last",type="closed"))
if(mode==1){
df4$x3=df4$x-xinterval
p<-p+geom_segment(data=df4,aes_string(x="x",y="y1",xend="x3",yend="y1"))+
geom_segment(data=df4,aes_string(x="x3",y="y1",xend="x3",yend="y3"))+
geom_segment(data=df4,aes_string(x="x3",y="y3",xend="x",yend="y3"),
arrow=arrow(length=unit(0.1,"inches"),
angle=15,ends="last",type="closed"))
} else if(mode==3){
df4$x3=df4$x-xinterval
p<-p+geom_segment(data=df4,aes_string(x="x",y="y2",xend="x3",yend="y2"))+
geom_segment(data=df4,aes_string(x="x3",y="y2",xend="x3",yend="y3"))+
geom_segment(data=df4,aes_string(x="x3",y="y3",xend="x",yend="y3"),
arrow=arrow(length=unit(0.1,"inches"),
angle=15,ends="last",type="closed"))
}
}
df5=makeCEDf(labels=labels,data=data,yvar=yvar,total=total,addvars=addvars,maxylev=maxylev,
mode=mode,rangemode=rangemode)
df5$y1=df4$y1
df5$y2=df4$y2
df5$y3=df4$y3
if(1 %in% ceno){
df5$label1=paste0("theta[italic(D[1]) %->% italic(",yvar,")] == ",sprintf("%0.3f",df5$d1))
if(mode==1){
df5$y=(df5$y1+df5$y2)/2
if(!is.null(ypos2)) df5$y= ifelse(df5$y1>df5$y2,df5$y2+(df5$y1-df5$y2)*ypos2,
df5$y1+(df5$y2-df5$y1)*ypos2)
} else if(mode==3){
df5$y4=df4$y4
df5$y=(df5$y1+df5$y4)/2
if(!is.null(ypos2)) df5$y= ifelse(df5$y1>df5$y4,df5$y4+(df5$y1-df5$y4)*ypos2,
df5$y1+(df5$y4-df5$y1)*ypos2)
}
df5$hjust1=-0.05
if(!is.null(hjust1)) df5$hjust1=hjust1
df5$W1=df5$W+xinterval
p<-p+geom_text(data=df5,aes_string(x="W1",y="y",label="label1",hjust="hjust1"),parse=TRUE)
}
if(2 %in% ceno){
df5$label2=paste0("theta[italic(D[2]) %->% italic(",yvar,")] == ",sprintf("%0.3f",df5$d2))
if(mode==1){
df5$y=(df5$y1+df5$y3)/2
if(!is.null(ypos2)) df5$y= ifelse(df5$y1>df5$y3,df5$y3+(df5$y1-df5$y3)*ypos2,
df5$y1+(df5$y3-df5$y1)*ypos2)
} else if(mode==3){
df5$y=(df5$y2+df5$y3)/2
if(!is.null(ypos3)) df5$y= ifelse(df5$y2>df5$y3,df5$y3+(df5$y2-df5$y3)*ypos3,
df5$y2+(df5$y3-df5$y2)*ypos3)
}
df5$hjust2=1.05
if(!is.null(hjust2)) df5$hjust2=hjust2
df5$W2=df5$W-xinterval
p<-p+geom_text(data=df5,aes_string(x="W2",y="y",label="label2",hjust="hjust2"),
parse=TRUE)
}
}
p
library(processR)
library(ggplot2)
labels=list(X="protest",W="sexism",M="respappr",Y="liking")
catlabels=c("No protest","Individual protest","Collective protest")
catlabels2=c("No protest","Individual protest","Collective protest","Any protest")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=2)
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=2)
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,catlabels=catlabels2,ceno=c(1,2))
condPlotCat(labels=labels,data=protest,catlabels=catlabels,add.slopelabel=TRUE,
xpos=c(0.3,0.7,0.7),add.point=FALSE,add.vlines=FALSE,add.anova=FALSE,add.arrow=FALSE)
condPlotCat(labels=labels,data=protest,catlabels=catlabels,add.anova=FALSE,add.arrow=FALSE)
condPlotCat(labels=labels,data=protest,catlabels=catlabels,add.anova=FALSE)+xlim(c(3.5,6.5))
condPlotCat(labels=labels,data=protest,add.anova=TRUE,ypos=c(0.2,0.2,0.5),add.arrow=FALSE)
condPlotCat(labels=labels,data=protest,catlabels=catlabels,add.anova=FALSE,ceno=1)
condPlotCat(labels=labels,data=protest,catlabels=catlabels,add.anova=FALSE,ceno=2)
condPlotCat(labels=labels,data=protest,total=TRUE,catlabels=catlabels,ypos=0.1,
add.arrow=FALSE)+xlim(c(4,6))
condPlotCat(labels=labels,data=protest,total=TRUE,catlabels=catlabels2,add.anova=FALSE,
ceno=c(1,2),xinterval=0.05,hjust1=c(-0.05,-0.05,1.05),hjust2=c(-0.05,1.05,1.05),
ypos2=c(0.5,0.1,0.3),ypos3=c(0.2,0.4,0.4),mode=3)+xlim(c(4,6))
library(processR)
library(ggplot2)
labels=list(X="protest",W="sexism",M="respappr",Y="liking")
catlabels=c("No protest","Individual protest","Collective protest")
catlabels2=c("No protest","Individual protest","Collective protest","Any protest")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=2)
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,add.arrow=FALSE)
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,add.arrow=FALSE,addvars=FALSE)
library(processR)
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=2)
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,add.arrow=FALSE,addvars=FALSE)
labels=list(X="protest",W="sexism",M="respappr",Y="liking")
catlabels=c("No protest","Individual protest","Collective protest")
catlabels2=c("No protest","Individual protest","Collective protest","Any protest")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=2)
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,add.arrow=FALSE,addvars=FALSE)
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=c(1,2))
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,add.arrow=FALSE,addvars=FALSE)
condPlotCat(labels=labels,catlabels=catlabels,yvar="M",data=protest,mode=3,add.arrow=FALSE,addvars=FALSE)
condPlotCat(labels=labels,catlabels=catlabels2,yvar="M",data=protest,mode=3,add.arrow=FALSE,addvars=FALSE)
condPlotCat(labels=labels,catlabels=catlabels,yvar="M",data=protest,mode=3,add.arrow=FALSE,addvars=FALSE)
condPlotCat(labels=labels,catlabels=catlabels,yvar="M",data=protest,mode=3,add.arrow=FALSE,addvars=FALSE)
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=c(1,2))
library(ggplot2)
labels=list(X="protest",W="sexism",M="respappr",Y="liking")
catlabels=c("No protest","Individual protest","Collective protest")
catlabels2=c("No protest","Individual protest","Collective protest","Any protest")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=c(1,2))
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ceno=c(1,2),add.vlines.text=FALSE)
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))+ylab("성차별인식")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))+xlab("성차별인식")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))+xlab("성차별인식")
condPlotCat(labels=labels,yvar="M",data=protest,mode=3,ypos=c(0.2,0.15,0.1))+xlab("성차별인식")+theme(text=element_text(family="NanumGothic"))
library(processR)
