attr(res,"modelNames")=modelNames
res
}
fit1=lm(affect~estress+ese+sex+tenure,data=estress)
fit2=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2)
res=modelsSummary(fit,labels=labels)
#' fit1=lm(mpg~wt,data=mtcars)
#' fit2=lm(mpg~wt*hp*am,data=mtcars)
#' fit=list(fit1,fit2)
#' labels=list(Y="mpg",X="wt",W="hp",Z="am")
#' modelsSummary(fit,labels=labels)
#' fit1=lm(affect~estress+ese+sex+tenure,data=estress)
#' fit2=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
#' labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
#' fit=list(fit1,fit2)
#' res=modelsSummary(fit,labels=labels)
modelsSummary=function(fit,labels=NULL,prefix="b",constant="iy",autoPrefix=TRUE){
# prefix="b";constant="iy";autoPrefix=TRUE
if("lm" %in%  class(fit)) fit=list(fit)
count=length(fit)
df<-coef<-list()
modelNames=c()
if(length(constant)==1) constant=rep(constant,count)
if(length(prefix)==1) prefix=rep(prefix,count)
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
if(autoPrefix &(!is.null(labels))) {
temp=names(fit[[i]]$model)[1]
temp1=changeLabelName(temp,labels,add=FALSE)
if(temp1=="M") {
constant[i]="im"
prefix[i]="a"
} else if(temp1=="Y"){
constant[i]="iy"
prefix[i]="c"
temp2=changeLabelName(rownames(df[[i]]),labels,add=FALSE)
if("M" %in% temp2){
prefix[i]="c'"
}
}
}
df
makeLabel=function(name,labels,constant,prefix){
result=c()
j<-k<-1
temp=changeLabelName(name,labels,add=FALSE)
temp
for(i in seq_along(temp)){
if(temp[i]=="(Intercept)") result=c(result,constant)
else if(temp[i]=="M") result=c(result,"b")
else if(substr(temp[i],1,1)=="C"){
if("M" %in% temp) {
result=c(result,"g",k)
} else{
result=c(result,"f",k)
}
k<-k+1
} else{
if("M" %in% temp) {
result=c(result,paste0("c'",j))
} else{
result=c(result,paste0(prefix,j))
}
j<-j+1
}
}
result
}
if(autoPrefix &(!is.null(labels))) {
df[[i]][[paste0("label",i)]]=makeLabel(rownames(df[[i]]),labels,constant[i],prefix[i])
} else{
df[[i]][[paste0("label",i)]]=c(constant[i],paste0(prefix[i],1:(nrow(df[[i]])-1)))
}
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])[1:5]
df[[i]]<-df[[i]] %>% select(starts_with("label"),everything())
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
if(!is.null(labels)) modelNames=changeLabelName(modelNames,labels,add=TRUE)
df
if(count==1){
mydf=df[[1]]
} else{
mydf<-reduce(df,full_join,by="name1")
}
mydf
mydf<-mydf %>% select("name1",everything())
rownames(mydf)=mydf[["name1"]]
mydf<-mydf[-1]
mydf[]=lapply(mydf,myformat)
mydf<-mydf[c(2:nrow(mydf),1),]
rownames(mydf)[nrow(mydf)]="Constant"
mydf
for(i in 1:count){
mydf[[5*i]]=pformat(mydf[[5*i]])
}
finalNames=rownames(mydf)
df2=data.frame(coef,stringsAsFactors = FALSE)
colnames(df2)=paste0("coef",1:ncol(df2))
finalNames=c(finalNames,c("Observations","R2","Adjusted R2","Residual SE","F statistic"))
res=full_join(mydf,df2,by=paste0("coef",1:count))
res[is.na(res)]=""
res
if(!is.null(labels)) finalNames=changeLabelName(finalNames,labels,add=TRUE)
rownames(res)=finalNames
res
class(res)=c("modelSummary","data.frame")
attr(res,"modelNames")=modelNames
res
}
fit1=lm(affect~estress+ese+sex+tenure,data=estress)
fit2=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2)
res=modelsSummary(fit,labels=labels)
#' fit1=lm(mpg~wt,data=mtcars)
#' fit2=lm(mpg~wt*hp*am,data=mtcars)
#' fit=list(fit1,fit2)
#' labels=list(Y="mpg",X="wt",W="hp",Z="am")
#' modelsSummary(fit,labels=labels)
#' fit1=lm(affect~estress+ese+sex+tenure,data=estress)
#' fit2=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
#' labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
#' fit=list(fit1,fit2)
#' res=modelsSummary(fit,labels=labels)
modelsSummary=function(fit,labels=NULL,prefix="b",constant="iy",autoPrefix=TRUE){
# prefix="b";constant="iy";autoPrefix=TRUE
if("lm" %in%  class(fit)) fit=list(fit)
count=length(fit)
df<-coef<-list()
modelNames=c()
if(length(constant)==1) constant=rep(constant,count)
if(length(prefix)==1) prefix=rep(prefix,count)
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
if(autoPrefix &(!is.null(labels))) {
temp=names(fit[[i]]$model)[1]
temp1=changeLabelName(temp,labels,add=FALSE)
if(temp1=="M") {
constant[i]="im"
prefix[i]="a"
} else if(temp1=="Y"){
constant[i]="iy"
prefix[i]="c"
temp2=changeLabelName(rownames(df[[i]]),labels,add=FALSE)
if("M" %in% temp2){
prefix[i]="c'"
}
}
}
df
makeLabel=function(name,labels,constant,prefix){
result=c()
j<-k<-1
temp=changeLabelName(name,labels,add=FALSE)
temp
for(i in seq_along(temp)){
if(temp[i]=="(Intercept)") result=c(result,constant)
else if(temp[i]=="M") result=c(result,"b")
else if(substr(temp[i],1,1)=="C"){
if("M" %in% temp) {
result=c(result,paste0("g",k))
} else{
result=c(result,paste0("f",k))
}
k<-k+1
} else{
if("M" %in% temp) {
result=c(result,paste0("c'",j))
} else{
result=c(result,paste0(prefix,j))
}
j<-j+1
}
}
result
}
if(autoPrefix &(!is.null(labels))) {
df[[i]][[paste0("label",i)]]=makeLabel(rownames(df[[i]]),labels,constant[i],prefix[i])
} else{
df[[i]][[paste0("label",i)]]=c(constant[i],paste0(prefix[i],1:(nrow(df[[i]])-1)))
}
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])[1:5]
df[[i]]<-df[[i]] %>% select(starts_with("label"),everything())
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
if(!is.null(labels)) modelNames=changeLabelName(modelNames,labels,add=TRUE)
df
if(count==1){
mydf=df[[1]]
} else{
mydf<-reduce(df,full_join,by="name1")
}
mydf
mydf<-mydf %>% select("name1",everything())
rownames(mydf)=mydf[["name1"]]
mydf<-mydf[-1]
mydf[]=lapply(mydf,myformat)
mydf<-mydf[c(2:nrow(mydf),1),]
rownames(mydf)[nrow(mydf)]="Constant"
mydf
for(i in 1:count){
mydf[[5*i]]=pformat(mydf[[5*i]])
}
finalNames=rownames(mydf)
df2=data.frame(coef,stringsAsFactors = FALSE)
colnames(df2)=paste0("coef",1:ncol(df2))
finalNames=c(finalNames,c("Observations","R2","Adjusted R2","Residual SE","F statistic"))
res=full_join(mydf,df2,by=paste0("coef",1:count))
res[is.na(res)]=""
res
if(!is.null(labels)) finalNames=changeLabelName(finalNames,labels,add=TRUE)
rownames(res)=finalNames
res
class(res)=c("modelSummary","data.frame")
attr(res,"modelNames")=modelNames
res
}
fit1=lm(affect~estress+ese+sex+tenure,data=estress)
fit2=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2)
res=modelsSummary(fit,labels=labels)
library(processR)
fit1=lm(affect~estress+ese+sex+tenure,data=estress)
fit2=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2)
res=modelsSummary(fit,labels=labels)
modelsSummary(fit,labels=labels)
modelsSummary(fit,labels=labels)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
#' fit2=lm(mpg~wt*hp*am,data=mtcars)
#' fit=list(fit1,fit2)
#' labels=list(Y="mpg",X="wt",W="hp",Z="am")
#' modelsSummary(fit,labels=labels)
#' fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
#' fit2=lm(affect~estress+ese+sex+tenure,data=estress)
#' fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
#' labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
#' fit=list(fit1,fit2,fit3)
#' modelsSummary(fit,labels=labels)
modelsSummary=function(fit,labels=NULL,prefix="b",constant="iy",autoPrefix=TRUE){
# prefix="b";constant="iy";autoPrefix=TRUE
if("lm" %in%  class(fit)) fit=list(fit)
count=length(fit)
df<-coef<-list()
modelNames=c()
if(length(constant)==1) constant=rep(constant,count)
if(length(prefix)==1) prefix=rep(prefix,count)
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
if(autoPrefix &(!is.null(labels))) {
temp=names(fit[[i]]$model)[1]
temp1=changeLabelName(temp,labels,add=FALSE)
if(temp1=="M") {
constant[i]="im"
prefix[i]="a"
} else if(temp1=="Y"){
constant[i]="iy"
prefix[i]="c"
temp2=changeLabelName(rownames(df[[i]]),labels,add=FALSE)
if("M" %in% temp2){
prefix[i]="c'"
}
}
}
df
makeLabel=function(name,labels,constant,prefix){
result=c()
j<-k<-1
temp=changeLabelName(name,labels,add=FALSE)
temp
for(i in seq_along(temp)){
if(temp[i]=="(Intercept)") result=c(result,constant)
else if(temp[i]=="M") result=c(result,"b")
else if(substr(temp[i],1,1)=="C"){
if("M" %in% temp) {
result=c(result,paste0("f",k))
} else{
result=c(result,paste0("g",k))
}
k<-k+1
} else{
if("M" %in% temp) {
result=c(result,paste0("c'",j))
} else{
result=c(result,paste0(prefix,j))
}
j<-j+1
}
}
result
}
if(autoPrefix &(!is.null(labels))) {
df[[i]][[paste0("label",i)]]=makeLabel(rownames(df[[i]]),labels,constant[i],prefix[i])
} else{
df[[i]][[paste0("label",i)]]=c(constant[i],paste0(prefix[i],1:(nrow(df[[i]])-1)))
}
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])[1:5]
df[[i]]<-df[[i]] %>% select(starts_with("label"),everything())
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
if(!is.null(labels)) modelNames=changeLabelName(modelNames,labels,add=TRUE)
df
if(count==1){
mydf=df[[1]]
} else{
mydf<-reduce(df,full_join,by="name1")
}
mydf
mydf<-mydf %>% select("name1",everything())
rownames(mydf)=mydf[["name1"]]
mydf<-mydf[-1]
mydf[]=lapply(mydf,myformat)
mydf<-mydf[c(2:nrow(mydf),1),]
rownames(mydf)[nrow(mydf)]="Constant"
mydf
for(i in 1:count){
mydf[[5*i]]=pformat(mydf[[5*i]])
}
finalNames=rownames(mydf)
df2=data.frame(coef,stringsAsFactors = FALSE)
colnames(df2)=paste0("coef",1:ncol(df2))
finalNames=c(finalNames,c("Observations","R2","Adjusted R2","Residual SE","F statistic"))
res=full_join(mydf,df2,by=paste0("coef",1:count))
res[is.na(res)]=""
res
if(!is.null(labels)) finalNames=changeLabelName(finalNames,labels,add=TRUE)
rownames(res)=finalNames
res
class(res)=c("modelSummary","data.frame")
attr(res,"modelNames")=modelNames
res
}
modelsSummary(fit,labels=labels)
library(processR)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
library(processR)
modelsSummary(fit,labels=labels)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
library(processR)
#' fit2=lm(mpg~wt*hp*am,data=mtcars)
#' fit=list(fit1,fit2)
#' labels=list(Y="mpg",X="wt",W="hp",Z="am")
#' modelsSummary(fit,labels=labels)
#' fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
#' fit2=lm(affect~estress+ese+sex+tenure,data=estress)
#' fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
#' labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
#' fit=list(fit1,fit2,fit3)
#' modelsSummary(fit,labels=labels)
modelsSummary=function(fit,labels=NULL,prefix="b",constant="iy",autoPrefix=TRUE){
# prefix="b";constant="iy";autoPrefix=TRUE
if("lm" %in%  class(fit)) fit=list(fit)
count=length(fit)
df<-coef<-list()
modelNames=c()
if(length(constant)==1) constant=rep(constant,count)
if(length(prefix)==1) prefix=rep(prefix,count)
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
if(autoPrefix &(!is.null(labels))) {
temp=names(fit[[i]]$model)[1]
temp1=changeLabelName(temp,labels,add=FALSE)
if(temp1=="M") {
constant[i]="im"
prefix[i]="a"
} else if(temp1=="Y"){
constant[i]="iy"
prefix[i]="c"
temp2=changeLabelName(rownames(df[[i]]),labels,add=FALSE)
if("M" %in% temp2){
prefix[i]="c'"
}
}
}
df
makeLabel=function(name,labels,constant,prefix){
result=c()
j<-k<-1
temp=changeLabelName(name,labels,add=FALSE)
temp
for(i in seq_along(temp)){
if(temp[i]=="(Intercept)") result=c(result,constant)
else if(temp[i]=="M") result=c(result,"b")
else if(substr(temp[i],1,1)=="C"){
if("M" %in% temp) {
result=c(result,paste0("g",k))
} else{
result=c(result,paste0("f",k))
}
k<-k+1
} else{
if("M" %in% temp) {
result=c(result,paste0("c'",j))
} else{
result=c(result,paste0(prefix,j))
}
j<-j+1
}
}
result
}
if(autoPrefix &(!is.null(labels))) {
df[[i]][[paste0("label",i)]]=makeLabel(rownames(df[[i]]),labels,constant[i],prefix[i])
} else{
df[[i]][[paste0("label",i)]]=c(constant[i],paste0(prefix[i],1:(nrow(df[[i]])-1)))
}
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])[1:5]
df[[i]]<-df[[i]] %>% select(starts_with("label"),everything())
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
if(!is.null(labels)) modelNames=changeLabelName(modelNames,labels,add=TRUE)
df
if(count==1){
mydf=df[[1]]
} else{
mydf<-reduce(df,full_join,by="name1")
}
mydf
mydf<-mydf %>% select("name1",everything())
rownames(mydf)=mydf[["name1"]]
mydf<-mydf[-1]
mydf[]=lapply(mydf,myformat)
mydf<-mydf[c(2:nrow(mydf),1),]
rownames(mydf)[nrow(mydf)]="Constant"
mydf
for(i in 1:count){
mydf[[5*i]]=pformat(mydf[[5*i]])
}
finalNames=rownames(mydf)
df2=data.frame(coef,stringsAsFactors = FALSE)
colnames(df2)=paste0("coef",1:ncol(df2))
finalNames=c(finalNames,c("Observations","R2","Adjusted R2","Residual SE","F statistic"))
res=full_join(mydf,df2,by=paste0("coef",1:count))
res[is.na(res)]=""
res
if(!is.null(labels)) finalNames=changeLabelName(finalNames,labels,add=TRUE)
rownames(res)=finalNames
res
class(res)=c("modelSummary","data.frame")
attr(res,"modelNames")=modelNames
res
}
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
library(processR)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
library(processR)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp*am,data=mtcars)
fit=list(fit1,fit2)
labels=list(Y="mpg",X="wt",W="hp",Z="am")
modelsSummary(fit,labels=labels)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
library(processR)
library(processR)
fit1=lm(withdraw~estress+ese+sex+tenure,data=estress)
fit2=lm(affect~estress+ese+sex+tenure,data=estress)
fit3=lm(withdraw~estress+affect+ese+sex+tenure,data=estress)
labels=list(Y="withdraw",M="affect",X="estress",C1="ese",C2="sex",C3="tenure")
fit=list(fit1,fit2,fit3)
modelsSummary(fit,labels=labels)
