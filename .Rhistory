vars=list(name=list(c("W","Z")),site=list(c("a")),arr.pos=list(c(0.5)))
multipleMediation(labels=labels,vars=vars,serial=TRUE,mode=1)
drawConcept(labels=labels,vars=vars,nodemode=2)
drawModel(labels=labels,vars=vars)
labels=list(X="X",M="M",Y="Y")
vars=list(name=list(c("W","Z")),site=list(c("b")),arr.pos=list(c(0.5)))
drawConcept(labels=labels,vars=vars,nodemode=2)
labels=list(X="X",M="M",Y="Y")
vars=list(name=list(c("W","Z")),site=list(c("b")),arr.pos=list(c(0.5)))
vars=list(name=list(c("W","Z")),site=list(c("b")),arr.pos=list(c(0.5)),pos=2)
labels=list(X="X",M="M",Y="Y")
vars=list(name=list(c("W","Z")),site=list(c("b")),arr.pos=list(c(0.5)),pos=2)
drawConcept(labels=labels,vars=vars,nodemode=2)
drawModel(labels=labels,vars=vars)
labels=list(X="X",M="M",Y="Y")
vars=list(name=list(c("W","Z")),site=list(c("c")),arr.pos=list(c(0.5)),pos=2)
drawConcept(labels=labels,vars=vars,nodemode=2)
drawModel(labels=labels,vars=vars)
labels=list(X="X",M=c("M1","M2"),Y="Y")
drawConcept(labels=labels,nodemode=2)
drawConcept(labels=labels,serial=TRUE,nodemode=2)
drawModel(labels=labels,vars=vars)
drawModel(labels=labels)
labels=list(X="X",M=c("M1","M2"),Y="Y")
drawConcept(labels=labels,serial=TRUE,nodemode=2)
drawModel(labels=labels)
drawModel(labels=labels,serial=FALSE)
drawModel(labels=labels)
labels=list(X="X",M=c("M1","M2"),Y="Y")
drawConcept(labels=labels,serial=TRUE,nodemode=2)
labels=list(X="X",M=c("M1","M2"),Y="Y")
drawConcept(labels=labels,serial=TRUE,nodemode=2)
drawModel(labels=labels)
library(processR)
labels=list(X="X",M=c("M1","M2"),Y="Y")
drawModel(labels=labels)
drawConcept(labels=labels,serial=TRUE,nodemode=2)
drawModel(labels=labels)
library(processR)
drawModel(labels=labels)
moderator=list();serial=FALSE;eq=NULL
labels=list(X="X",M=c("M1","M2"),Y="Y")
vars=list(name=list(c("W","Z")),site=list("a"),arr.pos=list(c(0.5)))
covar=NULL;vars=list()
eq=multipleMediation(labels=labels,vars=vars,moderator=moderator,covar=covar,mode=1,serial=serial)
eq
labels
if(!is.null(covar)){
for(i in seq_along(covar$name)){
labels[[paste0("C",i)]]=covar$name[i]
}
}
df=equations2var(eq,labels=labels)
df
library(processR)
labels=list(X="X",M=c("M1","M2"),Y="Y")
labels2table(labels,serial=TRUE)
labels=list(X="X",M=c("M1","M2"),Y="Y")
labels2table(labels,serial=TRUE)
labels2table(labels,serial=FALSE)
labels2table(labels)
labels2table(labels,covar=covar)
labels2table(labels)
labels2table(labels,serial=FALSE)
eq=multipleMediation(labels=labels,vars=vars,moderator=moderator,covar=covar,mode=1,serial=TRUE)
eq=multipleMediation(labels=labels,mode=1,serial=TRUE)
eq
eq=multipleMediation(labels=labels,mode=1,serial=FALSE)
eq
labels=list(X="X",M=c("M1","M2"),Y="Y")
labels=list(X="X",M=c("M1","M2"),Y="Y")
cat(multipleMediation(labels=labels,serial=TRUE))
cat(multipleMediation(labels=labels,serial=TRUE,mode=1))
cat(multipleMediation(labels=labels,serial=TRUE))
X=NULL;M=NULL;Y=NULL;labels=list(X="X",M=c("M1","M2"),Y="Y");data=NULL
vars=list()
moderator=list()
covar=NULL
mode=1;range=TRUE;rangemode=1;serial=TRUE;contrast=1;
bmatrix=NULL
if(is.null(X)) X=labels$X
if(is.null(M)) if(!is.null(labels$M)) M=labels$M
if(is.null(Y)) Y=labels$Y
interactionNo=0
res=c()
xcount=length(X)
if(!is.null(M)) {
mcount=length(M)
} else{
mcount=0
}
ycount=length(Y)
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
if(serial){
if(mcount>0){
if(is.null(bmatrix)) bmatrix=rep(1,sum(1:(mcount+1)))
}
}
# moderator=list(name=c("vs"),site=list(c("b1","b2")))
# name="vs"
# prefix="b"
# moderator
# name=MY
# name
# prefix="b"
mod2pos=function(moderator,name,prefix){
pos=list()
pos1=c()
# i=1
for(i in seq_along(name)) {
pos1=grep(name[i],moderator$name)
pos1
if(length(pos1)==1){
temp=moderator$site[[pos1]]
temp1=temp[str_detect(temp,prefix)]
temp1
res=str_extract(temp1,"[0-9]")
res
if(length(res)==1){
if(is.na(res)){
pos[[i]]=NULL
} else {
pos[[i]]=as.numeric(res)
}
} else{
pos[[i]]=as.numeric(res)
}
}
}
pos
}
pos=mod2pos(moderator,name=XM,prefix="a")
pos
if(is.null(bmatrix)){
eq1=makeCatEquation2(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,serial=serial)
} else{
eq1=makeCatEquation3(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,bmatrix=bmatrix,
vars=vars,moderator=moderator,depy=FALSE,
interactionNo=interactionNo)
}
# maxylev
eq1
XM
pos=mod2pos(moderator,name=XM,prefix="a")
pos
cat(makeCatEquation2(X="X",Y=c("M1","M2"),W=NULL,prefix="a",serial=TRUE))
cat(makeCatEquation2(X="X",Y=c("M1","M2"),W=NULL,prefix="a",mode=1,serial=TRUE))
cat(makeCatEquation2(X="X",Y=c("M1","M2"),prefix="a",mode=1,serial=TRUE))
labels=list(X="X",M=c("M1","M2"),Y="Y")
cat(multipleMediation(labels=labels,serial=TRUE))
cat(multipleMediation(labels=labels,serial=TRUE,mode=1))
X=NULL;M=NULL;Y=NULL;labels=list(X="X",M=c("M1","M2"),Y="Y");data=NULL
vars=list()
moderator=list()
covar=NULL
mode=1;range=TRUE;rangemode=1;serial=TRUE;contrast=1;
bmatrix=NULL
if(is.null(X)) X=labels$X
if(is.null(M)) if(!is.null(labels$M)) M=labels$M
if(is.null(Y)) Y=labels$Y
interactionNo=0
res=c()
xcount=length(X)
if(!is.null(M)) {
mcount=length(M)
} else{
mcount=0
}
ycount=length(Y)
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
if(serial){
if(mcount>0){
if(is.null(bmatrix)) bmatrix=rep(1,sum(1:(mcount+1)))
}
}
# moderator=list(name=c("vs"),site=list(c("b1","b2")))
# name="vs"
# prefix="b"
# moderator
# name=MY
# name
# prefix="b"
mod2pos=function(moderator,name,prefix){
pos=list()
pos1=c()
# i=1
for(i in seq_along(name)) {
pos1=grep(name[i],moderator$name)
pos1
if(length(pos1)==1){
temp=moderator$site[[pos1]]
temp1=temp[str_detect(temp,prefix)]
temp1
res=str_extract(temp1,"[0-9]")
res
if(length(res)==1){
if(is.na(res)){
pos[[i]]=NULL
} else {
pos[[i]]=as.numeric(res)
}
} else{
pos[[i]]=as.numeric(res)
}
}
}
pos
}
pos=mod2pos(moderator,name=XM,prefix="a")
pos
eq1=makeCatEquation2(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,serial=serial)
# maxylev
eq1
interactionNo=str_count(eq1,"interaction")
#
covar
if(!is.null(covar)){
covar$site=lapply(covar$site,function(x) str_replace(x,"Mi|M",M))
if(mode){
eq1=addCovarEquation(eq1,covar,prefix=NULL)
} else{
eq1=addCovarEquation(eq1,covar,prefix="f")
}
}
eq1
temp1=unlist(strsplit(eq1,"\n"))
temp1=lapply(1:length(temp1),function(i){
unlist(strsplit(unlist(strsplit(temp1[i],"~",fixed=TRUE))[2],"+",fixed=TRUE))
})
temp1
# moderator
# MY
pos=mod2pos(moderator,name=MY,prefix="b")
pos
if(is.null(bmatrix)){
eq2=makeCatEquation2(X=M,Y=Y,W=MY,prefix="b",mode=mode,pos=pos)
} else{
eq2=makeCatEquation3(X=M,Y=Y,W=MY,prefix="b",mode=mode,pos=pos,bmatrix=bmatrix,
vars=vars,moderator=moderator,depy=TRUE,
interactionNo=interactionNo)
interactionNo=interactionNo+str_count(eq2,"interaction")
}
require(stringr)
(
(
if(is.null(bmatrix)){
eq2=makeCatEquation2(X=M,Y=Y,W=MY,prefix="b",mode=mode,pos=pos)
} else{
eq2=makeCatEquation3(X=M,Y=Y,W=MY,prefix="b",mode=mode,pos=pos,bmatrix=bmatrix,
vars=vars,moderator=moderator,depy=TRUE,
interactionNo=interactionNo)
interactionNo=interactionNo+str_count(eq2,"interaction")
}
eq2
# eq2
# M
# Y
# MY
# pos
# bmatrix
temp2=unlist(strsplit(eq2,"~"))[2]
temp2=unlist(strsplit(temp2,"+",fixed=TRUE))
temp2
pos=mod2pos(moderator,name=XY,prefix="c")
library(processR)
labels=list(X="X",M=c("M1","M2"),Y="Y")
cat(multipleMediation(labels=labels,serial=TRUE,mode=1))
X=NULL;M=NULL;Y=NULL;labels=list(X="X",M=c("M1","M2"),Y="Y");data=NULL
vars=list()
moderator=list()
covar=NULL
mode=1;range=TRUE;rangemode=1;serial=TRUE;contrast=1;
bmatrix=NULL
if(is.null(X)) X=labels$X
if(is.null(M)) if(!is.null(labels$M)) M=labels$M
if(is.null(Y)) Y=labels$Y
interactionNo=0
res=c()
xcount=length(X)
if(!is.null(M)) {
mcount=length(M)
} else{
mcount=0
}
ycount=length(Y)
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
if(serial){
if(mcount>0){
if(is.null(bmatrix)) bmatrix=rep(1,sum(1:(mcount+1)))
}
}
# moderator=list(name=c("vs"),site=list(c("b1","b2")))
# name="vs"
# prefix="b"
# moderator
# name=MY
# name
# prefix="b"
mod2pos=function(moderator,name,prefix){
pos=list()
pos1=c()
# i=1
for(i in seq_along(name)) {
pos1=grep(name[i],moderator$name)
pos1
if(length(pos1)==1){
temp=moderator$site[[pos1]]
temp1=temp[str_detect(temp,prefix)]
temp1
res=str_extract(temp1,"[0-9]")
res
if(length(res)==1){
if(is.na(res)){
pos[[i]]=NULL
} else {
pos[[i]]=as.numeric(res)
}
} else{
pos[[i]]=as.numeric(res)
}
}
}
pos
}
if(!is.null(M)){
# moderator=list(name=c("W1","W2"),site=list(c("a1","b1"),"a1"))
# moderator=list(name=c("W1","W2"),site=list(c("a"),"a1"))
# name=c("W1","W2")
# prefix="a"
pos=mod2pos(moderator,name=XM,prefix="a")
pos
if(is.null(bmatrix)){
eq1=makeCatEquation2(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,serial=serial)
} else{
eq1=makeCatEquation3(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,bmatrix=bmatrix,
vars=vars,moderator=moderator,depy=FALSE,
interactionNo=interactionNo)
}
# maxylev
eq1
interactionNo=str_count(eq1,"interaction")
#
covar
if(!is.null(covar)){
covar$site=lapply(covar$site,function(x) str_replace(x,"Mi|M",M))
if(mode){
eq1=addCovarEquation(eq1,covar,prefix=NULL)
} else{
eq1=addCovarEquation(eq1,covar,prefix="f")
}
}
eq1
temp1=unlist(strsplit(eq1,"\n"))
temp1=lapply(1:length(temp1),function(i){
unlist(strsplit(unlist(strsplit(temp1[i],"~",fixed=TRUE))[2],"+",fixed=TRUE))
})
temp1
# moderator
# MY
pos=mod2pos(moderator,name=MY,prefix="b")
pos
if(is.null(bmatrix)){
eq2=makeCatEquation2(X=M,Y=Y,W=MY,prefix="b",mode=mode,pos=pos)
} else{
eq2=makeCatEquation3(X=M,Y=Y,W=MY,prefix="b",mode=mode,pos=pos,bmatrix=bmatrix,
vars=vars,moderator=moderator,depy=TRUE,
interactionNo=interactionNo)
interactionNo=interactionNo+str_count(eq2,"interaction")
}
# eq2
# M
# Y
# MY
# pos
# bmatrix
temp2=unlist(strsplit(eq2,"~"))[2]
temp2=unlist(strsplit(temp2,"+",fixed=TRUE))
temp2
}
pos=mod2pos(moderator,name=XY,prefix="c")
if(is.null(bmatrix)){
eq3=makeCatEquation2(X=X,Y=Y,W=XY,prefix="c",mode=mode,pos=pos,serial=serial)
} else{
eq3=makeCatEquation3(X=X,Y=Y,W=XY,prefix="c",mode=mode,pos=pos,bmatrix=bmatrix,
vars=vars,moderator=moderator,depy=TRUE,depx=TRUE,
interactionNo=interactionNo)
}
eq3
# bmatrix
if(str_detect(eq3,"~")){
temp3=unlist(strsplit(eq3,"~"))[2]
temp3
temp3=unlist(strsplit(temp3,"+",fixed=TRUE))
} else{
temp3=""
}
if(is.null(M)) {
eq=eq3
} else{
if(eq3!="") {
if(eq2=="") {
eq=eq3
} else{
eq=sumEquation(eq2,eq3)
}
} else{
eq=eq2
}
}
eq
if(!is.null(covar)){
covar$site=lapply(covar$site,function(x) str_replace(x,"Y",Y))
if(mode){
eq=addCovarEquation(eq,covar,prefix=NULL,grouplabels=NULL)
} else{
eq=addCovarEquation(eq,covar,prefix="g",grouplabels=NULL)
}
}
equation=ifelse(is.null(M),eq,paste(eq1,eq,sep="\n"))
equation
X=NULL;M=NULL;Y=NULL;labels=list(X="X",M=c("M1","M2"),Y="Y");data=NULL
vars=list()
moderator=list()
covar=NULL
mode=1;range=TRUE;rangemode=1;serial=TRUE;contrast=1;
bmatrix=NULL
if(is.null(X)) X=labels$X
if(is.null(M)) if(!is.null(labels$M)) M=labels$M
if(is.null(Y)) Y=labels$Y
interactionNo=0
res=c()
xcount=length(X)
if(!is.null(M)) {
mcount=length(M)
} else{
mcount=0
}
ycount=length(Y)
(XM=moderator$name[str_detect2(moderator$site,"a")])
(MY=moderator$name[str_detect2(moderator$site,"b")])
(XY=moderator$name[str_detect2(moderator$site,"c")])
if(serial){
if(mcount>0){
if(is.null(bmatrix)) bmatrix=rep(1,sum(1:(mcount+1)))
}
}
# moderator=list(name=c("vs"),site=list(c("b1","b2")))
# name="vs"
# prefix="b"
# moderator
# name=MY
# name
# prefix="b"
mod2pos=function(moderator,name,prefix){
pos=list()
pos1=c()
# i=1
for(i in seq_along(name)) {
pos1=grep(name[i],moderator$name)
pos1
if(length(pos1)==1){
temp=moderator$site[[pos1]]
temp1=temp[str_detect(temp,prefix)]
temp1
res=str_extract(temp1,"[0-9]")
res
if(length(res)==1){
if(is.na(res)){
pos[[i]]=NULL
} else {
pos[[i]]=as.numeric(res)
}
} else{
pos[[i]]=as.numeric(res)
}
}
}
pos
}
pos=mod2pos(moderator,name=XM,prefix="a")
pos
if(is.null(bmatrix)){
eq1=makeCatEquation2(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,serial=serial)
} else{
eq1=makeCatEquation3(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,bmatrix=bmatrix,
vars=vars,moderator=moderator,depy=FALSE,
interactionNo=interactionNo)
}
# maxylev
eq1
eq1=makeCatEquation2(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,serial=serial)
# maxylev
eq1
eq1=makeCatEquation3(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,bmatrix=bmatrix,
vars=vars,moderator=moderator,depy=FALSE,
interactionNo=interactionNo)
# maxylev
eq1
eq1=makeCatEquation3(X=X,Y=M,W=XM,prefix="a",mode=mode,pos=pos,bmatrix=bmatrix,
vars=vars,moderator=moderator,depy=FALSE,
interactionNo=interactionNo)
# maxylev
eq1
library(processR)
devtools::document()
devtools::check()
