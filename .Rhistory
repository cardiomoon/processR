add_header_row(values=c("","Moderation Effect"),colwidth=c(1,3)) %>%
width(j=3,width=2) %>%
align(i=1:2,align="center",part="header") %>%
add_footer_lines(paste0("boot.ci.type=",attr(x,"boot.ci.type"))) %>%
align(align="right",part="footer") %>%
fontsize(size=12,part="all") %>%
hline(part="header",i=2,j=2:4,border=fp_border(color="black",width=1)) %>%
hline_top(part="header",border=fp_border(color="black",width=2))
devtools::document()
devtools::check()
library(processR)
require(lavaan)
require(lavaan)
labels=list(X="frame",W="skeptic",Y="justify")
moderator=list(name='skeptic',site=list("c"))
model=tripleEquation(labels=labels,moderator=moderator,data=disaster,rangemode=2)
semfit=sem(model=model,data=disaster,se="boot",bootstrap=10)
modSummary(semfit,mod="skeptic")
modSummaryTable(semfit,mod="skeptic")
devtools::document()
library(processR)
require(lavaan)
labels=list(X="frame",W="skeptic",Y="justify")
moderator=list(name='skeptic',site=list("c"))
model=tripleEquation(labels=labels,moderator=moderator,data=disaster,rangemode=2)
semfit=sem(model=model,data=disaster,se="boot",bootstrap=10)
modSummary(semfit,mod="skeptic")
modSummaryTable(semfit,mod="skeptic")
devtools::check()
require(lavaan)
labels=list(X="frame",W="skeptic",Y="justify")
moderator=list(name='skeptic',site=list("c"))
model=tripleEquation(labels=labels,moderator=moderator,data=disaster,rangemode=2)
semfit=sem(model=model,data=disaster,se="boot",bootstrap=10)
modSummary(semfit,mod="skeptic")
modSummaryTable(semfit,mod="skeptic")
system("grep -r 'donttest' *")
require(lavaan)
labels=list(X="frame",W="skeptic",Y="justify")
moderator=list(name='skeptic',site=list("c"))
model=tripleEquation(labels=labels,moderator=moderator,data=disaster,rangemode=2)
semfit=sem(model=model,data=disaster,se="boot",bootstrap=10)
modSummary(semfit,mod="skeptic")
modSummaryTable(semfit,mod="skeptic")
devtools::docuemnt()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
install.packages("bda")
install.packages("interactions")
library(processR)
library(processR)
devtools::document()
devtools::check()
library(processR)
library(processR)
library(processR)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,xmode=2,hjust=c(-0.1,-0.1,1.1))
library(processR)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,xmode=2,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=2,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1),xpos=0.5)
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70),xpos=0.2)
condPlot(fit,xmode=2,mode=3,xpos=0.5,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=2,modx.values=c(2,3,4),mode=3,xpos=0.6)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5)
condPlot(fit,xmode=2)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70),xpos=0.2)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,xmode=2,mode=2)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
fit1=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
modSummary2(fit1)
system("grep -r 'calEquation' *")
predict3d::calEquation
ggPredict(fit1)
predict3d::ggPredict(fit1)
predict3d::ggPredict(fit1,pred=negemot,modx=age)
predict3d::ggPredict(fit1,pred=negemot,modx=age,show.point = FALSE,modx.values = c(30,50,70))
library(processR)
condPlot(fit1)
condPlot(fit1,xmode=2,pred.values = c(30,50,70))
condPlot(fit1,xmode=2,mode=2,pred.values = c(30,50,70))
library(processR)
devtools::document()
devtools::check()
library(processR)
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
condPlot2(fit)
condPlot2(fit,mod2.values = c(30,50,70))
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit)
require(predict3d)
ggPredict(fit,pred=negemot,modx=sex,mod2=age)
library(processR)
devtools::docuemnt()
devtools::document()
library(processR)
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
ggPredict(fit,pred=negemot,modx=sex,mod2=age)
ggPredict(fit,pred="negemot",modx="sex",mod2="age")
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
ggPredict(fit,pred="negemot",modx="sex",mod2="age")
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
names(fit$model)
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
pred="negemot";modx="sex"; mod2=NULL;mod2.values = c(30,50,70);rangemode=1;digits=3
# fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
# pred="negemot";modx="sex"; mod2=NULL;mod2.values = c(30,50,70);rangemode=1;digits=3
if(is.null(pred)) pred=names(fit$model)[2]
if(is.null(modx)) modx=names(fit$model)[3]
if(is.null(mod2)) mod2=names(fit$model)[4]
if(is.null(mod2.values)){
if(rangemode==1){
mod2.values=mean(fit$model[[mod2]],na.rm=TRUE)+c(-1,0,1)*sd(fit$model[[mod2]],na.rm=TRUE)
mod2.values=round(mod2.values,digits)
} else{
mod2.values=quantile(fit$model[[mod2]],probs=c(0.16,0.5,0.84),type=6)
mod2.values=round(mod2.values,digits)
}
}
vjust=rep(c(-0.5,1.5),each=length(mod2.values))
res=ggPredict(fit,pred=pred,modx=modx,mod2=mod2,show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits,plot=FALSE)
pred
modx
mod2
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
pred="negemot";modx="sex"; mod2="age";mod2.values = c(30,50,70);rangemode=1;digits=3
# fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
# pred="negemot";modx="sex"; mod2="age";mod2.values = c(30,50,70);rangemode=1;digits=3
if(is.null(pred)) pred=names(fit$model)[2]
if(is.null(modx)) modx=names(fit$model)[3]
if(is.null(mod2)) mod2=names(fit$model)[4]
if(is.null(mod2.values)){
if(rangemode==1){
mod2.values=mean(fit$model[[mod2]],na.rm=TRUE)+c(-1,0,1)*sd(fit$model[[mod2]],na.rm=TRUE)
mod2.values=round(mod2.values,digits)
} else{
mod2.values=quantile(fit$model[[mod2]],probs=c(0.16,0.5,0.84),type=6)
mod2.values=round(mod2.values,digits)
}
}
vjust=rep(c(-0.5,1.5),each=length(mod2.values))
pred
modx
mod2
res=ggPredict(fit,pred=pred,modx=modx,mod2=mod2,show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits,plot=FALSE)
ggPredict(fit,pred="negemot",modx="sex",mod2="age")
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits,plot=FALSE)
ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits,plot=FALSE)
ggPredict(fit,pred="negemot",modx="sex",mod2="age")
ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits)
ggPredict(fit,pred="negemot",modx="sex",mod2="age")
ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits)
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
pred="negemot";modx="sex"; mod2="age";mod2.values =NULL;rangemode=1;digits=3
# fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
# pred="negemot";modx="sex"; mod2="age";mod2.values =NULL;rangemode=1;digits=3
if(is.null(pred)) pred=names(fit$model)[2]
if(is.null(modx)) modx=names(fit$model)[3]
if(is.null(mod2)) mod2=names(fit$model)[4]
if(is.null(mod2.values)){
if(rangemode==1){
mod2.values=mean(fit$model[[mod2]],na.rm=TRUE)+c(-1,0,1)*sd(fit$model[[mod2]],na.rm=TRUE)
mod2.values=round(mod2.values,digits)
} else{
mod2.values=quantile(fit$model[[mod2]],probs=c(0.16,0.5,0.84),type=6)
mod2.values=round(mod2.values,digits)
}
}
vjust=rep(c(-0.5,1.5),each=length(mod2.values))
mode2.values
mod2.values
mod2
pred
modx
res=ggPredict(fit,pred=pred,modx=modx,mod2=mod2,show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits,plot=FALSE)
ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits)
ggPredict(fit,pred="negemot",modx="sex",mod2="age")
ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
res=ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
pred="negemot";modx="sex"; mod2="age";mod2.values =NULL;rangemode=1;digits=3
# fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
# pred="negemot";modx="sex"; mod2="age";mod2.values =NULL;rangemode=1;digits=3
if(is.null(pred)) pred=names(fit$model)[2]
if(is.null(modx)) modx=names(fit$model)[3]
if(is.null(mod2)) mod2=names(fit$model)[4]
if(is.null(mod2.values)){
if(rangemode==1){
mod2.values=mean(fit$model[[mod2]],na.rm=TRUE)+c(-1,0,1)*sd(fit$model[[mod2]],na.rm=TRUE)
mod2.values=round(mod2.values,digits)
} else{
mod2.values=quantile(fit$model[[mod2]],probs=c(0.16,0.5,0.84),type=6)
mod2.values=round(mod2.values,digits)
}
}
vjust=rep(c(-0.5,1.5),each=length(mod2.values))
mod2.values
mod2
pred
modx
res=ggPredict(fit,pred=pred,modx=modx,mod2=mod2,show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits,plot=FALSE)
devtools::document()
library(processR)
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
condPlot2(fit)
#' @examples
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
condPlot2(fit)
condPlot2(fit,mod2.values = c(30,50,70))
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
ggPredict(fit,pred="negemot",modx="sex",mod2="age")
res=ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits)
mod2.values = c(30,50,70)
res=ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=digits)
res=ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values,
vjust=vjust,digits=3)
res=ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
condPlot2(fit)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
condPlot2(fit)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
ggPredict(fit,pred="negemot",modx="sex",mod2="age",show.point=FALSE,mod2.values = mod2.values)
ggPredict(fit,pred="negemot",modx="sex",mod2="age")
pred="negemot";modx="sex";mod2="age"
ggPredict(fit,pred=pred,modx=modx,mod2=mod2,show.point=FALSE,mod2.values = mod2.values)
ggPredict(fit,pred=negemot,modx=sex,mod2=age,show.point=FALSE,mod2.values = mod2.values)
pred="negemot";modx="sex";mod2="age"
pred
substitute(pred)
qoute(pred)
eval(pred)
library(processR)
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
ggPredict(fit,pred=negemot,modx=sex,mod2=age,show.point=FALSE,mod2.values = mod2.values)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
devtools::document()
library(processR)
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
condPlot2(fit,pred="negemot",modx="sex",mod2="age",mod2.values = c(30,50,70))
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit,pred="negemot",modx="sex",mod2="age")
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
condPlot2(fit,mod2.values = c(30,50,70))
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
condPlot2(fit)
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit,pred="negemot",modx="sex",mod2="age",mod2.values = c(30,50,70))
library(processR)
devtools::docuemnt()
devtools::document()
library(processR)
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
condPlot2(fit)
condPlot2(fit,mod2.values = c(30,50,70))
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit,pred="negemot",modx="sex",mod2="age",mod2.values = c(30,50,70))
library(processR)
fit=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit,pred="negemot",modx="sex",mod2="age",mod2.values = c(30,50,70))
fit=lm(govact~negemot*sex*age+posemot+ideology,data=glbwarm)
condPlot2(fit)
condPlot2(fit,mod2.values = c(30,50,70))
fit1=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit1,pred="negemot",modx="sex",mod2="age",mod2.values = c(30,50,70))
devtools::document()
devtools::check()
devtools::document()
library(processR)
fit1=lm(govact~negemot*age*sex+posemot+ideology,data=glbwarm)
condPlot2(fit1,pred="negemot",modx="sex",mod2="age",mod2.values = c(30,50,70),xvar="W")
devtools::document()
devtools::check()
calEquation
require(processR)
require(predict3d)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
condPlot2(fit)
condPlot2(fit,mod2.values = c(30,50,70))
summary(fit)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
names(fit$model)
names(fit$coef)
str_detect(names(fit$coef),":")
require(stringr)
str_detect(names(fit$coef),":")
names(fit$coef)[str_detect(names(fit$coef),":")]
vars=names(fit$coef)[str_detect(names(fit$coef),":")]
vars
vars=names(fit$coef)[str_detect(names(fit$coef),":")]
unlist(strsplit(vars,":"))
vars=names(fit$coef)[str_detect(names(fit$coef),":")]
strsplit(vars,":")
lappy(strsplit(vars,":"),union)
lapply(strsplit(vars,":"),union)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
summary(fit)
vars=names(fit$coef)[str_detect(names(fit$coef),":")]
unique(unlist(strsplit(vars,":")))
temp=names(fit$coef)[str_detect(names(fit$coef),":")]
vars=unique(unlist(strsplit(temp,":")))
fit$model[[1]]
fit$model[[vars[1]]]
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
temp=names(fit$coef)[str_detect(names(fit$coef),":")]
vars=unique(unlist(strsplit(temp,":")))
if(is.null(pred.values)){
x=fit$model[[vars[1]]]
if(rangemode==1) {
pred.values=mean(x,na.rm=TRUE)+c(-1,0,1)*sd(x,na.rm=TRUE)
} else{
pred.values=quantile(x,probs=c(0.16,0.50,0.84),type=6)
}
}
rangemode=1;pred.values=NULL;summarymode=2
temp=names(fit$coef)[str_detect(names(fit$coef),":")]
vars=unique(unlist(strsplit(temp,":")))
if(is.null(pred.values)){
x=fit$model[[vars[1]]]
if(rangemode==1) {
pred.values=mean(x,na.rm=TRUE)+c(-1,0,1)*sd(x,na.rm=TRUE)
} else{
pred.values=quantile(x,probs=c(0.16,0.50,0.84),type=6)
}
}
fit2newdata(fit,predictors=vars,pred.values=pred.values,summarymode=2)
modSummary3=function(fit,rangemode=1,pred.values=NULL,summarymode=1,...){
temp=names(fit$coef)[str_detect(names(fit$coef),":")]
vars=unique(unlist(strsplit(temp,":")))
if(is.null(pred.values)){
x=fit$model[[vars[1]]]
if(rangemode==1) {
pred.values=mean(x,na.rm=TRUE)+c(-1,0,1)*sd(x,na.rm=TRUE)
} else{
pred.values=quantile(x,probs=c(0.16,0.50,0.84),type=6)
}
}
fit2newdata(fit,predictors=vars,pred.values=pred.values,summarymode=2,...)
}
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,mod2.values=c(30,50,70))
modSummary3(fit,mod2.values=c(30,50,70),summarymode=2)
modSummary3=function(fit,rangemode=1,pred.values=NULL,summarymode=1,...){
temp=names(fit$coef)[str_detect(names(fit$coef),":")]
vars=unique(unlist(strsplit(temp,":")))
if(is.null(pred.values)){
x=fit$model[[vars[1]]]
if(rangemode==1) {
pred.values=mean(x,na.rm=TRUE)+c(-1,0,1)*sd(x,na.rm=TRUE)
} else{
pred.values=quantile(x,probs=c(0.16,0.50,0.84),type=6)
}
}
fit2newdata(fit,predictors=vars,pred.values=pred.values,summarymode=summarymode,...)
}
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,mod2.values=c(30,50,70),summarymode=2)
modSummary3(fit,mod2.values=c(30,50,70),summarymode=1)
modSummary3(fit,rangemode=2,mod2.values=c(30,50,70),summarymode=2)
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
condPlot2(fit,mod2.values = c(30,50,70))
#' @param rangmode An integer. If 1, mean+c(-1,0,1)*sd used. If 2, 16th, 50th and 84th percentiles are used
#' @param pred.values Values of predictor variables
#' @param summarymode An integer. 1 or 2. SUmmarizing method of variables. If 1, typical values are used. If 2, mean values are used
#' @param ... Further arguments to be passed to predict3d::fit2newdata()
#' @importFrom predict3d fit2newdata
#' @importFrom stringr str_detect
#' @examples
#' fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
#' modSummary3(fit,rangemode=2,mod2.values=c(30,50,70),summarymode=2)
#' modSummary3(fit,mod2.values=c(30,50,70),summarymode=1)
modSummary3=function(fit,rangemode=1,pred.values=NULL,summarymode=1,...){
temp=names(fit$coef)[str_detect(names(fit$coef),":")]
vars=unique(unlist(strsplit(temp,":")))
if(is.null(pred.values)){
x=fit$model[[vars[1]]]
if(rangemode==1) {
pred.values=mean(x,na.rm=TRUE)+c(-1,0,1)*sd(x,na.rm=TRUE)
} else{
pred.values=quantile(x,probs=c(0.16,0.50,0.84),type=6)
}
}
fit2newdata(fit,predictors=vars,pred.values=pred.values,summarymode=summarymode,...)
}
fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
modSummary3(fit,rangemode=2,mod2.values=c(30,50,70),summarymode=2)
modSummary3(fit,mod2.values=c(30,50,70),summarymode=1)
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
modSummary3(fit)
modSummary3(fit,summarymode=2)
devtools::docuemnt()
devtools::document()
devtools::document()
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
modSummary3(fit,summarymode=2)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
modSummary3(fit,summarymode=2)
library(processR)
devtools::docuemnt()
devtools::document()
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
modSummary3(fit,summarymode=2)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
modSummary3(fit,summarymode=2)
#' @param summarymode An integer. 1 or 2. SUmmarizing method of variables. If 1, typical values are used. If 2, mean values are used
#' @param maxylev An integer. Maximum length of predictor variables to be treated as a categorical variable.
#' @param ... Further arguments to be passed to predict3d::fit2newdata()
#' @importFrom predict3d fit2newdata
#' @importFrom stringr str_detect
#' @export
#' @examples
#' fit=lm(govact~negemot*sex+negemot*age+posemot+ideology,data=glbwarm)
#' modSummary3(fit,rangemode=2,mod2.values=c(30,50,70),summarymode=2)
#' modSummary3(fit,mod2.values=c(30,50,70),summarymode=1)
modSummary3=function(fit,rangemode=2,pred.values=NULL,summarymode=2,maxylev=6,...){
temp=names(fit$coef)[str_detect(names(fit$coef),":")]
vars=unique(unlist(strsplit(temp,":")))
if(is.null(pred.values)){
x=fit$model[[vars[1]]]
if(length(unique(x))<=maxylev){
pred.values=sort(unique(x))
} else if(rangemode==1) {
pred.values=mean(x,na.rm=TRUE)+c(-1,0,1)*sd(x,na.rm=TRUE)
} else{
pred.values=quantile(x,probs=c(0.16,0.50,0.84),type=6)
}
}
fit2newdata(fit,predictors=vars,mode=rangemode,pred.values=pred.values,summarymode=summarymode,...)
}
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
modSummary3(fit,summarymode=2)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
modSummary3(fit,summarymode=2)
library(processR)
devtools::document()
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
modSummary3(fit,summarymode=2)
fit=lm(justify~frame*skeptic,data=disaster)
fit2newdata(fit,predictors=c("frame","skeptic"),mode=2,summarymode=summarymode,...)
fit2newdata(fit,predictors=c("frame","skeptic"),mode=2,summarymode=summarymode)
fit2newdata(fit,predictors=c("frame","skeptic"),mode=1,summarymode=summarymode)
fit2newdata(fit,predictors=c("frame","skeptic"),mode=2,summarymode=summarymode)
quantile(disaster$skpetic,probs=c(0.14,0.5,0.86))
quantile(disaster$skeptic,probs=c(0.14,0.5,0.86))
quantile(disaster$skeptic,probs=c(0.14,0.5,0.86),type=6)
quantile(disaster$skeptic,probs=c(0.16,0.5,0.84),type=6)
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
require(processR)
fit=lm(justify~frame*skeptic,data=disaster)
modSummary2(fit)
modSummary3(fit)
modSummary3(fit)
fit2newdata(fit,vars=c("frame","sketic"),mode=2)
require(predcit3d)
require(predict3d)
fit2newdata(fit,vars=c("frame","sketic"),mode=2)
fit2newdata(fit,predictors=c("frame","sketic"),mode=2)
fit2newdata(fit,predictors=c("frame","skeptic"),mode=2)
fit2newdata(fit,predictors=c("frame","skeptic"),mode=1)
fit2newdata(fit,predictors=c("frame","skeptic"),mode=2)
