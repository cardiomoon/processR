condPlot(fit,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
condPlot(fit,mode=2,pred.values=c(30,50,70),xpos=0.2)
condPlot(fit,mode=2,xpos=0.2)
condPlot(fit,mode=3,xpos=0.5,hjust=c(-0.1,1.1))
condPlot(fit,modx.values=c(2,3,4),mode=3,xpos=0.6)
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
library(processR)
devtools::document()
library(processR)
devtools::document()
devtools::check()
devtools::document()
library(processR)
devtools::document()
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit)
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
# fit=lm(justify~skeptic*frame,data=disaster)
fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(justify~skeptic*frame,data=disaster)
# fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=1;rangemode=2;digits=3
ypos=NULL;linecolor="gray60";linetype=2;linesize=1;arrowsize=1;digits=3
data=fit$model
data
dep=colnames(data)[1]
if(is.null(pred)) {
pred=ifelse(xmode==1,colnames(data)[2],colnames(data)[3])
}
# fit=lm(justify~skeptic*frame,data=disaster)
# fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
#      pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=1;rangemode=2;digits=3;xmode=1
data=fit$model
data
dep=colnames(data)[1]
if(is.null(pred)) {
pred=ifelse(xmode==1,colnames(data)[2],colnames(data)[3])
}
if(is.null(modx)) modx=setdiff(colnames(data)[2:3],pred)
if(length(colnames(data)[3])>3) {
mod2=colnames(data)[4]
} else {
mod2=NULL
}
pred
modx
if(is.null(modx.values)){
if(length(unique(data[[modx]]))<6) {
modx.values=unique(data[[modx]])
} else if(rangemode==1){
modx.values=mean(data[[modx]],na.rm=T)+c(-1,0,1)*sd(data[[modx]],na.rm=T)
} else{
modx.values=quantile(data[[modx]],probs=c(0.16,0.5,0.84),type=6)
}
}
if(is.null(pred.values)){
if(length(unique(data[[pred]]))<6) {
pred.values=unique(data[[pred]])
} else if(rangemode==1) {
pred.values=mean(data[[pred]],na.rm=TRUE)+c(-1,0,1)*sd(data[[pred]],na.rm=TRUE)
} else if(rangemode==2) {
pred.values=quantile(data[[pred]],probs=c(0.16,0.5,0.84),type=6)
}
}
coef<-pvalue<-c()
for(i in seq_along(modx.values)){
equation=deparse(fit$call)
temp=stringr::str_replace(equation,modx,paste0("I(",modx,"-",modx.values[i],")"))
fit1=eval(parse(text=temp))
coef=c(coef,fit1$coef[pred])
pvalue=c(pvalue,summary(fit1)$coef[pred,4])
}
effectDf=data.frame(modx.values,coef,pvalue)
colnames(effectDf)[1]="x"
effectDf
pred.values=pred.values[c(1,length(pred.values))]
p=ggplot(data,aes_string(x=modx,y=dep))
require(ggplot2)
require(tidyverse)
p=ggplot(data,aes_string(x=modx,y=dep))
df1=calEquation(fit,pred=modx,modx.values = pred.values)
require(predict3d)
df1=calEquation(fit,pred=modx,modx.values = pred.values)
df1
p=ggplot(data,aes_string(x=modx,y=dep))
df1=calEquation(fit,pred=modx,modx.values = pred.values)
df1
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,xmode=2)
condPlot(fit,xmode=2,mode=2)
condPlot(fit,xmode=2,mode=3)
condPlot(fit,xmode=2,mode=3)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,xmode=2)
condPlot(fit,xmode=2,mode=2)
condPlot(fit,xmode=2,mode=3)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
fit=lm(justify~skeptic*frame,data=disaster)
# fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=3;rangemode=2;digits=3;xmode=2
ypos=NULL;linecolor="gray60";linetype=2;linesize=1;arrowsize=1;digits=3
# fit=lm(justify~skeptic*frame,data=disaster)
fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=3;rangemode=2;digits=3;xmode=2
ypos=NULL;linecolor="gray60";linetype=2;linesize=1;arrowsize=1;digits=3
data=fit$model
data
dep=colnames(data)[1]
if(is.null(pred)) {
pred=ifelse(xmode==1,colnames(data)[2],colnames(data)[3])
}
if(is.null(modx)) modx=setdiff(colnames(data)[2:3],pred)
if(length(colnames(data)[3])>3) {
mod2=colnames(data)[4]
} else {
mod2=NULL
}
if(is.null(modx.values)){
if(length(unique(data[[modx]]))<6) {
modx.values=unique(data[[modx]])
} else if(rangemode==1){
modx.values=mean(data[[modx]],na.rm=T)+c(-1,0,1)*sd(data[[modx]],na.rm=T)
} else{
modx.values=quantile(data[[modx]],probs=c(0.16,0.5,0.84),type=6)
}
}
if(is.null(pred.values)){
if(length(unique(data[[pred]]))<6) {
pred.values=unique(data[[pred]])
} else if(rangemode==1) {
pred.values=mean(data[[pred]],na.rm=TRUE)+c(-1,0,1)*sd(data[[pred]],na.rm=TRUE)
} else if(rangemode==2) {
pred.values=quantile(data[[pred]],probs=c(0.16,0.5,0.84),type=6)
}
}
coef<-pvalue<-c()
for(i in seq_along(modx.values)){
equation=deparse(fit$call)
temp=stringr::str_replace(equation,modx,paste0("I(",modx,"-",modx.values[i],")"))
fit1=eval(parse(text=temp))
coef=c(coef,fit1$coef[pred])
pvalue=c(pvalue,summary(fit1)$coef[pred,4])
}
effectDf=data.frame(modx.values,coef,pvalue)
colnames(effectDf)[1]="x"
df=effectDf
df
b1=fit$coef[pred]
b1
b3=fit$coef[paste0(pred,":",modx)]
b3
interaction=paste0(pred,":",modx)
interaction=paste0(pred,":",modx)
if(!(interaction %in% names(data))) interaction=paste0(modx,":",pred)
b3=fit$coef[paste0(pred,":",modx)]
fun=function(x){b1+b3*x}
b3
interaction=paste0(pred,":",modx)
if(!(interaction %in% names(data))) interaction=paste0(modx,":",pred)
b3=fit$coef[interaction]
b3
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,xmode=2)
condPlot(fit,xmode=2,mode=2)
condPlot(fit,xmode=2,mode=3)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,xmode=2)
condPlot(fit,xmode=2,mode=2)
condPlot(fit,xmode=2,mode=3)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,xmode=2)
condPlot(fit,xmode=2,mode=2)
condPlot(fit,xmode=2,mode=3)
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(justify~skeptic*frame,data=disaster)
# fit=lm(justify~frame*skeptic,data=disaster)
# fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
pred=NULL;modx=NULL;pred.values=NULL;modx.values=NULL
mode=3;rangemode=2;digits=3;xmode=1
ypos=NULL;linecolor="gray60";linetype=2;linesize=1;arrowsize=1;digits=3
data=fit$model
data
dep=colnames(data)[1]
if(is.null(pred)) {
pred=ifelse(xmode==1,colnames(data)[2],colnames(data)[3])
}
if(is.null(modx)) modx=setdiff(colnames(data)[2:3],pred)
if(length(colnames(data)[3])>3) {
mod2=colnames(data)[4]
} else {
mod2=NULL
}
if(is.null(modx.values)){
if(length(unique(data[[modx]]))<6) {
modx.values=unique(data[[modx]])
} else if(rangemode==1){
modx.values=mean(data[[modx]],na.rm=T)+c(-1,0,1)*sd(data[[modx]],na.rm=T)
} else{
modx.values=quantile(data[[modx]],probs=c(0.16,0.5,0.84),type=6)
}
}
if(is.null(pred.values)){
if(length(unique(data[[pred]]))<6) {
pred.values=unique(data[[pred]])
} else if(rangemode==1) {
pred.values=mean(data[[pred]],na.rm=TRUE)+c(-1,0,1)*sd(data[[pred]],na.rm=TRUE)
} else if(rangemode==2) {
pred.values=quantile(data[[pred]],probs=c(0.16,0.5,0.84),type=6)
}
}
coef<-pvalue<-c()
for(i in seq_along(modx.values)){
equation=deparse(fit$call)
temp=stringr::str_replace(equation,modx,paste0("I(",modx,"-",modx.values[i],")"))
fit1=eval(parse(text=temp))
coef=c(coef,fit1$coef[pred])
pvalue=c(pvalue,summary(fit1)$coef[pred,4])
}
effectDf=data.frame(modx.values,coef,pvalue)
colnames(effectDf)[1]="x"
df=effectDf
df
b1=fit$coef[pred]
b1
interaction=paste0(pred,":",modx)
if(!(interaction %in% names(data))) interaction=paste0(modx,":",pred)
b3=fit$coef[interaction]
b3
interaction=paste0(pred,":",modx)
if(!(interaction %in% names(data))) interaction=paste0(modx,":",pred)
interaction
fit$coef
interaction=paste0(pred,":",modx)
interaction
names(data)
interaction=paste0(pred,":",modx)
if(!(interaction %in% names(fit$coef))) interaction=paste0(modx,":",pred)
interaction
b3=fit$coef[interaction]
b3
library(processR)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,mode=3,rangemode=2,xpos=0.5,ypos=c(0,2))
condPlot(fit,xmode=2)
condPlot(fit,xmode=2,mode=2)
condPlot(fit,xmode=2,mode=3)
condPlot(fit,xmode=2)
condPlot(fit,xmode=2,mode=2)
condPlot(fit,xmode=2,mode=3)
fit=lm(govact~age*negemot+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=1,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=1,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=1,modx.values=c(30,70),hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=1,modx.values=c(30,70),hjust=c(-0.1,1.1))
condPlot(fit,xmode=1,mode=2,modx.values=c(30,50,70),xpos=0.2)
condPlot(fit,xmode=1,mode=2,modx.values=c(30,50,70),xpos=0.5)
condPlot(fit,xmode=2,mode=2,modx.values=c(30,50,70),xpos=0.5)
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70),xpos=0.5)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,xmode=2,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=2,modx.values=c(30,70),hjust=c(-0.1,1.1))
condPlot(fit,xmode=2,modx.values=c(30,70),hjust=c(-0.1,1.1))
condPlot(fit,xmode=2,modx.values=c(30,70),hjust=c(-0.1,1.1))
condPlot(fit,xmode=2,modx.values=c(30,70),hjust=c(-0.1,1.1),xpos=0.5)
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70),xpos=0.5)
condPlot(fit,xmode=2,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=2,modx.values=c(30,70),hjust=c(-0.1,1.1),xpos=0.5)
condPlot(fit,xmode=2,pred.values=c(30,70),hjust=c(-0.1,1.1),xpos=0.5)
condPlot(fit,xmode=2,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=2,pred.values=c(30,70),hjust=c(-0.1,1.1),xpos=0.5)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,xmode=2,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,xmode=2,pred.values=c(30,70),hjust=c(-0.1,-0.1,1.1),xpos=0.5)
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70),xpos=0.5)
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70))
condPlot(fit,mode=2,xpos=0.2)
condPlot(fit,mode=3,xpos=0.5,hjust=c(-0.1,1.1))
condPlot(fit,xmode=2,mode=3,xpos=0.5,hjust=c(-0.1,1.1))
condPlot(fit,xmode=2,mode=3,xpos=0.5,hjust=c(-0.1,1.1))
condPlot(fit,xmode=2,mode=3,xpos=0.5)
condPlot(fit,xmode=2,mode=3,xpos=0.5,hjust=c(-0.1,-0.1,1.1))
condPlot(fit,modx.values=c(2,3,4),mode=3,xpos=0.6)
condPlot(fit,xmode=2,modx.values=c(2,3,4),mode=3,xpos=0.6)
condPlot(fit,xmode=2,modx.values=c(2,3,4),mode=3,xpos=0.6)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70))
library(processR)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70))
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70),xpos=0.2)
library(processR)
fit=lm(govact~negemot*age+posemot+ideology+sex,data=glbwarm)
condPlot(fit,xmode=2,mode=2,pred.values=c(30,50,70),xpos=0.2)
fit=lm(justify~frame*skeptic,data=disaster)
condPlot(fit,rangemode=2,xpos=0.7,labels=c("Climate change(X=1)","Natural causes(X=0)"))
condPlot(fit,mode=2,xpos=0.6)
condPlot(fit,xmode=2,mode=2)
condPlot(fit,mode=2,xpos=0.6)
library(processR)
devtools::document()
devtools::check()
library(processR)
devtools::document()
devtools::check()
devtools::document()
library(processR)
?meanCentering
devtools::document()
devtools::check()
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
labels=list(Y="mpg",X="wt",W="hp",Z="am")
count=length(fit)
df<-coef<-list()
modelNames=c()
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
fit=list(fit1,fit2)
modelsSummary(list(fit1,fit2),labels=labels)
count=length(fit)
df<-coef<-list()
modelNames=c()
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
#'Get information of a model
#' @param fit object of class lm
#' @param digits integer indicating the number of decimal places
#' @export
#' @examples
#' fit=lm(mpg~wt,data=mtcars)
#' getInfo(fit)
getInfo=function(fit,digits=3){
fmt=paste0("%.0",digits,"f")
r1=nrow(fit$model)
x<-summary(fit)
r2=sprintf(fmt,x$r.squared)
r3=sprintf(fmt,x$adj.r.squared)
r4=paste0(sprintf(fmt,x$sigma)," ( df = ",round(x$df[2]),")")
f=paste0("F(",round(x$fstatistic[2]),",",round(x$fstatistic[3]),") = ",
sprintf(fmt,x$fstatistic[1]))
p=sprintf("%0.4f",pf(x$fstatistic[1L],
x$fstatistic[2L], x$fstatistic[3L], lower.tail = FALSE))
p
p=substr(p,2,digits+2)
if(p==".000") p="< .001"
else p=paste0("= ",p)
f=paste0(f,", p ",p)
result=c(r1,r2,r3,r4,f)
result
}
library(processR)
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
fit=list(fit1,fit2)
labels=list(Y="mpg",X="wt",W="hp",Z="am")
modelsSummary(list(fit1,fit2),labels=labels)
count=length(fit)
df<-coef<-list()
modelNames=c()
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
if(!is.null(labels)) modelNames=changeLabelName(modelNames,labels,add=TRUE)
if(count==1){
mydf=df[[1]]
} else{
mydf<-reduce(df,full_join,by="name1")
}
require(purrr)
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
if(!is.null(labels)) modelNames=changeLabelName(modelNames,labels,add=TRUE)
if(count==1){
mydf=df[[1]]
} else{
mydf<-reduce(df,full_join,by="name1")
}
require(tidyverse)
count=length(fit)
df<-coef<-list()
modelNames=c()
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
if(!is.null(labels)) modelNames=changeLabelName(modelNames,labels,add=TRUE)
if(count==1){
mydf=df[[1]]
} else{
mydf<-reduce(df,full_join,by="name1")
}
mydf
mydf<-mydf %>% select("name1",everything())
rownames(mydf)=mydf[["name1"]]
mydf<-mydf[-1]
mydf[]=lapply(mydf,myformat)
mydf<-mydf[c(2:nrow(mydf),1),]
rownames(mydf)[nrow(mydf)]="Constant"
mydf
count=length(fit)
df<-coef<-list()
modelNames=c()
for(i in 1 :count){
df[[i]]=data.frame(summary(fit[[i]])$coef)
colnames(df[[i]])=paste0(c("coef","se","t","p"),i)
df[[i]][["name1"]]=rownames(df[[i]])
colnames(df[[i]])[5]="name1"
coef[[i]]=getInfo(fit[[i]])
modelNames=c(modelNames,names(fit[[i]]$model)[1])
}
if(!is.null(labels)) modelNames=changeLabelName(modelNames,labels,add=TRUE)
if(count==1){
mydf=df[[1]]
} else{
mydf<-reduce(df,full_join,by="name1")
}
mydf
fit1=lm(mpg~wt,data=mtcars)
fit2=lm(mpg~wt*hp,data=mtcars)
labels=list(Y="mpg",X="wt",W="hp",Z="am")
modelsSummary(list(fit1,fit2),labels=labels)
